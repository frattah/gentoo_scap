<?xml version='1.0' encoding='utf-8'?>
<oval-def:oval_definitions xmlns:ind="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-common-5 oval-common-schema.xsd  http://oval.mitre.org/XMLSchema/oval-definitions-5 oval-definitions-schema.xsd  http://oval.mitre.org/XMLSchema/oval-definitions-5#independent independent-definitions-schema.xsd  http://oval.mitre.org/XMLSchema/oval-definitions-5#unix unix-definitions-schema.xsd  http://oval.mitre.org/XMLSchema/oval-definitions-5#linux linux-definitions-schema.xsd">
  <oval-def:generator>
    <oval:product_name>OVALFileLinker from SCAP Security Guide</oval:product_name>
    <oval:product_version>ssg: [0, 1, 73], python: 3.11.9</oval:product_version>
    <oval:schema_version>5.11</oval:schema_version>
    <oval:timestamp>2024-06-04T09:17:05</oval:timestamp>
  </oval-def:generator>
  <oval-def:definitions>
    <oval-def:definition id="oval:ssg-accounts_password_pam_unix_remember:def:1" version="2" class="compliance">
      <oval-def:metadata>
        <oval-def:title>Limit Password Reuse</oval-def:title>
        <oval-def:affected family="unix">
          <oval-def:platform>Gentoo</oval-def:platform>
        </oval-def:affected>
        <oval-def:reference ref_id="accounts_password_pam_unix_remember" source="ssg" />
        <oval-def:description>The passwords to remember should be set correctly.</oval-def:description>
      </oval-def:metadata>
      <oval-def:criteria comment="Check if pam_pwhistory.so or pam_unix.so are configured" operator="OR">
        <oval-def:criteria comment="Check if pam_pwhistory.so is properly configured" operator="AND">
          <oval-def:criterion comment="pam_pwhistory.so is properly defined in password section of PAM file" test_ref="oval:ssg-test_accounts_password_pam_unix_remember:tst:1" />
          <oval-def:criteria comment="Check the expected value for pam_pwhistory.so remember parameter" operator="OR">
            <oval-def:criteria comment="Check the pam_pwhistory.so remember parameter is only in PAM file" operator="AND">
              <oval-def:criterion comment="Check the remember parameter in password section of PAM file" test_ref="oval:ssg-test_accounts_password_pam_unix_remember_pamd:tst:1" />
              <oval-def:criterion comment="Check the pam_pwhistory.so remember parameter is absent in pwhistory.conf" test_ref="oval:ssg-test_accounts_password_pam_unix_remember_no_pwhistory_conf:tst:1" />
            </oval-def:criteria>
            <oval-def:criteria comment="Check the pam_pwhistory.so remember parameter is only in pwhistory.conf file" operator="AND">
              <oval-def:criterion comment="Check the pam_pwhistory.so remember parameter is absent in PAM file" test_ref="oval:ssg-test_accounts_password_pam_unix_remember_no_pamd:tst:1" />
              <oval-def:criterion comment="Check the remember parameter in /etc/security/pwhistory.conf" test_ref="oval:ssg-test_accounts_password_pam_unix_remember_pwhistory_conf:tst:1" />
            </oval-def:criteria>
          </oval-def:criteria>
        </oval-def:criteria>
        <oval-def:criterion comment="Remember parameter of pam_unix.so is properly configured" test_ref="oval:ssg-test_accounts_password_pam_unix_remember_legacy:tst:1" />
      </oval-def:criteria>
    </oval-def:definition>
  </oval-def:definitions>
  <oval-def:tests>
    <ind:textfilecontent54_test id="oval:ssg-test_accounts_password_pam_unix_remember:tst:1" version="1" check="all" comment="Check pam_pwhistory.so presence in PAM file" state_operator="AND">
      <ind:object object_ref="oval:ssg-object_accounts_password_pam_unix_remember:obj:1" />
    </ind:textfilecontent54_test>
    <ind:textfilecontent54_test id="oval:ssg-test_accounts_password_pam_unix_remember_pamd:tst:1" version="1" check="all" comment="Check remember parameter is present and correct in PAM file" state_operator="AND">
      <ind:object object_ref="oval:ssg-object_accounts_password_pam_unix_remember_pamd:obj:1" />
      <ind:state state_ref="oval:ssg-state_accounts_password_pam_unix_remember:ste:1" />
    </ind:textfilecontent54_test>
    <ind:textfilecontent54_test id="oval:ssg-test_accounts_password_pam_unix_remember_no_pwhistory_conf:tst:1" version="1" check="all" comment="Check the absence of remember parameter in /etc/security/pwhistory.conf" check_existence="none_exist" state_operator="AND">
      <ind:object object_ref="oval:ssg-object_accounts_password_pam_unix_remember_param_conf:obj:1" />
    </ind:textfilecontent54_test>
    <ind:textfilecontent54_test id="oval:ssg-test_accounts_password_pam_unix_remember_no_pamd:tst:1" version="1" check="all" comment="Check remember parameter is absent in PAM file" check_existence="none_exist" state_operator="AND">
      <ind:object object_ref="oval:ssg-object_accounts_password_pam_unix_remember_pamd:obj:1" />
    </ind:textfilecontent54_test>
    <ind:textfilecontent54_test id="oval:ssg-test_accounts_password_pam_unix_remember_pwhistory_conf:tst:1" version="1" check="all" comment="Check remember parameter is present and correct in /etc/security/pwhistory.conf" check_existence="all_exist" state_operator="AND">
      <ind:object object_ref="oval:ssg-object_accounts_password_pam_unix_remember_param_conf:obj:1" />
      <ind:state state_ref="oval:ssg-state_accounts_password_pam_unix_remember:ste:1" />
    </ind:textfilecontent54_test>
    <ind:textfilecontent54_test id="oval:ssg-test_accounts_password_pam_unix_remember_legacy:tst:1" version="1" check="all" comment="Test if remember attribute of pam_unix.so is set correctly in /etc/pam.d/system-auth" check_existence="all_exist" state_operator="AND">
      <ind:object object_ref="oval:ssg-object_accounts_password_pam_unix_remember_legacy:obj:1" />
      <ind:state state_ref="oval:ssg-state_accounts_password_pam_unix_remember:ste:1" />
    </ind:textfilecontent54_test>
  </oval-def:tests>
  <oval-def:objects>
    <ind:textfilecontent54_object id="oval:ssg-object_accounts_password_pam_unix_remember:obj:1" version="1">
      <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
      <ind:pattern var_ref="oval:ssg-var_accounts_password_pam_unix_remember_module_regex:var:1" var_check="at least one" operation="pattern match" />
      <ind:instance datatype="int">1</ind:instance>
    </ind:textfilecontent54_object>
    <ind:textfilecontent54_object id="oval:ssg-object_accounts_password_pam_unix_remember_pamd:obj:1" version="1">
      <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
      <ind:pattern var_check="at least one" operation="pattern match" var_ref="oval:ssg-var_accounts_password_pam_unix_remember_pam_param_regex:var:1" />
      <ind:instance datatype="int">1</ind:instance>
    </ind:textfilecontent54_object>
    <ind:textfilecontent54_object id="oval:ssg-object_accounts_password_pam_unix_remember_param_conf:obj:1" version="1" comment="Collect the pam_pwhistory.so remember parameter from /etc/security/pwhistory.conf">
      <ind:filepath operation="pattern match">^/etc/security/pwhistory.conf$</ind:filepath>
      <ind:pattern operation="pattern match" var_ref="oval:ssg-var_accounts_password_pam_unix_remember_conf_param_regex:var:1" />
      <ind:instance datatype="int" operation="equals">1</ind:instance>
    </ind:textfilecontent54_object>
    <ind:textfilecontent54_object id="oval:ssg-object_accounts_password_pam_unix_remember_legacy:obj:1" version="1">
      <ind:filepath>/etc/pam.d/system-auth</ind:filepath>
      <ind:pattern operation="pattern match">^\s*password\s+(?:(?:sufficient)|(?:required)|(?:\[.*\]))\s+pam_unix\.so.*remember=([0-9]*).*$</ind:pattern>
      <ind:instance datatype="int">1</ind:instance>
    </ind:textfilecontent54_object>
  </oval-def:objects>
  <oval-def:states>
    <ind:textfilecontent54_state id="oval:ssg-state_accounts_password_pam_unix_remember:ste:1" version="1" operator="AND">
      <ind:subexpression datatype="int" operation="greater than or equal" var_ref="oval:ssg-var_password_pam_unix_remember:var:1" />
    </ind:textfilecontent54_state>
  </oval-def:states>
  <oval-def:variables>
    <oval-def:external_variable id="oval:ssg-var_password_pam_unix_remember:var:1" version="1" datatype="int" comment="number of passwords that should be remembered" />
    <oval-def:local_variable id="oval:ssg-var_accounts_password_pam_unix_remember_module_regex:var:1" version="1" datatype="string" comment="The regex is to confirm the pam_pwhistory.so module is enabled">
      <oval-def:literal_component>^\s*password\s+(?:(?:requisite)|(?:required))\s+pam_pwhistory\.so.*$</oval-def:literal_component>
    </oval-def:local_variable>
    <oval-def:local_variable id="oval:ssg-var_accounts_password_pam_unix_remember_pam_param_regex:var:1" version="1" datatype="string" comment="The regex is to collect the pam_pwhistory.so remember paramerter from PAM files">
      <oval-def:literal_component>^\s*password\b.*\bpam_pwhistory\.so\b.*\bremember=([0-9]*).*$</oval-def:literal_component>
    </oval-def:local_variable>
    <oval-def:local_variable id="oval:ssg-var_accounts_password_pam_unix_remember_conf_param_regex:var:1" version="1" datatype="string" comment="The regex is to collect the pam_pwhistory.so remember paramerter in pwhistory.conf">
      <oval-def:literal_component>^\s*remember\s*=\s*([0-9]+)</oval-def:literal_component>
    </oval-def:local_variable>
  </oval-def:variables>
</oval-def:oval_definitions>