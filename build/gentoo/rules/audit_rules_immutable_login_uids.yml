description: 'Configure kernel to prevent modification of login UIDs once they are
    set.

    Changing login UIDs while this configuration is enforced requires special capabilities
    which

    are not available to unprivileged users.

    If the <tt>auditd</tt> daemon is configured to use the

    <tt>augenrules</tt> program to read audit rules during daemon startup (the

    default), add the following line to a file with suffix <tt>.rules</tt> in the

    directory <tt>/etc/audit/rules.d</tt> in order to make login UIDs

    immutable:

    <pre>--loginuid-immutable</pre>

    If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>

    utility to read audit rules during daemon startup, add the following line to

    <tt>/etc/audit/audit.rules</tt> file in order to make login UIDs

    immutable:

    <pre>--loginuid-immutable</pre>'
rationale: 'If modification of login UIDs is not prevented, they can be changed by
    unprivileged users and

    make auditing complicated or impossible.'
severity: medium
references:
    disa:
    - CCI-000162
    - CCI-000163
    - CCI-000164
    srg:
    - SRG-OS-000462-GPOS-00206
    - SRG-OS-000475-GPOS-00220
    - SRG-OS-000057-GPOS-00027
    - SRG-OS-000058-GPOS-00028
    - SRG-OS-000059-GPOS-00029
components:
- audit
identifiers: {}
ocil_clause: the system is not configured to make login UIDs immutable
ocil: 'To determine if the system is configured to make login UIDs immutable, run

    one of the following commands.

    If the <tt>auditd</tt> daemon is configured to use the

    <tt>augenrules</tt> program to read audit rules during daemon startup (the

    default), run the following:

    <pre>sudo grep immutable /etc/audit/rules.d/*.rules</pre>

    If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>

    utility to read audit rules during daemon startup, run the following command:

    <pre>sudo grep immutable /etc/audit/audit.rules</pre>

    The following line should be returned:

    <pre>--loginuid-immutable</pre>'
oval_external_content: null
fixtext: ''
checktext: ''
vuldiscussion: ''
srg_requirement: ''
warnings: []
conflicts: []
requires: []
policy_specific_content:
    stig:
        srg_requirement: Gentoo audit system must protect logon UIDs from unauthorized
            change.
        fixtext: 'Configure Gentoo auditing to prevent modification of login UIDs
            once they are set by adding the following line to /etc/audit/rules.d/audit.rules:


            --loginuid-immutable


            The audit daemon must be restarted for the changes to take effect.'
        checktext: 'Verify the audit system prevents unauthorized changes to logon
            UIDs with the following command:


            $ sudo grep -i immutable /etc/audit/audit.rules


            --loginuid-immutable


            If the "--loginuid-immutable" option is not returned in the "/etc/audit/audit.rules",
            or the line is commented out, this is a finding.'
        vuln_discussion: If modification of login user identifiers (UIDs) is not prevented,
            they can be changed by nonprivileged users and make auditing complicated
            or impossible.
platform: null
platforms: !!set {}
sce_metadata: {}
inherited_platforms: !!set
    machine: null
    package[audit]: null
cpe_platform_names: !!set {}
inherited_cpe_platform_names: !!set
    machine: null
    package_audit: null
bash_conditional: null
fixes: {}
title: Configure immutable Audit login UIDs
definition_location: /home/fra/gentoo_scap/linux_os/guide/auditing/auditd_configure_rules/audit_rules_immutable_login_uids/rule.yml
template: null
documentation_complete: true
