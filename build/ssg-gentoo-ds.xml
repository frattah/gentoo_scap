<ns0:data-stream-collection xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:ns0="http://scap.nist.gov/schema/scap/source/1.2" xmlns:ns1="http://www.w3.org/1999/xlink" xmlns:ns10="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:ns11="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" xmlns:ns12="http://scap.nist.gov/schema/ocil/2.0" xmlns:ns13="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix" xmlns:ns14="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux" xmlns:ns2="urn:oasis:names:tc:entity:xmlns:xml:catalog" xmlns:ns3="http://cpe.mitre.org/dictionary/2.0" xmlns:ns5="http://checklists.nist.gov/xccdf/1.2" xmlns:ns7="http://cpe.mitre.org/language/2.0" xmlns:ns9="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="scap_org.open-scap_collection_from_xccdf_ssg-gentoo-xccdf.xml" schematron-version="1.3">
  <ns0:data-stream id="scap_org.open-scap_datastream_from_xccdf_ssg-gentoo-xccdf.xml" scap-version="1.3" use-case="OTHER">
    <ns0:dictionaries>
      <ns0:component-ref id="scap_org.open-scap_cref_ssg-gentoo-cpe-dictionary.xml" ns1:href="#scap_org.open-scap_comp_ssg-gentoo-cpe-dictionary.xml">
        <ns2:catalog>
          <ns2:uri name="ssg-gentoo-cpe-oval.xml" uri="#scap_org.open-scap_cref_ssg-gentoo-cpe-oval.xml" />
        </ns2:catalog>
      </ns0:component-ref>
    </ns0:dictionaries>
    <ns0:checklists>
      <ns0:component-ref id="scap_org.open-scap_cref_ssg-gentoo-xccdf.xml" ns1:href="#scap_org.open-scap_comp_ssg-gentoo-xccdf.xml">
        <ns2:catalog>
          <ns2:uri name="ssg-gentoo-oval.xml" uri="#scap_org.open-scap_cref_ssg-gentoo-oval.xml" />
          <ns2:uri name="ssg-gentoo-ocil.xml" uri="#scap_org.open-scap_cref_ssg-gentoo-ocil.xml" />
          <ns2:uri name="ssg-gentoo-cpe-oval.xml" uri="#scap_org.open-scap_cref_ssg-gentoo-cpe-oval.xml" />
        </ns2:catalog>
      </ns0:component-ref>
    </ns0:checklists>
    <ns0:checks>
      <ns0:component-ref id="scap_org.open-scap_cref_ssg-gentoo-oval.xml" ns1:href="#scap_org.open-scap_comp_ssg-gentoo-oval.xml" />
      <ns0:component-ref id="scap_org.open-scap_cref_ssg-gentoo-ocil.xml" ns1:href="#scap_org.open-scap_comp_ssg-gentoo-ocil.xml" />
      <ns0:component-ref id="scap_org.open-scap_cref_ssg-gentoo-cpe-oval.xml" ns1:href="#scap_org.open-scap_comp_ssg-gentoo-cpe-oval.xml" />
    </ns0:checks>
  </ns0:data-stream>
  <ns0:component id="scap_org.open-scap_comp_ssg-gentoo-cpe-dictionary.xml" timestamp="2024-06-04T12:03:55">
    <ns3:cpe-list xsi:schemaLocation="http://cpe.mitre.org/dictionary/2.0 http://cpe.mitre.org/files/cpe-dictionary_2.1.xsd">
      <ns3:cpe-item name="cpe:/o:gentoo:linux">
        <ns3:title xml:lang="en-us">Gentoo</ns3:title>
        <ns3:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="ssg-gentoo-cpe-oval.xml">oval:ssg-installed_OS_is_gentoo:def:1</ns3:check>
      </ns3:cpe-item>
    </ns3:cpe-list>
  </ns0:component>
  <ns0:component id="scap_org.open-scap_comp_ssg-gentoo-xccdf.xml" timestamp="2024-06-04T12:03:54">
    <ns5:Benchmark id="xccdf_org.ssgproject.content_benchmark_GENTOO" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.2 xccdf-1.2.xsd" style="SCAP_1.2" resolved="true" xml:lang="en-US">
      <ns5:status date="2024-06-04">draft</ns5:status>
      <ns5:title>Guide to the Secure Configuration of Gentoo</ns5:title>
      <ns5:description>This guide presents a catalog of security-relevant
configuration settings for Gentoo. It is a rendering of
content structured in the eXtensible Configuration Checklist Description Format (XCCDF)
in order to support security automation.  The SCAP content is
is available in the <html:code>scap-security-guide</html:code> package which is developed at

    <html:a href="https://www.open-scap.org/security-policies/scap-security-guide">https://www.open-scap.org/security-policies/scap-security-guide</html:a>.
<html:br />
    <html:br />
Providing system administrators with such guidance informs them how to securely
configure systems under their control in a variety of network roles. Policy
makers and baseline creators can use this catalog of settings, with its
associated references to higher-level security control catalogs, in order to
assist them in security baseline creation. This guide is a <html:em>catalog, not a
checklist</html:em>, and satisfaction of every item is not likely to be possible or
sensible in many operational scenarios. However, the XCCDF format enables
granular selection and adjustment of settings, and their association with OVAL
and OCIL content provides an automated checking capability. Transformations of
this document, and its associated automated checking content, are capable of
providing baselines that meet a diverse set of policy objectives. Some example
XCCDF <html:em>Profiles</html:em>, which are selections of items that form checklists and
can be used as baselines, are available with this guide. They can be
processed, in an automated fashion, with tools that support the Security
Content Automation Protocol (SCAP). The DISA STIG, which provides required
settings for US Department of Defense systems, is one example of a baseline
created from this guidance.
</ns5:description>
      <ns5:notice id="terms_of_use">Do not attempt to implement any of the settings in
this guide without first testing them in a non-operational environment. The
creators of this guidance assume no responsibility whatsoever for its use by
other parties, and makes no guarantees, expressed or implied, about its
quality, reliability, or any other characteristic.
</ns5:notice>
      <ns5:front-matter>The SCAP Security Guide Project<html:br />
    <html:a href="https://www.open-scap.org/security-policies/scap-security-guide">https://www.open-scap.org/security-policies/scap-security-guide</html:a>
   </ns5:front-matter>
      <ns5:rear-matter>Red Hat and Red Hat Enterprise Linux are either registered
trademarks or trademarks of Red Hat, Inc. in the United States and other
countries. All other names are registered trademarks or trademarks of their
respective companies.</ns5:rear-matter>
      <ns5:reference href="https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf">anssi</ns5:reference>
      <ns5:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=application-servers">app-srg</ns5:reference>
      <ns5:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=container-platform">app-srg-ctr</ns5:reference>
      <ns5:reference href="https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/International/bsi_it_gs_comp_2022.pdf">bsi</ns5:reference>
      <ns5:reference href="https://www.cisecurity.org/controls/">cis-csc</ns5:reference>
      <ns5:reference href="https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf">cjis</ns5:reference>
      <ns5:reference href="https://www.isaca.org/resources/cobit">cobit5</ns5:reference>
      <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf">cui</ns5:reference>
      <ns5:reference href="not_officially_available">dcid</ns5:reference>
      <ns5:reference href="https://public.cyber.mil/stigs/cci/">disa</ns5:reference>
      <ns5:reference href="https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf">hipaa</ns5:reference>
      <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">isa-62443-2009</ns5:reference>
      <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">isa-62443-2013</ns5:reference>
      <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">ism</ns5:reference>
      <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">iso27001-2013</ns5:reference>
      <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">nerc-cip</ns5:reference>
      <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">nist</ns5:reference>
      <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">nist-csf</ns5:reference>
      <ns5:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os">os-srg</ns5:reference>
      <ns5:reference href="https://www.niap-ccevs.org/Profile/PP.cfm">ospp</ns5:reference>
      <ns5:reference href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf">pcidss</ns5:reference>
      <ns5:reference href="https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf">pcidss4</ns5:reference>
      <ns5:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux">stigid</ns5:reference>
      <ns5:reference href="https://public.cyber.mil/stigs/srg-stig-tools/">stigref</ns5:reference>
      <ns7:platform-specification>
        <ns7:platform id="package_pam">
          <ns7:logical-test operator="AND" negate="false">
            </ns7:logical-test>
        </ns7:platform>
        <ns7:platform id="package_bash">
          <ns7:logical-test operator="AND" negate="false">
            </ns7:logical-test>
        </ns7:platform>
        <ns7:platform id="machine">
          <ns7:logical-test operator="AND" negate="false">
            </ns7:logical-test>
        </ns7:platform>
        <ns7:platform id="package_shadow-utils">
          <ns7:logical-test operator="AND" negate="false">
            </ns7:logical-test>
        </ns7:platform>
      </ns7:platform-specification>
      <ns5:platform idref="cpe:/o:gentoo:linux" />
      <ns5:version update="https://github.com/ComplianceAsCode/content/releases/latest">0.1.73</ns5:version>
      <ns5:metadata>
        <dc:publisher>SCAP Security Guide Project</dc:publisher>
        <dc:creator>SCAP Security Guide Project</dc:creator>
        <dc:contributor>Frank J Cameron (CAM1244) &lt;cameron@ctc.com&gt;</dc:contributor>
        <dc:contributor>0x66656c6978 &lt;0x66656c6978@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>H&#229;vard F. Aasen &lt;havard.f.aasen@pfft.no&gt;</dc:contributor>
        <dc:contributor>Jack Adolph &lt;jack.adolph@gmail.com&gt;</dc:contributor>
        <dc:contributor>Edgar Aguilar &lt;edgar.aguilar@oracle.com&gt;</dc:contributor>
        <dc:contributor>akuster &lt;akuster808@gmail.com&gt;</dc:contributor>
        <dc:contributor>Gabe Alford &lt;redhatrises@gmail.com&gt;</dc:contributor>
        <dc:contributor>Firas AlShafei &lt;firas.alshafei@us.abb.com&gt;</dc:contributor>
        <dc:contributor>Rodrigo Alvares &lt;ralvares@redhat.com&gt;</dc:contributor>
        <dc:contributor>Christopher Anderson &lt;cba@fedoraproject.org&gt;</dc:contributor>
        <dc:contributor>Craig Andrews &lt;candrews@integralblue.com&gt;</dc:contributor>
        <dc:contributor>angystardust &lt;angystardust@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>anivan-suse &lt;anastasija.ivanovic@suse.com&gt;</dc:contributor>
        <dc:contributor>anixon-rh &lt;55244503+anixon-rh@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Stephen L Arnold &lt;sarnold@vctlabs.com&gt;</dc:contributor>
        <dc:contributor>Ikko Ashimine &lt;eltociear@gmail.com&gt;</dc:contributor>
        <dc:contributor>Chuck Atkins &lt;chuck.atkins@kitware.com&gt;</dc:contributor>
        <dc:contributor>Bharath B &lt;bhb@redhat.com&gt;</dc:contributor>
        <dc:contributor>Ryan Ballanger &lt;root@rballang-admin-2.fastenal.com&gt;</dc:contributor>
        <dc:contributor>Alex Baranowski &lt;alex@euro-linux.com&gt;</dc:contributor>
        <dc:contributor>Eduardo Barretto &lt;eduardo.barretto@canonical.com&gt;</dc:contributor>
        <dc:contributor>Paul Bastide &lt;pbastide@redhat.com&gt;</dc:contributor>
        <dc:contributor>Molly Jo Bault &lt;Molly.Jo.Bault@ballardtech.com&gt;</dc:contributor>
        <dc:contributor>Andrew Becker &lt;A-Beck@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Gabriel Becker &lt;ggasparb@redhat.com&gt;</dc:contributor>
        <dc:contributor>BenGui &lt;benoit.guillon1@etu.unilim.fr&gt;</dc:contributor>
        <dc:contributor>Alexander Bergmann &lt;abergmann@suse.com&gt;</dc:contributor>
        <dc:contributor>Dale Bewley &lt;dale@bewley.net&gt;</dc:contributor>
        <dc:contributor>Jose Luis BG &lt;bgjoseluis@gmail.com&gt;</dc:contributor>
        <dc:contributor>binyanling &lt;binyanling@uniontech.com&gt;</dc:contributor>
        <dc:contributor>Joseph Bisch &lt;joseph.bisch@gmail.com&gt;</dc:contributor>
        <dc:contributor>Jeff Blank &lt;blank@eclipse.ncsc.mil&gt;</dc:contributor>
        <dc:contributor>Olivier Bonhomme &lt;ptitoliv@ptitoliv.net&gt;</dc:contributor>
        <dc:contributor>Lance Bragstad &lt;lbragstad@gmail.com&gt;</dc:contributor>
        <dc:contributor>Ted Brunell &lt;tbrunell@redhat.com&gt;</dc:contributor>
        <dc:contributor>Marcus Burghardt &lt;maburgha@redhat.com&gt;</dc:contributor>
        <dc:contributor>Matthew Burket &lt;mburket@redhat.com&gt;</dc:contributor>
        <dc:contributor>Blake Burkhart &lt;blake.burkhart@us.af.mil&gt;</dc:contributor>
        <dc:contributor>Patrick Callahan &lt;pmc@patrickcallahan.com&gt;</dc:contributor>
        <dc:contributor>George Campbell &lt;gcampbell@palantir.com&gt;</dc:contributor>
        <dc:contributor>Nick Carboni &lt;ncarboni@redhat.com&gt;</dc:contributor>
        <dc:contributor>Carlos &lt;64919342+carlosmmatos@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>James Cassell &lt;james.cassell@ll.mit.edu&gt;</dc:contributor>
        <dc:contributor>Frank Caviggia &lt;fcaviggia@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Eric Christensen &lt;echriste@redhat.com&gt;</dc:contributor>
        <dc:contributor>Dan Clark &lt;danclark@redhat.com&gt;</dc:contributor>
        <dc:contributor>Jayson Cofell &lt;1051437+70k10@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>David du Colombier &lt;djc@datadoghq.com&gt;</dc:contributor>
        <dc:contributor>Commandcracker &lt;lukas.fricke.dev@gmail.com&gt;</dc:contributor>
        <dc:contributor>Caleb Cooper &lt;coopercd@ornl.gov&gt;</dc:contributor>
        <dc:contributor>CoreyCook8 &lt;129206271+CoreyCook8@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>cortesana &lt;acortes@redhat.com&gt;</dc:contributor>
        <dc:contributor>Richard Maciel Costa &lt;richard.maciel.costa@canonical.com&gt;</dc:contributor>
        <dc:contributor>Xavier Coulon &lt;xavier.coulon@suse.com&gt;</dc:contributor>
        <dc:contributor>Deric Crago &lt;deric.crago@gmail.com&gt;</dc:contributor>
        <dc:contributor>crleekwc &lt;crleekwc@gmail.com&gt;</dc:contributor>
        <dc:contributor>cueball23 &lt;christoph.alms@westnetz.de&gt;</dc:contributor>
        <dc:contributor>cyarbrough76 &lt;42849651+cyarbrough76@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Maura Dailey &lt;maura@eclipse.ncsc.mil&gt;</dc:contributor>
        <dc:contributor>Klaas Demter &lt;demter@atix.de&gt;</dc:contributor>
        <dc:contributor>denknorr &lt;dennis.knorr@suse.com&gt;</dc:contributor>
        <dc:contributor>dependabot[bot] &lt;49699333+dependabot[bot]@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>dhanushkar-wso2 &lt;dhanushkar@wso2.com&gt;</dc:contributor>
        <dc:contributor>Andrew DiPrinzio &lt;andrew.diprinzio@jhuapl.edu&gt;</dc:contributor>
        <dc:contributor>dom &lt;dominique.blaze@devinci.fr&gt;</dc:contributor>
        <dc:contributor>Jean-Baptiste Donnette &lt;jean-baptiste.donnette@epita.fr&gt;</dc:contributor>
        <dc:contributor>Marco De Donno &lt;mdedonno1337@gmail.com&gt;</dc:contributor>
        <dc:contributor>dperrone &lt;dperrone@redhat.com&gt;</dc:contributor>
        <dc:contributor>drax &lt;applezip@gmail.com&gt;</dc:contributor>
        <dc:contributor>Sebastian Dunne &lt;sdunne@redhat.com&gt;</dc:contributor>
        <dc:contributor>Fran&#231;ois Duthilleul &lt;francoisduthilleul@gmail.com&gt;</dc:contributor>
        <dc:contributor>Greg Elin &lt;gregelin@gitmachines.com&gt;</dc:contributor>
        <dc:contributor>eradot4027 &lt;jrtonmac@gmail.com&gt;</dc:contributor>
        <dc:contributor>ermeratos &lt;manuel.ermer@atos.net&gt;</dc:contributor>
        <dc:contributor>Alexis Facques &lt;alexis.facques@mythalesgroup.io&gt;</dc:contributor>
        <dc:contributor>Henry Finucane &lt;hfinucane@zscaler.com&gt;</dc:contributor>
        <dc:contributor>Leah Fisher &lt;lfisher047@gmail.com&gt;</dc:contributor>
        <dc:contributor>Yavor Georgiev &lt;strandjata@gmail.com&gt;</dc:contributor>
        <dc:contributor>Alijohn Ghassemlouei &lt;alijohn@secureagc.com&gt;</dc:contributor>
        <dc:contributor>Swarup Ghosh &lt;swghosh@redhat.com&gt;</dc:contributor>
        <dc:contributor>ghylock &lt;ghylock@gmail.com&gt;</dc:contributor>
        <dc:contributor>Andrew Gilmore &lt;agilmore2@gmail.com&gt;</dc:contributor>
        <dc:contributor>Joshua Glemza &lt;jglemza@nasa.gov&gt;</dc:contributor>
        <dc:contributor>Nick Gompper &lt;forestgomp@yahoo.com&gt;</dc:contributor>
        <dc:contributor>David Fernandez Gonzalez &lt;david.fernandezgonzalez@canonical.com&gt;</dc:contributor>
        <dc:contributor>Loren Gordon &lt;lorengordon@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Gene Gotimer &lt;otherdevopsgene@portinfo.com&gt;</dc:contributor>
        <dc:contributor>Patrik Greco &lt;sikevux@sikevux.se&gt;</dc:contributor>
        <dc:contributor>Steve Grubb &lt;sgrubb@redhat.com&gt;</dc:contributor>
        <dc:contributor>guangyee &lt;gyee@suse.com&gt;</dc:contributor>
        <dc:contributor>Christian Hagenest &lt;christian.hagenest@suse.com&gt;</dc:contributor>
        <dc:contributor>Marek Haicman &lt;mhaicman@redhat.com&gt;</dc:contributor>
        <dc:contributor>Vern Hart &lt;vern.hart@canonical.com&gt;</dc:contributor>
        <dc:contributor>Alex Haydock &lt;alex@alexhaydock.co.uk&gt;</dc:contributor>
        <dc:contributor>Rebekah Hayes &lt;rhayes@corp.rivierautilities.com&gt;</dc:contributor>
        <dc:contributor>Trey Henefield &lt;thenefield@gmail.com&gt;</dc:contributor>
        <dc:contributor>Henning Henkel &lt;henning.henkel@helvetia.ch&gt;</dc:contributor>
        <dc:contributor>hex2a &lt;hex2a@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>John Hooks &lt;jhooks@starscream.pa.jhbcomputers.com&gt;</dc:contributor>
        <dc:contributor>Jakub Hrozek &lt;jhrozek@redhat.com&gt;</dc:contributor>
        <dc:contributor>De Huo &lt;De.Huo@windriver.com&gt;</dc:contributor>
        <dc:contributor>Robin Price II &lt;robin@redhat.com&gt;</dc:contributor>
        <dc:contributor>Yasir Imam &lt;yimam@redhat.com&gt;</dc:contributor>
        <dc:contributor>Jiri Jaburek &lt;jjaburek@redhat.com&gt;</dc:contributor>
        <dc:contributor>Keith Jackson &lt;keithkjackson@gmail.com&gt;</dc:contributor>
        <dc:contributor>Marc Jadoul &lt;mgjadoul@laptomatic.auth-o-matic.corp&gt;</dc:contributor>
        <dc:contributor>Jeremiah Jahn &lt;jeremiah@goodinassociates.com&gt;</dc:contributor>
        <dc:contributor>Jakub Jelen &lt;jjelen@redhat.com&gt;</dc:contributor>
        <dc:contributor>Jessicahfy &lt;Jessicahfy@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Stephan Joerrens &lt;Stephan.Joerrens@fiduciagad.de&gt;</dc:contributor>
        <dc:contributor>Hunter Jones &lt;hjones2199@gmail.com&gt;</dc:contributor>
        <dc:contributor>Jono &lt;jono@ubuntu-18.localdomain&gt;</dc:contributor>
        <dc:contributor>justchris1 &lt;justchris1@justchris1.email&gt;</dc:contributor>
        <dc:contributor>Kacper &lt;kacper@kacper.se&gt;</dc:contributor>
        <dc:contributor>Kai Kang &lt;kai.kang@windriver.com&gt;</dc:contributor>
        <dc:contributor>Charles Kernstock &lt;charles.kernstock@ultra-ats.com&gt;</dc:contributor>
        <dc:contributor>Yuli Khodorkovskiy &lt;ykhodorkovskiy@tresys.com&gt;</dc:contributor>
        <dc:contributor>Sherine Khoury &lt;skhoury@redhat.com&gt;</dc:contributor>
        <dc:contributor>Nathan Kinder &lt;nkinder@redhat.com&gt;</dc:contributor>
        <dc:contributor>Lee Kinser &lt;lee.kinser@gmail.com&gt;</dc:contributor>
        <dc:contributor>Evgeny Kolesnikov &lt;ekolesni@redhat.com&gt;</dc:contributor>
        <dc:contributor>Peter 'Pessoft' Kol&#237;nek &lt;github@pessoft.com&gt;</dc:contributor>
        <dc:contributor>Luke Kordell &lt;luke.t.kordell@lmco.com&gt;</dc:contributor>
        <dc:contributor>Malte Kraus &lt;malte.kraus@suse.com&gt;</dc:contributor>
        <dc:contributor>Seth Kress &lt;seth.kress@dsainc.com&gt;</dc:contributor>
        <dc:contributor>Felix Krohn &lt;felix.krohn@helvetia.ch&gt;</dc:contributor>
        <dc:contributor>kspargur &lt;kspargur@kspargur.csb&gt;</dc:contributor>
        <dc:contributor>Amit Kumar &lt;amitkuma@redhat.com&gt;</dc:contributor>
        <dc:contributor>Fen Labalme &lt;fen@civicactions.com&gt;</dc:contributor>
        <dc:contributor>Dexter Le &lt;dexter.le@sap.com&gt;</dc:contributor>
        <dc:contributor>Ade Lee &lt;alee@redhat.com&gt;</dc:contributor>
        <dc:contributor>Christopher Lee &lt;Crleekwc@gmail.com&gt;</dc:contributor>
        <dc:contributor>Ian Lee &lt;lee1001@llnl.gov&gt;</dc:contributor>
        <dc:contributor>Jarrett Lee &lt;jarrettl@umd.edu&gt;</dc:contributor>
        <dc:contributor>Joseph Lenox &lt;joseph.lenox@collins.com&gt;</dc:contributor>
        <dc:contributor>Jan Lieskovsky &lt;jlieskov@redhat.com&gt;</dc:contributor>
        <dc:contributor>Markus Linnala &lt;Markus.Linnala@knowit.fi&gt;</dc:contributor>
        <dc:contributor>Flos Lonicerae &lt;lonicerae@gmail.com&gt;</dc:contributor>
        <dc:contributor>Simon Lukasik &lt;slukasik@redhat.com&gt;</dc:contributor>
        <dc:contributor>Milan Lysonek &lt;mlysonek@redhat.com&gt;</dc:contributor>
        <dc:contributor>Fredrik Lys&#233;n &lt;fredrik@pipemore.se&gt;</dc:contributor>
        <dc:contributor>Mackemania &lt;8738793+Mackemania@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Caitlin Macleod &lt;caitelatte@gmail.com&gt;</dc:contributor>
        <dc:contributor>Nick Maludy &lt;nmaludy@gmail.com&gt;</dc:contributor>
        <dc:contributor>Lokesh Mandvekar &lt;lsm5@fedoraproject.org&gt;</dc:contributor>
        <dc:contributor>Matus Marhefka &lt;mmarhefk@redhat.com&gt;</dc:contributor>
        <dc:contributor>Jamie Lorwey Martin &lt;jlmartin@redhat.com&gt;</dc:contributor>
        <dc:contributor>Carlos Matos &lt;cmatos@redhat.com&gt;</dc:contributor>
        <dc:contributor>Robert McAllister &lt;rmcallis@redhat.com&gt;</dc:contributor>
        <dc:contributor>Karen McCarron &lt;kmccarro@redhat.com&gt;</dc:contributor>
        <dc:contributor>Michael McConachie &lt;michael@redhat.com&gt;</dc:contributor>
        <dc:contributor>Marcus Meissner &lt;meissner@suse.de&gt;</dc:contributor>
        <dc:contributor>Khary Mendez &lt;kmendez@redhat.com&gt;</dc:contributor>
        <dc:contributor>Rodney Mercer &lt;rmercer@harris.com&gt;</dc:contributor>
        <dc:contributor>Matt Micene &lt;nzwulfin@gmail.com&gt;</dc:contributor>
        <dc:contributor>Brian Millett &lt;bmillett@gmail.com&gt;</dc:contributor>
        <dc:contributor>Takuya Mishina &lt;tmishina@jp.ibm.com&gt;</dc:contributor>
        <dc:contributor>Mixer9 &lt;35545791+Mixer9@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>mmosel &lt;mmosel@kde.example.com&gt;</dc:contributor>
        <dc:contributor>Thomas Montague &lt;montague.thomas@gmail.com&gt;</dc:contributor>
        <dc:contributor>Zbynek Moravec &lt;zmoravec@redhat.com&gt;</dc:contributor>
        <dc:contributor>Kazuo Moriwaka &lt;moriwaka@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Michael Moseley &lt;michael@eclipse.ncsc.mil&gt;</dc:contributor>
        <dc:contributor>Ross Murphy &lt;RossMurphy@ibm.com&gt;</dc:contributor>
        <dc:contributor>Renaud M&#233;trich &lt;rmetrich@redhat.com&gt;</dc:contributor>
        <dc:contributor>Joe Nall &lt;joe@nall.com&gt;</dc:contributor>
        <dc:contributor>Neiloy &lt;neiloy@redhat.com&gt;</dc:contributor>
        <dc:contributor>Axel Nennker &lt;axel@nennker.de&gt;</dc:contributor>
        <dc:contributor>Michele Newman &lt;mnewman@redhat.com&gt;</dc:contributor>
        <dc:contributor>nnerdmann &lt;128606223+nnerdmann@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Sean O'Keeffe &lt;seanokeeffe797@gmail.com&gt;</dc:contributor>
        <dc:contributor>Jiri Odehnal &lt;jodehnal@redhat.com&gt;</dc:contributor>
        <dc:contributor>Ilya Okomin &lt;ilya.okomin@oracle.com&gt;</dc:contributor>
        <dc:contributor>Kaustubh Padegaonkar &lt;theTuxRacer@gmail.com&gt;</dc:contributor>
        <dc:contributor>Michael Palmiotto &lt;mpalmiotto@tresys.com&gt;</dc:contributor>
        <dc:contributor>Eryx Paredes &lt;eryxp@lyft.com&gt;</dc:contributor>
        <dc:contributor>Max R.D. Parmer &lt;maxp@trystero.is&gt;</dc:contributor>
        <dc:contributor>Arnaud Patard &lt;apatard@hupstream.com&gt;</dc:contributor>
        <dc:contributor>Jan Pazdziora &lt;jpazdziora@redhat.com&gt;</dc:contributor>
        <dc:contributor>pcactr &lt;paul.c.arnold4.ctr@mail.mil&gt;</dc:contributor>
        <dc:contributor>Kenneth Peeples &lt;kennethwpeeples@gmail.com&gt;</dc:contributor>
        <dc:contributor>Nathan Peters &lt;Nathaniel.Peters@ca.com&gt;</dc:contributor>
        <dc:contributor>Frank Lin PIAT &lt;fpiat@klabs.be&gt;</dc:contributor>
        <dc:contributor>Stefan Pietsch &lt;mail.ipv4v6+gh@gmail.com&gt;</dc:contributor>
        <dc:contributor>piggyvenus &lt;piggyvenus@gmail.com&gt;</dc:contributor>
        <dc:contributor>Vojtech Polasek &lt;vpolasek@redhat.com&gt;</dc:contributor>
        <dc:contributor>Orion Poplawski &lt;orion@nwra.com&gt;</dc:contributor>
        <dc:contributor>Jennifer Power &lt;barnabei.jennifer@gmail.com&gt;</dc:contributor>
        <dc:contributor>Nick Poyant &lt;npoyant@redhat.com&gt;</dc:contributor>
        <dc:contributor>Martin Preisler &lt;mpreisle@redhat.com&gt;</dc:contributor>
        <dc:contributor>Wesley Ceraso Prudencio &lt;wcerasop@redhat.com&gt;</dc:contributor>
        <dc:contributor>Raphael Sanchez Prudencio &lt;rsprudencio@redhat.com&gt;</dc:contributor>
        <dc:contributor>Miha Purg &lt;miha.purg@canonical.com&gt;</dc:contributor>
        <dc:contributor>T.O. Radzy Radzykewycz &lt;radzy@windriver.com&gt;</dc:contributor>
        <dc:contributor>rain-Qing &lt;yangyuqing6@qq.com&gt;</dc:contributor>
        <dc:contributor>Kenyon Ralph &lt;kenyon@kenyonralph.com&gt;</dc:contributor>
        <dc:contributor>Mike Ralph &lt;mralph@redhat.com&gt;</dc:contributor>
        <dc:contributor>Federico Ramirez &lt;federico.r.ramirez@oracle.com&gt;</dc:contributor>
        <dc:contributor>rchikov &lt;rumen.chikov@suse.com&gt;</dc:contributor>
        <dc:contributor>Rick Renshaw &lt;Richard_Renshaw@xtoenergy.com&gt;</dc:contributor>
        <dc:contributor>Paul Rensing &lt;prensing@cimetrics.com&gt;</dc:contributor>
        <dc:contributor>Chris Reynolds &lt;c.reynolds82@gmail.com&gt;</dc:contributor>
        <dc:contributor>rhayes &lt;rhayes@rivierautilities.com&gt;</dc:contributor>
        <dc:contributor>Pat Riehecky &lt;riehecky@fnal.gov&gt;</dc:contributor>
        <dc:contributor>rlucente-se-jboss &lt;rlucente@redhat.com&gt;</dc:contributor>
        <dc:contributor>Juan Antonio Osorio Robles &lt;juan.osoriorobles@eu.equinix.com&gt;</dc:contributor>
        <dc:contributor>Paul Roche &lt;paul.roche@menlosecurity.com&gt;</dc:contributor>
        <dc:contributor>Jan Rodak &lt;hony.com@seznam.cz&gt;</dc:contributor>
        <dc:contributor>Matt Rogers &lt;mrogers@redhat.com&gt;</dc:contributor>
        <dc:contributor>Jesse Roland &lt;jesse.roland@onyxpoint.com&gt;</dc:contributor>
        <dc:contributor>Joshua Roys &lt;roysjosh@gmail.com&gt;</dc:contributor>
        <dc:contributor>rrenshaw &lt;bofh69@yahoo.com&gt;</dc:contributor>
        <dc:contributor>Chris Ruffalo &lt;chris.ruffalo@gmail.com&gt;</dc:contributor>
        <dc:contributor>Benjamin Ruland &lt;benjamin.ruland@gmail.com&gt;</dc:contributor>
        <dc:contributor>rumch-se &lt;77793453+rumch-se@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Rutvik &lt;32413084+rutvik23@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>rutvik23 &lt;rutksh@gmail.com&gt;</dc:contributor>
        <dc:contributor>Ray Shaw (Cont ARL/CISD) rvshaw &lt;rvshaw@esme.arl.army.mil&gt;</dc:contributor>
        <dc:contributor>Earl Sampson &lt;ESampson@suse.com&gt;</dc:contributor>
        <dc:contributor>sampsone &lt;esampson@suse.com&gt;</dc:contributor>
        <dc:contributor>Willy Santos &lt;wsantos@redhat.com&gt;</dc:contributor>
        <dc:contributor>Nagarjuna Sarvepalli &lt;snagarju@redhat.com&gt;</dc:contributor>
        <dc:contributor>Anderson Sasaki &lt;33833274+ansasaki@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Gautam Satish &lt;gautams@hpe.com&gt;</dc:contributor>
        <dc:contributor>Watson Sato &lt;wsato@redhat.com&gt;</dc:contributor>
        <dc:contributor>Satoru SATOH &lt;satoru.satoh@gmail.com&gt;</dc:contributor>
        <dc:contributor>Alexander Scheel &lt;alexander.m.scheel@gmail.com&gt;</dc:contributor>
        <dc:contributor>Bryan Schneiders &lt;pschneiders@trisept.com&gt;</dc:contributor>
        <dc:contributor>Robert Schweikert &lt;rjschwei@suse.com&gt;</dc:contributor>
        <dc:contributor>shaneboulden &lt;shane.boulden@gmail.com&gt;</dc:contributor>
        <dc:contributor>Vincent Shen &lt;wenshen@redhat.com&gt;</dc:contributor>
        <dc:contributor>Dhriti Shikhar &lt;dhriti.shikhar.rokz@gmail.com&gt;</dc:contributor>
        <dc:contributor>Spencer Shimko &lt;sshimko@tresys.com&gt;</dc:contributor>
        <dc:contributor>Mark Shoger &lt;mshoger@redhat.com&gt;</dc:contributor>
        <dc:contributor>Shane Siebken &lt;shane.siebken@capellaspace.com&gt;</dc:contributor>
        <dc:contributor>THOBY Simon &lt;Simon.THOBY@viveris.fr&gt;</dc:contributor>
        <dc:contributor>Thomas Sj&#246;gren &lt;konstruktoid@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Jindrich Skacel &lt;102800748+jskacel@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Alexandre Skrzyniarz &lt;alexandre.skrzyniarz@laposte.net&gt;</dc:contributor>
        <dc:contributor>Francisco Slavin &lt;fslavin@tresys.com&gt;</dc:contributor>
        <dc:contributor>sluetze &lt;13255307+sluetze@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Dave Smith &lt;dsmith@eclipse.ncsc.mil&gt;</dc:contributor>
        <dc:contributor>David Smith &lt;dsmith@fornax.eclipse.ncsc.mil&gt;</dc:contributor>
        <dc:contributor>Kevin Spargur &lt;kspargur@redhat.com&gt;</dc:contributor>
        <dc:contributor>Kenneth Stailey &lt;kstailey.lists@gmail.com&gt;</dc:contributor>
        <dc:contributor>Leland Steinke &lt;leland.j.steinke.ctr@mail.mil&gt;</dc:contributor>
        <dc:contributor>Justin Stephenson &lt;jstephen@redhat.com&gt;</dc:contributor>
        <dc:contributor>steven.y.gui &lt;steven_ygui@163.com&gt;</dc:contributor>
        <dc:contributor>Brian Stinson &lt;brian@bstinson.com&gt;</dc:contributor>
        <dc:contributor>Jake Stookey &lt;jakestookey@gmail.com&gt;</dc:contributor>
        <dc:contributor>Jonathan Sturges &lt;jsturges@redhat.com&gt;</dc:contributor>
        <dc:contributor>svet-se &lt;svetlin.boychev@suse.com&gt;</dc:contributor>
        <dc:contributor>teacup-on-rockingchair &lt;315160+teacup-on-rockingchair@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Ian Tewksbury &lt;itewk@redhat.com&gt;</dc:contributor>
        <dc:contributor>Philippe Thierry &lt;phil@reseau-libre.net&gt;</dc:contributor>
        <dc:contributor>Simon THOBY &lt;git@nightmared.fr&gt;</dc:contributor>
        <dc:contributor>Derek Thurston &lt;thegrit@gmail.com&gt;</dc:contributor>
        <dc:contributor>tianzhenjia &lt;jiatianzhen@cmss.chinamobile.com&gt;</dc:contributor>
        <dc:contributor>Greg Tinsley &lt;gtinsley@redhat.com&gt;</dc:contributor>
        <dc:contributor>Paul Tittle &lt;ptittle@cmf.nrl.navy.mil&gt;</dc:contributor>
        <dc:contributor>tom &lt;tom@localhost.localdomain&gt;</dc:contributor>
        <dc:contributor>tomas.hudik &lt;tomas.hudik@embedit.cz&gt;</dc:contributor>
        <dc:contributor>Jeb Trayer &lt;jeb.d.trayer@uscg.mil&gt;</dc:contributor>
        <dc:contributor>TrilokGeer &lt;tgeer@redhat.com&gt;</dc:contributor>
        <dc:contributor>Viktors Trubovics &lt;viktors.trubovics@suse.com&gt;</dc:contributor>
        <dc:contributor>Nico Truzzolino &lt;nico.truzzolino@gmx.de&gt;</dc:contributor>
        <dc:contributor>Brian Turek &lt;brian.turek@gmail.com&gt;</dc:contributor>
        <dc:contributor>Mat&#283;j T&#253;&#269; &lt;matyc@redhat.com&gt;</dc:contributor>
        <dc:contributor>VadimDor &lt;29509093+VadimDor@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Trevor Vaughan &lt;tvaughan@onyxpoint.com&gt;</dc:contributor>
        <dc:contributor>vtrubovics &lt;82443408+vtrubovics@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Samuel Warren &lt;swarren@redhat.com&gt;</dc:contributor>
        <dc:contributor>wcushen &lt;54533890+wcushen@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Shawn Wells &lt;shawn@shawndwells.io&gt;</dc:contributor>
        <dc:contributor>Whidix &lt;31294015+Whidix@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Daniel E. White &lt;linuxdan@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Bernhard M. Wiedemann &lt;bwiedemann@suse.de&gt;</dc:contributor>
        <dc:contributor>Roy Williams &lt;roywilli@roywilli.redhat.com&gt;</dc:contributor>
        <dc:contributor>Willumpie &lt;willumpie@xs4all.nl&gt;</dc:contributor>
        <dc:contributor>Rob Wilmoth &lt;rwilmoth@redhat.com&gt;</dc:contributor>
        <dc:contributor>win97pro &lt;win97pro@protonmail.com&gt;</dc:contributor>
        <dc:contributor>Lucas Yamanishi &lt;lucas.yamanishi@onyxpoint.com&gt;</dc:contributor>
        <dc:contributor>Xirui Yang &lt;xirui.yang@oracle.com&gt;</dc:contributor>
        <dc:contributor>Yuqing Yang &lt;yyq01323329@alibaba-inc.com&gt;</dc:contributor>
        <dc:contributor>yarunachalam &lt;yarunachalam@suse.com&gt;</dc:contributor>
        <dc:contributor>Guang Yee &lt;guang.yee@suse.com&gt;</dc:contributor>
        <dc:contributor>Achilleas John Yfantis &lt;ayfantis@redhat.com&gt;</dc:contributor>
        <dc:contributor>YiLin.Li &lt;YiLin.Li@linux.alibaba.com&gt;</dc:contributor>
        <dc:contributor>YuQing &lt;yyq0391@163.com&gt;</dc:contributor>
        <dc:contributor>Kevin Zimmerman &lt;kevin.zimmerman@kitware.com&gt;</dc:contributor>
        <dc:contributor>Luigi Mario Zuccarelli &lt;luzuccar@redhat.com&gt;</dc:contributor>
        <dc:contributor>Jan &#268;ern&#253; &lt;jcerny@redhat.com&gt;</dc:contributor>
        <dc:contributor>Michal &#352;ruba&#345; &lt;msrubar@redhat.com&gt;</dc:contributor>
        <dc:source>https://github.com/ComplianceAsCode/content/releases/latest</dc:source>
      </ns5:metadata>
      <ns5:Profile id="xccdf_org.ssgproject.content_profile_anssi_bp28">
        <ns5:title override="true">ANSSI-BP-028</ns5:title>
        <ns5:description override="true">Pass</ns5:description>
        <ns5:select idref="xccdf_org.ssgproject.content_rule_accounts_password_pam_dcredit" selected="true" />
        <ns5:select idref="xccdf_org.ssgproject.content_rule_accounts_password_pam_lcredit" selected="true" />
        <ns5:select idref="xccdf_org.ssgproject.content_rule_accounts_password_pam_minlen" selected="true" />
        <ns5:select idref="xccdf_org.ssgproject.content_rule_accounts_password_pam_ocredit" selected="true" />
        <ns5:select idref="xccdf_org.ssgproject.content_rule_accounts_password_pam_ucredit" selected="true" />
        <ns5:select idref="xccdf_org.ssgproject.content_rule_accounts_password_pam_unix_remember" selected="true" />
        <ns5:select idref="xccdf_org.ssgproject.content_rule_accounts_tmout" selected="true" />
        <ns5:select idref="xccdf_org.ssgproject.content_rule_accounts_umask_etc_bashrc" selected="true" />
        <ns5:select idref="xccdf_org.ssgproject.content_rule_accounts_umask_etc_login_defs" selected="true" />
        <ns5:select idref="xccdf_org.ssgproject.content_rule_accounts_umask_etc_profile" selected="true" />
        <ns5:refine-value idref="xccdf_org.ssgproject.content_value_var_password_pam_minlen" selector="15" />
        <ns5:refine-value idref="xccdf_org.ssgproject.content_value_var_password_pam_ocredit" selector="1" />
        <ns5:refine-value idref="xccdf_org.ssgproject.content_value_var_password_pam_dcredit" selector="1" />
        <ns5:refine-value idref="xccdf_org.ssgproject.content_value_var_password_pam_ucredit" selector="1" />
        <ns5:refine-value idref="xccdf_org.ssgproject.content_value_var_password_pam_lcredit" selector="1" />
        <ns5:refine-value idref="xccdf_org.ssgproject.content_value_var_password_pam_unix_remember" selector="2" />
        <ns5:refine-value idref="xccdf_org.ssgproject.content_value_var_accounts_tmout" selector="10_min" />
        <ns5:refine-value idref="xccdf_org.ssgproject.content_value_var_accounts_user_umask" selector="077" />
      </ns5:Profile>
      <ns5:Group id="xccdf_org.ssgproject.content_group_system">
        <ns5:title>System Settings</ns5:title>
        <ns5:description>Contains rules that check correct system settings.</ns5:description>
        <ns5:Group id="xccdf_org.ssgproject.content_group_accounts">
          <ns5:title>Account and Access Control</ns5:title>
          <ns5:description>In traditional Unix security, if an attacker gains
shell access to a certain login account, they can perform any action
or access any file to which that account has access. Therefore,
making it more difficult for unauthorized people to gain shell
access to accounts, particularly to privileged accounts, is a
necessary part of securing a system. This section introduces
mechanisms for restricting access to accounts under
Gentoo.</ns5:description>
          <ns5:Group id="xccdf_org.ssgproject.content_group_accounts-pam">
            <ns5:title>Protect Accounts by Configuring PAM</ns5:title>
            <ns5:description>PAM, or Pluggable Authentication Modules, is a system
which implements modular authentication for Linux programs. PAM provides
a flexible and configurable architecture for authentication, and it should be configured
to minimize exposure to unnecessary risk. This section contains
guidance on how to accomplish that.
<html:br />
       <html:br />
PAM is implemented as a set of shared objects which are
loaded and invoked whenever an application wishes to authenticate a
user. Typically, the application must be running as root in order
to take advantage of PAM, because PAM's modules often need to be able
to access sensitive stores of account information, such as /etc/shadow.
Traditional privileged network listeners
(e.g. sshd) or SUID programs (e.g. sudo) already meet this
requirement. An SUID root application, userhelper, is provided so
that programs which are not SUID or privileged themselves can still
take advantage of PAM.
<html:br />
       <html:br />
PAM looks in the directory <html:code>/etc/pam.d</html:code> for
application-specific configuration information. For instance, if
the program login attempts to authenticate a user, then PAM's
libraries follow the instructions in the file <html:code>/etc/pam.d/login</html:code>
to determine what actions should be taken.
<html:br />
       <html:br />
One very important file in <html:code>/etc/pam.d</html:code> is
<html:code>/etc/pam.d/system-auth</html:code>. This file, which is included by
many other PAM configuration files, defines 'default' system authentication
measures. Modifying this file is a good way to make far-reaching
authentication changes, for instance when implementing a
centralized authentication service.</ns5:description>
            <ns5:warning category="functionality">Be careful when making changes to PAM's configuration files.
The syntax for these files is complex, and modifications can
have unexpected consequences. The default configurations shipped
with applications should be sufficient for most users.</ns5:warning>
            <ns5:warning category="functionality">Running <html:code>authconfig</html:code> or <html:code>system-config-authentication</html:code>
will re-write the PAM configuration files, destroying any manually
made changes and replacing them with a series of system defaults.
One reference to the configuration file syntax can be found at

<html:a href="https://fossies.org/linux/Linux-PAM-docs/doc/sag/Linux-PAM_SAG.pdf">https://fossies.org/linux/Linux-PAM-docs/doc/sag/Linux-PAM_SAG.pdf</html:a>.</ns5:warning>
            <ns5:Value id="xccdf_org.ssgproject.content_value_var_password_pam_unix_remember" type="number">
              <ns5:title>remember</ns5:title>
              <ns5:description>The last n passwords for each user are saved in
<html:code>/etc/security/opasswd</html:code> in order to force password change history and
keep the user from alternating between the same password too
frequently.</ns5:description>
              <ns5:value selector="0">0</ns5:value>
              <ns5:value selector="10">10</ns5:value>
              <ns5:value selector="24">24</ns5:value>
              <ns5:value selector="2">2</ns5:value>
              <ns5:value selector="4">4</ns5:value>
              <ns5:value selector="5">5</ns5:value>
              <ns5:value>5</ns5:value>
            </ns5:Value>
            <ns5:Group id="xccdf_org.ssgproject.content_group_locking_out_password_attempts">
              <ns5:title>Set Lockouts for Failed Password Attempts</ns5:title>
              <ns5:description>The <html:code>pam_faillock</html:code> PAM module provides the capability to
lock out user accounts after a number of failed login attempts. Its
documentation is available in
<html:code>/usr/share/doc/pam-VERSION/txts/README.pam_faillock</html:code>.
<html:br />
        <html:br />
       </ns5:description>
              <ns5:warning category="general">Locking out user accounts presents the
risk of a denial-of-service attack. The lockout policy
must weigh whether the risk of such a
denial-of-service attack outweighs the benefits of thwarting
password guessing attacks.</ns5:warning>
              <ns5:Rule selected="false" id="xccdf_org.ssgproject.content_rule_accounts_password_pam_unix_remember" severity="medium">
                <ns5:title>Limit Password Reuse</ns5:title>
                <ns5:description>Do not allow users to reuse recent passwords. This can be accomplished by using the
<html:code>remember</html:code> option for the <html:code>pam_unix</html:code> or <html:code>pam_pwhistory</html:code> PAM modules.</ns5:description>
                <ns5:warning category="general">If the system relies on <html:code>authselect</html:code> tool to manage PAM settings, the remediation
will also use <html:code>authselect</html:code> tool. However, if any manual modification was made in
PAM files, the <html:code>authselect</html:code> integrity check will fail and the remediation will be
aborted in order to preserve intentional changes. In this case, an informative message will
be shown in the remediation report.</ns5:warning>
                <ns5:warning category="general">Newer versions of <html:code>authselect</html:code> contain an authselect feature to easily and properly
enable <html:code>pam_pwhistory.so</html:code> module. If this feature is not yet available in your
system, an authselect custom profile must be used to avoid integrity issues in PAM files.</ns5:warning>
                <ns5:reference href="https://www.cisecurity.org/controls/">1</ns5:reference>
                <ns5:reference href="https://www.cisecurity.org/controls/">12</ns5:reference>
                <ns5:reference href="https://www.cisecurity.org/controls/">15</ns5:reference>
                <ns5:reference href="https://www.cisecurity.org/controls/">16</ns5:reference>
                <ns5:reference href="https://www.cisecurity.org/controls/">5</ns5:reference>
                <ns5:reference href="https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf">5.6.2.1.1</ns5:reference>
                <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.04</ns5:reference>
                <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.05</ns5:reference>
                <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.07</ns5:reference>
                <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.10</ns5:reference>
                <ns5:reference href="https://www.isaca.org/resources/cobit">DSS06.03</ns5:reference>
                <ns5:reference href="https://www.isaca.org/resources/cobit">DSS06.10</ns5:reference>
                <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf">3.5.8</ns5:reference>
                <ns5:reference href="https://public.cyber.mil/stigs/cci/">CCI-000200</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.2.2</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.5.1</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.5.2</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.1</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.2</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.3</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.4</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.5</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.6</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.7</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.8</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.9</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.7.2</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.7.4</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.1</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.10</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.2</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.3</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.4</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.5</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.7</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.8</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.9</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 2.1</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.18.1.4</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.7.1.1</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.1</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.2</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.3</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.4</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.6</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.3.1</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.4.2</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.4.3</ns5:reference>
                <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(f)</ns5:reference>
                <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(1)(e)</ns5:reference>
                <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">PR.AC-1</ns5:reference>
                <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">PR.AC-6</ns5:reference>
                <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">PR.AC-7</ns5:reference>
                <ns5:reference href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf">Req-8.2.5</ns5:reference>
                <ns5:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os">SRG-OS-000077-GPOS-00045</ns5:reference>
                <ns5:reference href="https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf">R31</ns5:reference>
                <ns5:reference href="https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf">8.3.7</ns5:reference>
                <ns5:rationale>Preventing re-use of previous passwords helps ensure that a compromised password is not
re-used by a user.</ns5:rationale>
                <ns5:platform idref="#package_pam" />
                <ns5:fix system="urn:xccdf:fix:script:sh" id="accounts_password_pam_unix_remember"># Remediation is applicable only in certain platforms
if rpm --quiet -q pam; then

var_password_pam_unix_remember='<ns5:sub idref="xccdf_org.ssgproject.content_value_var_password_pam_unix_remember" use="legacy" />'






if [ -f /usr/bin/authselect ]; then
    if authselect list-features minimal | grep -q with-pwhistory; then
        if ! authselect check; then
        echo "
        authselect integrity check failed. Remediation aborted!
        This remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.
        It is not recommended to manually edit the PAM files when authselect tool is available.
        In cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended."
        exit 1
        fi
        authselect enable-feature with-pwhistory

        authselect apply-changes -b
    else
        
        if ! authselect check; then
        echo "
        authselect integrity check failed. Remediation aborted!
        This remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.
        It is not recommended to manually edit the PAM files when authselect tool is available.
        In cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended."
        exit 1
        fi

        CURRENT_PROFILE=$(authselect current -r | awk '{ print $1 }')
        # If not already in use, a custom profile is created preserving the enabled features.
        if [[ ! $CURRENT_PROFILE == custom/* ]]; then
            ENABLED_FEATURES=$(authselect current | tail -n+3 | awk '{ print $2 }')
            authselect create-profile hardening -b $CURRENT_PROFILE
            CURRENT_PROFILE="custom/hardening"
            
            authselect apply-changes -b --backup=before-hardening-custom-profile
            authselect select $CURRENT_PROFILE
            for feature in $ENABLED_FEATURES; do
                authselect enable-feature $feature;
            done
            
            authselect apply-changes -b --backup=after-hardening-custom-profile
        fi
        PAM_FILE_NAME=$(basename "/etc/pam.d/system-auth")
        PAM_FILE_PATH="/etc/authselect/$CURRENT_PROFILE/$PAM_FILE_NAME"

        authselect apply-changes -b
        if ! grep -qP '^\s*password\s+'"requisite"'\s+pam_pwhistory.so\s*.*' "$PAM_FILE_PATH"; then
            # Line matching group + control + module was not found. Check group + module.
            if [ "$(grep -cP '^\s*password\s+.*\s+pam_pwhistory.so\s*' "$PAM_FILE_PATH")" -eq 1 ]; then
                # The control is updated only if one single line matches.
                sed -i -E --follow-symlinks 's/^(\s*password\s+).*(\bpam_pwhistory.so.*)/\1'"requisite"' \2/' "$PAM_FILE_PATH"
            else
                LAST_MATCH_LINE=$(grep -nP "^password.*requisite.*pam_pwquality\.so" "$PAM_FILE_PATH" | tail -n 1 | cut -d: -f 1)
                if [ ! -z $LAST_MATCH_LINE ]; then
                    sed -i --follow-symlinks $LAST_MATCH_LINE' a password     '"requisite"'    pam_pwhistory.so' "$PAM_FILE_PATH"
                else
                    echo 'password    '"requisite"'    pam_pwhistory.so' &gt;&gt; "$PAM_FILE_PATH"
                fi
            fi
        fi
    fi
else
    if ! grep -qP '^\s*password\s+'"requisite"'\s+pam_pwhistory.so\s*.*' "/etc/pam.d/system-auth"; then
        # Line matching group + control + module was not found. Check group + module.
        if [ "$(grep -cP '^\s*password\s+.*\s+pam_pwhistory.so\s*' "/etc/pam.d/system-auth")" -eq 1 ]; then
            # The control is updated only if one single line matches.
            sed -i -E --follow-symlinks 's/^(\s*password\s+).*(\bpam_pwhistory.so.*)/\1'"requisite"' \2/' "/etc/pam.d/system-auth"
        else
            LAST_MATCH_LINE=$(grep -nP "^password.*requisite.*pam_pwquality\.so" "/etc/pam.d/system-auth" | tail -n 1 | cut -d: -f 1)
            if [ ! -z $LAST_MATCH_LINE ]; then
                sed -i --follow-symlinks $LAST_MATCH_LINE' a password     '"requisite"'    pam_pwhistory.so' "/etc/pam.d/system-auth"
            else
                echo 'password    '"requisite"'    pam_pwhistory.so' &gt;&gt; "/etc/pam.d/system-auth"
            fi
        fi
    fi
fi

PWHISTORY_CONF="/etc/security/pwhistory.conf"
if [ -f $PWHISTORY_CONF ]; then
    regex="^\s*remember\s*="
    line="remember = $var_password_pam_unix_remember"
    if ! grep -q $regex $PWHISTORY_CONF; then
        echo $line &gt;&gt; $PWHISTORY_CONF
    else
        sed -i --follow-symlinks 's|^\s*\(remember\s*=\s*\)\(\S\+\)|\1'"$var_password_pam_unix_remember"'|g' $PWHISTORY_CONF
    fi
    if [ -e "/etc/pam.d/system-auth" ] ; then
        PAM_FILE_PATH="/etc/pam.d/system-auth"
        if [ -f /usr/bin/authselect ]; then
            
            if ! authselect check; then
            echo "
            authselect integrity check failed. Remediation aborted!
            This remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.
            It is not recommended to manually edit the PAM files when authselect tool is available.
            In cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended."
            exit 1
            fi

            CURRENT_PROFILE=$(authselect current -r | awk '{ print $1 }')
            # If not already in use, a custom profile is created preserving the enabled features.
            if [[ ! $CURRENT_PROFILE == custom/* ]]; then
                ENABLED_FEATURES=$(authselect current | tail -n+3 | awk '{ print $2 }')
                authselect create-profile hardening -b $CURRENT_PROFILE
                CURRENT_PROFILE="custom/hardening"
                
                authselect apply-changes -b --backup=before-hardening-custom-profile
                authselect select $CURRENT_PROFILE
                for feature in $ENABLED_FEATURES; do
                    authselect enable-feature $feature;
                done
                
                authselect apply-changes -b --backup=after-hardening-custom-profile
            fi
            PAM_FILE_NAME=$(basename "/etc/pam.d/system-auth")
            PAM_FILE_PATH="/etc/authselect/$CURRENT_PROFILE/$PAM_FILE_NAME"

            authselect apply-changes -b
        fi
        
    if grep -qP '^\s*password\s.*\bpam_pwhistory.so\s.*\bremember\b' "$PAM_FILE_PATH"; then
        sed -i -E --follow-symlinks 's/(.*password.*pam_pwhistory.so.*)\bremember\b=?[[:alnum:]]*(.*)/\1\2/g' "$PAM_FILE_PATH"
    fi
        if [ -f /usr/bin/authselect ]; then
            
            authselect apply-changes -b
        fi
    else
        echo "/etc/pam.d/system-auth was not found" &gt;&amp;2
    fi
else
    PAM_FILE_PATH="/etc/pam.d/system-auth"
    if [ -f /usr/bin/authselect ]; then
        
        if ! authselect check; then
        echo "
        authselect integrity check failed. Remediation aborted!
        This remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.
        It is not recommended to manually edit the PAM files when authselect tool is available.
        In cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended."
        exit 1
        fi

        CURRENT_PROFILE=$(authselect current -r | awk '{ print $1 }')
        # If not already in use, a custom profile is created preserving the enabled features.
        if [[ ! $CURRENT_PROFILE == custom/* ]]; then
            ENABLED_FEATURES=$(authselect current | tail -n+3 | awk '{ print $2 }')
            authselect create-profile hardening -b $CURRENT_PROFILE
            CURRENT_PROFILE="custom/hardening"
            
            authselect apply-changes -b --backup=before-hardening-custom-profile
            authselect select $CURRENT_PROFILE
            for feature in $ENABLED_FEATURES; do
                authselect enable-feature $feature;
            done
            
            authselect apply-changes -b --backup=after-hardening-custom-profile
        fi
        PAM_FILE_NAME=$(basename "/etc/pam.d/system-auth")
        PAM_FILE_PATH="/etc/authselect/$CURRENT_PROFILE/$PAM_FILE_NAME"

        authselect apply-changes -b
    fi
    if ! grep -qP '^\s*password\s+'"requisite"'\s+pam_pwhistory.so\s*.*' "$PAM_FILE_PATH"; then
        # Line matching group + control + module was not found. Check group + module.
        if [ "$(grep -cP '^\s*password\s+.*\s+pam_pwhistory.so\s*' "$PAM_FILE_PATH")" -eq 1 ]; then
            # The control is updated only if one single line matches.
            sed -i -E --follow-symlinks 's/^(\s*password\s+).*(\bpam_pwhistory.so.*)/\1'"requisite"' \2/' "$PAM_FILE_PATH"
        else
            echo 'password    '"requisite"'    pam_pwhistory.so' &gt;&gt; "$PAM_FILE_PATH"
        fi
    fi
    # Check the option
    if ! grep -qP '^\s*password\s+'"requisite"'\s+pam_pwhistory.so\s*.*\sremember\b' "$PAM_FILE_PATH"; then
        sed -i -E --follow-symlinks '/\s*password\s+'"requisite"'\s+pam_pwhistory.so.*/ s/$/ remember='"$var_password_pam_unix_remember"'/' "$PAM_FILE_PATH"
    else
        sed -i -E --follow-symlinks 's/(\s*password\s+'"requisite"'\s+pam_pwhistory.so\s+.*)('"remember"'=)[[:alnum:]]+\s*(.*)/\1\2'"$var_password_pam_unix_remember"' \3/' "$PAM_FILE_PATH"
    fi
    if [ -f /usr/bin/authselect ]; then
        
        authselect apply-changes -b
    fi
fi

else
    &gt;&amp;2 echo 'Remediation is not applicable, nothing was done'
fi
</ns5:fix>
                <ns5:fix system="urn:xccdf:fix:script:ansible" id="accounts_password_pam_unix_remember" complexity="low" disruption="medium" reboot="false" strategy="configure">- name: Gather the package facts
  package_facts:
    manager: auto
  tags:
  - CJIS-5.6.2.1.1
  - NIST-800-171-3.5.8
  - NIST-800-53-IA-5(1)(e)
  - NIST-800-53-IA-5(f)
  - PCI-DSS-Req-8.2.5
  - PCI-DSSv4-8.3.7
  - accounts_password_pam_unix_remember
  - configure_strategy
  - low_complexity
  - medium_disruption
  - medium_severity
  - no_reboot_needed
- name: XCCDF Value var_password_pam_unix_remember # promote to variable
  set_fact:
    var_password_pam_unix_remember: !!str <ns5:sub idref="xccdf_org.ssgproject.content_value_var_password_pam_unix_remember" use="legacy" />
  tags:
    - always

- name: Limit Password Reuse - Check if system relies on authselect tool
  ansible.builtin.stat:
    path: /usr/bin/authselect
  register: result_authselect_present
  when: '"pam" in ansible_facts.packages'
  tags:
  - CJIS-5.6.2.1.1
  - NIST-800-171-3.5.8
  - NIST-800-53-IA-5(1)(e)
  - NIST-800-53-IA-5(f)
  - PCI-DSS-Req-8.2.5
  - PCI-DSSv4-8.3.7
  - accounts_password_pam_unix_remember
  - configure_strategy
  - low_complexity
  - medium_disruption
  - medium_severity
  - no_reboot_needed

- name: Limit Password Reuse - Collect the available authselect features
  ansible.builtin.command:
    cmd: authselect list-features minimal
  register: result_authselect_available_features
  changed_when: false
  when:
  - '"pam" in ansible_facts.packages'
  - result_authselect_present.stat.exists
  tags:
  - CJIS-5.6.2.1.1
  - NIST-800-171-3.5.8
  - NIST-800-53-IA-5(1)(e)
  - NIST-800-53-IA-5(f)
  - PCI-DSS-Req-8.2.5
  - PCI-DSSv4-8.3.7
  - accounts_password_pam_unix_remember
  - configure_strategy
  - low_complexity
  - medium_disruption
  - medium_severity
  - no_reboot_needed

- name: Limit Password Reuse - Enable pam_pwhistory.so using authselect feature
  block:

  - name: Limit Password Reuse - Check integrity of authselect current profile
    ansible.builtin.command:
      cmd: authselect check
    register: result_authselect_check_cmd
    changed_when: false
    failed_when: false

  - name: Limit Password Reuse - Informative message based on the authselect integrity
      check result
    ansible.builtin.assert:
      that:
      - result_authselect_check_cmd.rc == 0
      fail_msg:
      - authselect integrity check failed. Remediation aborted!
      - This remediation could not be applied because an authselect profile was not
        selected or the selected profile is not intact.
      - It is not recommended to manually edit the PAM files when authselect tool
        is available.
      - In cases where the default authselect profile does not cover a specific demand,
        a custom authselect profile is recommended.
      success_msg:
      - authselect integrity check passed

  - name: Limit Password Reuse - Get authselect current features
    ansible.builtin.shell:
      cmd: authselect current | tail -n+3 | awk '{ print $2 }'
    register: result_authselect_features
    changed_when: false
    when:
    - result_authselect_check_cmd is success

  - name: Limit Password Reuse - Ensure "with-pwhistory" feature is enabled using
      authselect tool
    ansible.builtin.command:
      cmd: authselect enable-feature with-pwhistory
    register: result_authselect_enable_feature_cmd
    when:
    - result_authselect_check_cmd is success
    - result_authselect_features.stdout is not search("with-pwhistory")

  - name: Limit Password Reuse - Ensure authselect changes are applied
    ansible.builtin.command:
      cmd: authselect apply-changes -b
    when:
    - result_authselect_enable_feature_cmd is not skipped
    - result_authselect_enable_feature_cmd is success
  when:
  - '"pam" in ansible_facts.packages'
  - result_authselect_present.stat.exists
  - result_authselect_available_features.stdout is search("with-pwhistory")
  tags:
  - CJIS-5.6.2.1.1
  - NIST-800-171-3.5.8
  - NIST-800-53-IA-5(1)(e)
  - NIST-800-53-IA-5(f)
  - PCI-DSS-Req-8.2.5
  - PCI-DSSv4-8.3.7
  - accounts_password_pam_unix_remember
  - configure_strategy
  - low_complexity
  - medium_disruption
  - medium_severity
  - no_reboot_needed

- name: Limit Password Reuse - Enable pam_pwhistory.so in appropriate PAM files
  block:

  - name: Limit Password Reuse - Define the PAM file to be edited as a local fact
    ansible.builtin.set_fact:
      pam_file_path: /etc/pam.d/system-auth

  - name: Limit Password Reuse - Check if system relies on authselect tool
    ansible.builtin.stat:
      path: /usr/bin/authselect
    register: result_authselect_present

  - name: Limit Password Reuse - Ensure authselect custom profile is used if authselect
      is present
    block:

    - name: Limit Password Reuse - Check integrity of authselect current profile
      ansible.builtin.command:
        cmd: authselect check
      register: result_authselect_check_cmd
      changed_when: false
      failed_when: false

    - name: Limit Password Reuse - Informative message based on the authselect integrity
        check result
      ansible.builtin.assert:
        that:
        - result_authselect_check_cmd.rc == 0
        fail_msg:
        - authselect integrity check failed. Remediation aborted!
        - This remediation could not be applied because an authselect profile was
          not selected or the selected profile is not intact.
        - It is not recommended to manually edit the PAM files when authselect tool
          is available.
        - In cases where the default authselect profile does not cover a specific
          demand, a custom authselect profile is recommended.
        success_msg:
        - authselect integrity check passed

    - name: Limit Password Reuse - Get authselect current profile
      ansible.builtin.shell:
        cmd: authselect current -r | awk '{ print $1 }'
      register: result_authselect_profile
      changed_when: false
      when:
      - result_authselect_check_cmd is success

    - name: Limit Password Reuse - Define the current authselect profile as a local
        fact
      ansible.builtin.set_fact:
        authselect_current_profile: '{{ result_authselect_profile.stdout }}'
        authselect_custom_profile: '{{ result_authselect_profile.stdout }}'
      when:
      - result_authselect_profile is not skipped
      - result_authselect_profile.stdout is match("custom/")

    - name: Limit Password Reuse - Define the new authselect custom profile as a local
        fact
      ansible.builtin.set_fact:
        authselect_current_profile: '{{ result_authselect_profile.stdout }}'
        authselect_custom_profile: custom/hardening
      when:
      - result_authselect_profile is not skipped
      - result_authselect_profile.stdout is not match("custom/")

    - name: Limit Password Reuse - Get authselect current features to also enable
        them in the custom profile
      ansible.builtin.shell:
        cmd: authselect current | tail -n+3 | awk '{ print $2 }'
      register: result_authselect_features
      changed_when: false
      when:
      - result_authselect_profile is not skipped
      - authselect_current_profile is not match("custom/")

    - name: Limit Password Reuse - Check if any custom profile with the same name
        was already created
      ansible.builtin.stat:
        path: /etc/authselect/{{ authselect_custom_profile }}
      register: result_authselect_custom_profile_present
      changed_when: false
      when:
      - authselect_current_profile is not match("custom/")

    - name: Limit Password Reuse - Create an authselect custom profile based on the
        current profile
      ansible.builtin.command:
        cmd: authselect create-profile hardening -b {{ authselect_current_profile
          }}
      when:
      - result_authselect_check_cmd is success
      - authselect_current_profile is not match("custom/")
      - not result_authselect_custom_profile_present.stat.exists

    - name: Limit Password Reuse - Ensure authselect changes are applied
      ansible.builtin.command:
        cmd: authselect apply-changes -b --backup=before-hardening-custom-profile
      when:
      - result_authselect_check_cmd is success
      - result_authselect_profile is not skipped
      - authselect_current_profile is not match("custom/")
      - authselect_custom_profile is not match(authselect_current_profile)

    - name: Limit Password Reuse - Ensure the authselect custom profile is selected
      ansible.builtin.command:
        cmd: authselect select {{ authselect_custom_profile }}
      register: result_pam_authselect_select_profile
      when:
      - result_authselect_check_cmd is success
      - result_authselect_profile is not skipped
      - authselect_current_profile is not match("custom/")
      - authselect_custom_profile is not match(authselect_current_profile)

    - name: Limit Password Reuse - Restore the authselect features in the custom profile
      ansible.builtin.command:
        cmd: authselect enable-feature {{ item }}
      loop: '{{ result_authselect_features.stdout_lines }}'
      register: result_pam_authselect_restore_features
      when:
      - result_authselect_profile is not skipped
      - result_authselect_features is not skipped
      - result_pam_authselect_select_profile is not skipped

    - name: Limit Password Reuse - Ensure authselect changes are applied
      ansible.builtin.command:
        cmd: authselect apply-changes -b --backup=after-hardening-custom-profile
      when:
      - result_authselect_check_cmd is success
      - result_authselect_profile is not skipped
      - result_pam_authselect_restore_features is not skipped

    - name: Limit Password Reuse - Change the PAM file to be edited according to the
        custom authselect profile
      ansible.builtin.set_fact:
        pam_file_path: /etc/authselect/{{ authselect_custom_profile }}/{{ pam_file_path
          | basename }}
    when:
    - result_authselect_present.stat.exists

  - name: Limit Password Reuse - Check if expected PAM module line is present in {{
      pam_file_path }}
    ansible.builtin.lineinfile:
      path: '{{ pam_file_path }}'
      regexp: ^\s*password\s+{{ 'requisite' | regex_escape() }}\s+pam_pwhistory.so\s*.*
      state: absent
    check_mode: true
    changed_when: false
    register: result_pam_line_present

  - name: Limit Password Reuse - Include or update the PAM module line in {{ pam_file_path
      }}
    block:

    - name: Limit Password Reuse - Check if required PAM module line is present in
        {{ pam_file_path }} with different control
      ansible.builtin.lineinfile:
        path: '{{ pam_file_path }}'
        regexp: ^\s*password\s+.*\s+pam_pwhistory.so\s*
        state: absent
      check_mode: true
      changed_when: false
      register: result_pam_line_other_control_present

    - name: Limit Password Reuse - Ensure the correct control for the required PAM
        module line in {{ pam_file_path }}
      ansible.builtin.replace:
        dest: '{{ pam_file_path }}'
        regexp: ^(\s*password\s+).*(\bpam_pwhistory.so.*)
        replace: \1requisite \2
      register: result_pam_module_edit
      when:
      - result_pam_line_other_control_present.found == 1

    - name: Limit Password Reuse - Ensure the required PAM module line is included
        in {{ pam_file_path }}
      ansible.builtin.lineinfile:
        dest: '{{ pam_file_path }}'
        insertafter: ^password.*requisite.*pam_pwquality\.so
        line: password    requisite    pam_pwhistory.so
      register: result_pam_module_add
      when:
      - result_pam_line_other_control_present.found == 0 or result_pam_line_other_control_present.found
        &gt; 1

    - name: Limit Password Reuse - Ensure authselect changes are applied
      ansible.builtin.command:
        cmd: authselect apply-changes -b
      when:
      - result_authselect_present is defined
      - result_authselect_present.stat.exists
      - |-
        (result_pam_module_add is defined and result_pam_module_add.changed)
         or (result_pam_module_edit is defined and result_pam_module_edit.changed)
    when:
    - result_pam_line_present.found is defined
    - result_pam_line_present.found == 0
  when:
  - '"pam" in ansible_facts.packages'
  - |
    (result_authselect_available_features.stdout is defined and result_authselect_available_features.stdout is not search("with-pwhistory")) or result_authselect_available_features is not defined
  tags:
  - CJIS-5.6.2.1.1
  - NIST-800-171-3.5.8
  - NIST-800-53-IA-5(1)(e)
  - NIST-800-53-IA-5(f)
  - PCI-DSS-Req-8.2.5
  - PCI-DSSv4-8.3.7
  - accounts_password_pam_unix_remember
  - configure_strategy
  - low_complexity
  - medium_disruption
  - medium_severity
  - no_reboot_needed

- name: Limit Password Reuse - Check the presence of /etc/security/pwhistory.conf
    file
  ansible.builtin.stat:
    path: /etc/security/pwhistory.conf
  register: result_pwhistory_conf_check
  when: '"pam" in ansible_facts.packages'
  tags:
  - CJIS-5.6.2.1.1
  - NIST-800-171-3.5.8
  - NIST-800-53-IA-5(1)(e)
  - NIST-800-53-IA-5(f)
  - PCI-DSS-Req-8.2.5
  - PCI-DSSv4-8.3.7
  - accounts_password_pam_unix_remember
  - configure_strategy
  - low_complexity
  - medium_disruption
  - medium_severity
  - no_reboot_needed

- name: Limit Password Reuse - pam_pwhistory.so parameters are configured in /etc/security/pwhistory.conf
    file
  block:

  - name: Limit Password Reuse - Ensure the pam_pwhistory.so remember parameter in
      /etc/security/pwhistory.conf
    ansible.builtin.lineinfile:
      path: /etc/security/pwhistory.conf
      regexp: ^\s*remember\s*=
      line: remember = {{ var_password_pam_unix_remember }}
      state: present

  - name: Limit Password Reuse - Ensure the pam_pwhistory.so remember parameter is
      removed from PAM files
    block:

    - name: Limit Password Reuse - Check if /etc/pam.d/system-auth file is present
      ansible.builtin.stat:
        path: /etc/pam.d/system-auth
      register: result_pam_file_present

    - name: Limit Password Reuse - Check the proper remediation for the system
      block:

      - name: Limit Password Reuse - Define the PAM file to be edited as a local fact
        ansible.builtin.set_fact:
          pam_file_path: /etc/pam.d/system-auth

      - name: Limit Password Reuse - Check if system relies on authselect tool
        ansible.builtin.stat:
          path: /usr/bin/authselect
        register: result_authselect_present

      - name: Limit Password Reuse - Ensure authselect custom profile is used if authselect
          is present
        block:

        - name: Limit Password Reuse - Check integrity of authselect current profile
          ansible.builtin.command:
            cmd: authselect check
          register: result_authselect_check_cmd
          changed_when: false
          failed_when: false

        - name: Limit Password Reuse - Informative message based on the authselect
            integrity check result
          ansible.builtin.assert:
            that:
            - result_authselect_check_cmd.rc == 0
            fail_msg:
            - authselect integrity check failed. Remediation aborted!
            - This remediation could not be applied because an authselect profile
              was not selected or the selected profile is not intact.
            - It is not recommended to manually edit the PAM files when authselect
              tool is available.
            - In cases where the default authselect profile does not cover a specific
              demand, a custom authselect profile is recommended.
            success_msg:
            - authselect integrity check passed

        - name: Limit Password Reuse - Get authselect current profile
          ansible.builtin.shell:
            cmd: authselect current -r | awk '{ print $1 }'
          register: result_authselect_profile
          changed_when: false
          when:
          - result_authselect_check_cmd is success

        - name: Limit Password Reuse - Define the current authselect profile as a
            local fact
          ansible.builtin.set_fact:
            authselect_current_profile: '{{ result_authselect_profile.stdout }}'
            authselect_custom_profile: '{{ result_authselect_profile.stdout }}'
          when:
          - result_authselect_profile is not skipped
          - result_authselect_profile.stdout is match("custom/")

        - name: Limit Password Reuse - Define the new authselect custom profile as
            a local fact
          ansible.builtin.set_fact:
            authselect_current_profile: '{{ result_authselect_profile.stdout }}'
            authselect_custom_profile: custom/hardening
          when:
          - result_authselect_profile is not skipped
          - result_authselect_profile.stdout is not match("custom/")

        - name: Limit Password Reuse - Get authselect current features to also enable
            them in the custom profile
          ansible.builtin.shell:
            cmd: authselect current | tail -n+3 | awk '{ print $2 }'
          register: result_authselect_features
          changed_when: false
          when:
          - result_authselect_profile is not skipped
          - authselect_current_profile is not match("custom/")

        - name: Limit Password Reuse - Check if any custom profile with the same name
            was already created
          ansible.builtin.stat:
            path: /etc/authselect/{{ authselect_custom_profile }}
          register: result_authselect_custom_profile_present
          changed_when: false
          when:
          - authselect_current_profile is not match("custom/")

        - name: Limit Password Reuse - Create an authselect custom profile based on
            the current profile
          ansible.builtin.command:
            cmd: authselect create-profile hardening -b {{ authselect_current_profile
              }}
          when:
          - result_authselect_check_cmd is success
          - authselect_current_profile is not match("custom/")
          - not result_authselect_custom_profile_present.stat.exists

        - name: Limit Password Reuse - Ensure authselect changes are applied
          ansible.builtin.command:
            cmd: authselect apply-changes -b --backup=before-hardening-custom-profile
          when:
          - result_authselect_check_cmd is success
          - result_authselect_profile is not skipped
          - authselect_current_profile is not match("custom/")
          - authselect_custom_profile is not match(authselect_current_profile)

        - name: Limit Password Reuse - Ensure the authselect custom profile is selected
          ansible.builtin.command:
            cmd: authselect select {{ authselect_custom_profile }}
          register: result_pam_authselect_select_profile
          when:
          - result_authselect_check_cmd is success
          - result_authselect_profile is not skipped
          - authselect_current_profile is not match("custom/")
          - authselect_custom_profile is not match(authselect_current_profile)

        - name: Limit Password Reuse - Restore the authselect features in the custom
            profile
          ansible.builtin.command:
            cmd: authselect enable-feature {{ item }}
          loop: '{{ result_authselect_features.stdout_lines }}'
          register: result_pam_authselect_restore_features
          when:
          - result_authselect_profile is not skipped
          - result_authselect_features is not skipped
          - result_pam_authselect_select_profile is not skipped

        - name: Limit Password Reuse - Ensure authselect changes are applied
          ansible.builtin.command:
            cmd: authselect apply-changes -b --backup=after-hardening-custom-profile
          when:
          - result_authselect_check_cmd is success
          - result_authselect_profile is not skipped
          - result_pam_authselect_restore_features is not skipped

        - name: Limit Password Reuse - Change the PAM file to be edited according
            to the custom authselect profile
          ansible.builtin.set_fact:
            pam_file_path: /etc/authselect/{{ authselect_custom_profile }}/{{ pam_file_path
              | basename }}
        when:
        - result_authselect_present.stat.exists

      - name: Limit Password Reuse - Ensure the "remember" option from "pam_pwhistory.so"
          is not present in {{ pam_file_path }}
        ansible.builtin.replace:
          dest: '{{ pam_file_path }}'
          regexp: (.*password.*pam_pwhistory.so.*)\bremember\b=?[0-9a-zA-Z]*(.*)
          replace: \1\2
        register: result_pam_option_removal

      - name: Limit Password Reuse - Ensure authselect changes are applied
        ansible.builtin.command:
          cmd: authselect apply-changes -b
        when:
        - result_authselect_present.stat.exists
        - result_pam_option_removal is changed
      when:
      - result_pam_file_present.stat.exists
  when:
  - '"pam" in ansible_facts.packages'
  - result_pwhistory_conf_check.stat.exists
  tags:
  - CJIS-5.6.2.1.1
  - NIST-800-171-3.5.8
  - NIST-800-53-IA-5(1)(e)
  - NIST-800-53-IA-5(f)
  - PCI-DSS-Req-8.2.5
  - PCI-DSSv4-8.3.7
  - accounts_password_pam_unix_remember
  - configure_strategy
  - low_complexity
  - medium_disruption
  - medium_severity
  - no_reboot_needed

- name: Limit Password Reuse - pam_pwhistory.so parameters are configured in PAM files
  block:

  - name: Limit Password Reuse - Define the PAM file to be edited as a local fact
    ansible.builtin.set_fact:
      pam_file_path: /etc/pam.d/system-auth

  - name: Limit Password Reuse - Check if system relies on authselect tool
    ansible.builtin.stat:
      path: /usr/bin/authselect
    register: result_authselect_present

  - name: Limit Password Reuse - Ensure authselect custom profile is used if authselect
      is present
    block:

    - name: Limit Password Reuse - Check integrity of authselect current profile
      ansible.builtin.command:
        cmd: authselect check
      register: result_authselect_check_cmd
      changed_when: false
      failed_when: false

    - name: Limit Password Reuse - Informative message based on the authselect integrity
        check result
      ansible.builtin.assert:
        that:
        - result_authselect_check_cmd.rc == 0
        fail_msg:
        - authselect integrity check failed. Remediation aborted!
        - This remediation could not be applied because an authselect profile was
          not selected or the selected profile is not intact.
        - It is not recommended to manually edit the PAM files when authselect tool
          is available.
        - In cases where the default authselect profile does not cover a specific
          demand, a custom authselect profile is recommended.
        success_msg:
        - authselect integrity check passed

    - name: Limit Password Reuse - Get authselect current profile
      ansible.builtin.shell:
        cmd: authselect current -r | awk '{ print $1 }'
      register: result_authselect_profile
      changed_when: false
      when:
      - result_authselect_check_cmd is success

    - name: Limit Password Reuse - Define the current authselect profile as a local
        fact
      ansible.builtin.set_fact:
        authselect_current_profile: '{{ result_authselect_profile.stdout }}'
        authselect_custom_profile: '{{ result_authselect_profile.stdout }}'
      when:
      - result_authselect_profile is not skipped
      - result_authselect_profile.stdout is match("custom/")

    - name: Limit Password Reuse - Define the new authselect custom profile as a local
        fact
      ansible.builtin.set_fact:
        authselect_current_profile: '{{ result_authselect_profile.stdout }}'
        authselect_custom_profile: custom/hardening
      when:
      - result_authselect_profile is not skipped
      - result_authselect_profile.stdout is not match("custom/")

    - name: Limit Password Reuse - Get authselect current features to also enable
        them in the custom profile
      ansible.builtin.shell:
        cmd: authselect current | tail -n+3 | awk '{ print $2 }'
      register: result_authselect_features
      changed_when: false
      when:
      - result_authselect_profile is not skipped
      - authselect_current_profile is not match("custom/")

    - name: Limit Password Reuse - Check if any custom profile with the same name
        was already created
      ansible.builtin.stat:
        path: /etc/authselect/{{ authselect_custom_profile }}
      register: result_authselect_custom_profile_present
      changed_when: false
      when:
      - authselect_current_profile is not match("custom/")

    - name: Limit Password Reuse - Create an authselect custom profile based on the
        current profile
      ansible.builtin.command:
        cmd: authselect create-profile hardening -b {{ authselect_current_profile
          }}
      when:
      - result_authselect_check_cmd is success
      - authselect_current_profile is not match("custom/")
      - not result_authselect_custom_profile_present.stat.exists

    - name: Limit Password Reuse - Ensure authselect changes are applied
      ansible.builtin.command:
        cmd: authselect apply-changes -b --backup=before-hardening-custom-profile
      when:
      - result_authselect_check_cmd is success
      - result_authselect_profile is not skipped
      - authselect_current_profile is not match("custom/")
      - authselect_custom_profile is not match(authselect_current_profile)

    - name: Limit Password Reuse - Ensure the authselect custom profile is selected
      ansible.builtin.command:
        cmd: authselect select {{ authselect_custom_profile }}
      register: result_pam_authselect_select_profile
      when:
      - result_authselect_check_cmd is success
      - result_authselect_profile is not skipped
      - authselect_current_profile is not match("custom/")
      - authselect_custom_profile is not match(authselect_current_profile)

    - name: Limit Password Reuse - Restore the authselect features in the custom profile
      ansible.builtin.command:
        cmd: authselect enable-feature {{ item }}
      loop: '{{ result_authselect_features.stdout_lines }}'
      register: result_pam_authselect_restore_features
      when:
      - result_authselect_profile is not skipped
      - result_authselect_features is not skipped
      - result_pam_authselect_select_profile is not skipped

    - name: Limit Password Reuse - Ensure authselect changes are applied
      ansible.builtin.command:
        cmd: authselect apply-changes -b --backup=after-hardening-custom-profile
      when:
      - result_authselect_check_cmd is success
      - result_authselect_profile is not skipped
      - result_pam_authselect_restore_features is not skipped

    - name: Limit Password Reuse - Change the PAM file to be edited according to the
        custom authselect profile
      ansible.builtin.set_fact:
        pam_file_path: /etc/authselect/{{ authselect_custom_profile }}/{{ pam_file_path
          | basename }}
    when:
    - result_authselect_present.stat.exists

  - name: Limit Password Reuse - Check if expected PAM module line is present in {{
      pam_file_path }}
    ansible.builtin.lineinfile:
      path: '{{ pam_file_path }}'
      regexp: ^\s*password\s+{{ 'requisite' | regex_escape() }}\s+pam_pwhistory.so\s*.*
      state: absent
    check_mode: true
    changed_when: false
    register: result_pam_line_present

  - name: Limit Password Reuse - Include or update the PAM module line in {{ pam_file_path
      }}
    block:

    - name: Limit Password Reuse - Check if required PAM module line is present in
        {{ pam_file_path }} with different control
      ansible.builtin.lineinfile:
        path: '{{ pam_file_path }}'
        regexp: ^\s*password\s+.*\s+pam_pwhistory.so\s*
        state: absent
      check_mode: true
      changed_when: false
      register: result_pam_line_other_control_present

    - name: Limit Password Reuse - Ensure the correct control for the required PAM
        module line in {{ pam_file_path }}
      ansible.builtin.replace:
        dest: '{{ pam_file_path }}'
        regexp: ^(\s*password\s+).*(\bpam_pwhistory.so.*)
        replace: \1requisite \2
      register: result_pam_module_edit
      when:
      - result_pam_line_other_control_present.found == 1

    - name: Limit Password Reuse - Ensure the required PAM module line is included
        in {{ pam_file_path }}
      ansible.builtin.lineinfile:
        dest: '{{ pam_file_path }}'
        line: password    requisite    pam_pwhistory.so
      register: result_pam_module_add
      when:
      - result_pam_line_other_control_present.found == 0 or result_pam_line_other_control_present.found
        &gt; 1

    - name: Limit Password Reuse - Ensure authselect changes are applied
      ansible.builtin.command:
        cmd: authselect apply-changes -b
      when:
      - result_authselect_present is defined
      - result_authselect_present.stat.exists
      - |-
        (result_pam_module_add is defined and result_pam_module_add.changed)
         or (result_pam_module_edit is defined and result_pam_module_edit.changed)
    when:
    - result_pam_line_present.found is defined
    - result_pam_line_present.found == 0

  - name: Limit Password Reuse - Check if the required PAM module option is present
      in {{ pam_file_path }}
    ansible.builtin.lineinfile:
      path: '{{ pam_file_path }}'
      regexp: ^\s*password\s+{{ 'requisite' | regex_escape() }}\s+pam_pwhistory.so\s*.*\sremember\b
      state: absent
    check_mode: true
    changed_when: false
    register: result_pam_module_remember_option_present

  - name: Limit Password Reuse - Ensure the "remember" PAM option for "pam_pwhistory.so"
      is included in {{ pam_file_path }}
    ansible.builtin.lineinfile:
      path: '{{ pam_file_path }}'
      backrefs: true
      regexp: ^(\s*password\s+{{ 'requisite' | regex_escape() }}\s+pam_pwhistory.so.*)
      line: \1 remember={{ var_password_pam_unix_remember }}
      state: present
    register: result_pam_remember_add
    when:
    - result_pam_module_remember_option_present.found == 0

  - name: Limit Password Reuse - Ensure the required value for "remember" PAM option
      from "pam_pwhistory.so" in {{ pam_file_path }}
    ansible.builtin.lineinfile:
      path: '{{ pam_file_path }}'
      backrefs: true
      regexp: ^(\s*password\s+{{ 'requisite' | regex_escape() }}\s+pam_pwhistory.so\s+.*)(remember)=[0-9a-zA-Z]+\s*(.*)
      line: \1\2={{ var_password_pam_unix_remember }} \3
    register: result_pam_remember_edit
    when:
    - result_pam_module_remember_option_present.found &gt; 0

  - name: Limit Password Reuse - Ensure authselect changes are applied
    ansible.builtin.command:
      cmd: authselect apply-changes -b
    when:
    - result_authselect_present.stat.exists
    - (result_pam_remember_add is defined and result_pam_remember_add.changed) or
      (result_pam_remember_edit is defined and result_pam_remember_edit.changed)
  when:
  - '"pam" in ansible_facts.packages'
  - not result_pwhistory_conf_check.stat.exists
  tags:
  - CJIS-5.6.2.1.1
  - NIST-800-171-3.5.8
  - NIST-800-53-IA-5(1)(e)
  - NIST-800-53-IA-5(f)
  - PCI-DSS-Req-8.2.5
  - PCI-DSSv4-8.3.7
  - accounts_password_pam_unix_remember
  - configure_strategy
  - low_complexity
  - medium_disruption
  - medium_severity
  - no_reboot_needed
</ns5:fix>
                <ns5:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <ns5:check-export export-name="oval:ssg-var_password_pam_unix_remember:var:1" value-id="xccdf_org.ssgproject.content_value_var_password_pam_unix_remember" />
                  <ns5:check-content-ref href="ssg-gentoo-oval.xml" name="oval:ssg-accounts_password_pam_unix_remember:def:1" />
                </ns5:check>
                <ns5:check system="http://scap.nist.gov/schema/ocil/2">
                  <ns5:check-content-ref href="ssg-gentoo-ocil.xml" name="ocil:ssg-accounts_password_pam_unix_remember_ocil:questionnaire:1" />
                </ns5:check>
              </ns5:Rule>
            </ns5:Group>
            <ns5:Group id="xccdf_org.ssgproject.content_group_password_quality">
              <ns5:title>Set Password Quality Requirements</ns5:title>
              <ns5:description>The default <html:code>pam_pwquality</html:code> PAM module provides strength
checking for passwords. It performs a number of checks, such as
making sure passwords are not similar to dictionary words, are of
at least a certain length, are not the previous password reversed,
and are not simply a change of case from the previous password. It
can also require passwords to be in certain character classes. The
<html:code>pam_pwquality</html:code> module is the preferred way of configuring
password requirements.
<html:br />
        <html:br />
The man pages <html:code>pam_pwquality(8)</html:code>
provide information on the capabilities and configuration of
each.</ns5:description>
              <ns5:Group id="xccdf_org.ssgproject.content_group_password_quality_pwquality">
                <ns5:title>Set Password Quality Requirements with pam_pwquality</ns5:title>
                <ns5:description>The <html:code>pam_pwquality</html:code> PAM module can be configured to meet
requirements for a variety of policies.
<html:br />
         <html:br />
For example, to configure <html:code>pam_pwquality</html:code> to require at least one uppercase
character, lowercase character, digit, and other (special)
character, make sure that <html:code>pam_pwquality</html:code> exists in <html:code>/etc/pam.d/system-auth</html:code>:
<html:pre>password    requisite     pam_pwquality.so try_first_pass local_users_only retry=3 authtok_type=</html:pre>
If no such line exists, add one as the first line of the password section in <html:code>/etc/pam.d/system-auth</html:code>.
Next, modify the settings in <html:code>/etc/security/pwquality.conf</html:code> to match the following:
<html:pre>difok = 4
minlen = 14
dcredit = -1
ucredit = -1
lcredit = -1
ocredit = -1
maxrepeat = 3</html:pre>
The arguments can be modified to ensure compliance with
your organization's security policy. Discussion of each parameter follows.</ns5:description>
                <ns5:Value id="xccdf_org.ssgproject.content_value_var_password_pam_dcredit" type="number">
                  <ns5:title>dcredit</ns5:title>
                  <ns5:description>Minimum number of digits in password</ns5:description>
                  <ns5:value selector="0">0</ns5:value>
                  <ns5:value selector="1">-1</ns5:value>
                  <ns5:value selector="2">-2</ns5:value>
                  <ns5:value>-1</ns5:value>
                </ns5:Value>
                <ns5:Value id="xccdf_org.ssgproject.content_value_var_password_pam_lcredit" type="number">
                  <ns5:title>lcredit</ns5:title>
                  <ns5:description>Minimum number of lower case in password</ns5:description>
                  <ns5:value selector="0">0</ns5:value>
                  <ns5:value selector="1">-1</ns5:value>
                  <ns5:value selector="2">-2</ns5:value>
                  <ns5:value>-1</ns5:value>
                </ns5:Value>
                <ns5:Value id="xccdf_org.ssgproject.content_value_var_password_pam_minlen" type="number">
                  <ns5:title>minlen</ns5:title>
                  <ns5:description>Minimum number of characters in password</ns5:description>
                  <ns5:value selector="10">10</ns5:value>
                  <ns5:value selector="12">12</ns5:value>
                  <ns5:value selector="14">14</ns5:value>
                  <ns5:value selector="15">15</ns5:value>
                  <ns5:value selector="18">18</ns5:value>
                  <ns5:value selector="20">20</ns5:value>
                  <ns5:value selector="6">6</ns5:value>
                  <ns5:value selector="7">7</ns5:value>
                  <ns5:value selector="8">8</ns5:value>
                  <ns5:value>15</ns5:value>
                </ns5:Value>
                <ns5:Value id="xccdf_org.ssgproject.content_value_var_password_pam_ocredit" type="number">
                  <ns5:title>ocredit</ns5:title>
                  <ns5:description>Minimum number of other (special characters) in
password</ns5:description>
                  <ns5:value selector="0">0</ns5:value>
                  <ns5:value selector="1">-1</ns5:value>
                  <ns5:value selector="2">-2</ns5:value>
                  <ns5:value>-1</ns5:value>
                </ns5:Value>
                <ns5:Value id="xccdf_org.ssgproject.content_value_var_password_pam_ucredit" type="number">
                  <ns5:title>ucredit</ns5:title>
                  <ns5:description>Minimum number of upper case in password</ns5:description>
                  <ns5:value selector="0">0</ns5:value>
                  <ns5:value selector="1">-1</ns5:value>
                  <ns5:value selector="2">-2</ns5:value>
                  <ns5:value>-1</ns5:value>
                </ns5:Value>
                <ns5:Rule selected="false" id="xccdf_org.ssgproject.content_rule_accounts_password_pam_dcredit" severity="medium">
                  <ns5:title>Ensure PAM Enforces Password Requirements - Minimum Digit Characters</ns5:title>
                  <ns5:description>The pam_pwquality module's <html:code>dcredit</html:code> parameter controls requirements for
usage of digits in a password. When set to a negative number, any password will be required to
contain that many digits. When set to a positive number, pam_pwquality will grant +1 additional
length credit for each digit. Modify the <html:code>dcredit</html:code> setting in
<html:code>/etc/security/pwquality.conf</html:code> to require the use of a digit in passwords.</ns5:description>
                  <ns5:reference href="https://www.cisecurity.org/controls/">1</ns5:reference>
                  <ns5:reference href="https://www.cisecurity.org/controls/">12</ns5:reference>
                  <ns5:reference href="https://www.cisecurity.org/controls/">15</ns5:reference>
                  <ns5:reference href="https://www.cisecurity.org/controls/">16</ns5:reference>
                  <ns5:reference href="https://www.cisecurity.org/controls/">5</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.04</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.05</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.07</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.10</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS06.03</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS06.10</ns5:reference>
                  <ns5:reference href="https://public.cyber.mil/stigs/cci/">CCI-000194</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.2.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.5.1</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.5.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.1</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.3</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.4</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.5</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.6</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.7</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.8</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.9</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.7.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.7.4</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.1</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.10</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.3</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.4</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.5</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.7</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.8</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.9</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 2.1</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">0421</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">0422</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">0431</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">0974</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1173</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1401</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1504</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1505</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1546</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1557</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1558</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1559</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1560</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1561</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.18.1.4</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.7.1.1</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.1</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.2</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.3</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.4</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.6</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.3.1</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.4.2</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.4.3</ns5:reference>
                  <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(c)</ns5:reference>
                  <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(1)(a)</ns5:reference>
                  <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(a)</ns5:reference>
                  <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(4)</ns5:reference>
                  <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">PR.AC-1</ns5:reference>
                  <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">PR.AC-6</ns5:reference>
                  <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">PR.AC-7</ns5:reference>
                  <ns5:reference href="https://www.niap-ccevs.org/Profile/PP.cfm">FMT_SMF_EXT.1</ns5:reference>
                  <ns5:reference href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf">Req-8.2.3</ns5:reference>
                  <ns5:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os">SRG-OS-000071-GPOS-00039</ns5:reference>
                  <ns5:reference href="https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf">R31</ns5:reference>
                  <ns5:reference href="https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf">8.3.6</ns5:reference>
                  <ns5:rationale>Use of a complex password helps to increase the time and resources required
to compromise the password. Password complexity, or strength, is a measure of
the effectiveness of a password in resisting attempts at guessing and brute-force
attacks.
<html:br />
          <html:br />
Password complexity is one factor of several that determines how long it takes
to crack a password. The more complex the password, the greater the number of
possible combinations that need to be tested before the password is compromised.
Requiring digits makes password guessing attacks more difficult by ensuring a larger
search space.</ns5:rationale>
                  <ns5:platform idref="#package_pam" />
                  <ns5:fix system="urn:xccdf:fix:script:sh" id="accounts_password_pam_dcredit" complexity="low" disruption="low" reboot="false" strategy="restrict"># Remediation is applicable only in certain platforms
if rpm --quiet -q pam; then

var_password_pam_dcredit='<ns5:sub idref="xccdf_org.ssgproject.content_value_var_password_pam_dcredit" use="legacy" />'






# Strip any search characters in the key arg so that the key can be replaced without
# adding any search characters to the config file.
stripped_key=$(sed 's/[\^=\$,;+]*//g' &lt;&lt;&lt; "^dcredit")

# shellcheck disable=SC2059
printf -v formatted_output "%s = %s" "$stripped_key" "$var_password_pam_dcredit"

# If the key exists, change it. Otherwise, add it to the config_file.
# We search for the key string followed by a word boundary (matched by \&gt;),
# so if we search for 'setting', 'setting2' won't match.
if LC_ALL=C grep -q -m 1 -i -e "^dcredit\\&gt;" "/etc/security/pwquality.conf"; then
    escaped_formatted_output=$(sed -e 's|/|\\/|g' &lt;&lt;&lt; "$formatted_output")
    LC_ALL=C sed -i --follow-symlinks "s/^dcredit\\&gt;.*/$escaped_formatted_output/gi" "/etc/security/pwquality.conf"
else
    if [[ -s "/etc/security/pwquality.conf" ]] &amp;&amp; [[ -n "$(tail -c 1 -- "/etc/security/pwquality.conf" || true)" ]]; then
        LC_ALL=C sed -i --follow-symlinks '$a'\\ "/etc/security/pwquality.conf"
    fi
    printf '%s\n' "$formatted_output" &gt;&gt; "/etc/security/pwquality.conf"
fi

else
    &gt;&amp;2 echo 'Remediation is not applicable, nothing was done'
fi
</ns5:fix>
                  <ns5:fix system="urn:xccdf:fix:script:ansible" id="accounts_password_pam_dcredit" complexity="low" disruption="low" reboot="false" strategy="restrict">- name: Gather the package facts
  package_facts:
    manager: auto
  tags:
  - NIST-800-53-CM-6(a)
  - NIST-800-53-IA-5(1)(a)
  - NIST-800-53-IA-5(4)
  - NIST-800-53-IA-5(c)
  - PCI-DSS-Req-8.2.3
  - PCI-DSSv4-8.3.6
  - accounts_password_pam_dcredit
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy
- name: XCCDF Value var_password_pam_dcredit # promote to variable
  set_fact:
    var_password_pam_dcredit: !!str <ns5:sub idref="xccdf_org.ssgproject.content_value_var_password_pam_dcredit" use="legacy" />
  tags:
    - always

- name: Ensure PAM Enforces Password Requirements - Minimum Digit Characters - Ensure
    PAM variable dcredit is set accordingly
  ansible.builtin.lineinfile:
    create: true
    dest: /etc/security/pwquality.conf
    regexp: ^#?\s*dcredit
    line: dcredit = {{ var_password_pam_dcredit }}
  when: '"pam" in ansible_facts.packages'
  tags:
  - NIST-800-53-CM-6(a)
  - NIST-800-53-IA-5(1)(a)
  - NIST-800-53-IA-5(4)
  - NIST-800-53-IA-5(c)
  - PCI-DSS-Req-8.2.3
  - PCI-DSSv4-8.3.6
  - accounts_password_pam_dcredit
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy
</ns5:fix>
                  <ns5:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                    <ns5:check-export export-name="oval:ssg-var_password_pam_dcredit:var:1" value-id="xccdf_org.ssgproject.content_value_var_password_pam_dcredit" />
                    <ns5:check-content-ref href="ssg-gentoo-oval.xml" name="oval:ssg-accounts_password_pam_dcredit:def:1" />
                  </ns5:check>
                  <ns5:check system="http://scap.nist.gov/schema/ocil/2">
                    <ns5:check-content-ref href="ssg-gentoo-ocil.xml" name="ocil:ssg-accounts_password_pam_dcredit_ocil:questionnaire:1" />
                  </ns5:check>
                </ns5:Rule>
                <ns5:Rule selected="false" id="xccdf_org.ssgproject.content_rule_accounts_password_pam_lcredit" severity="medium">
                  <ns5:title>Ensure PAM Enforces Password Requirements - Minimum Lowercase Characters</ns5:title>
                  <ns5:description>The pam_pwquality module's <html:code>lcredit</html:code> parameter controls requirements for
usage of lowercase letters in a password. When set to a negative number, any password will be required to
contain that many lowercase characters. When set to a positive number, pam_pwquality will grant +1 additional
length credit for each lowercase character. Modify the <html:code>lcredit</html:code> setting in
<html:code>/etc/security/pwquality.conf</html:code> to require the use of a lowercase character in passwords.</ns5:description>
                  <ns5:reference href="https://www.cisecurity.org/controls/">1</ns5:reference>
                  <ns5:reference href="https://www.cisecurity.org/controls/">12</ns5:reference>
                  <ns5:reference href="https://www.cisecurity.org/controls/">15</ns5:reference>
                  <ns5:reference href="https://www.cisecurity.org/controls/">16</ns5:reference>
                  <ns5:reference href="https://www.cisecurity.org/controls/">5</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.04</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.05</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.07</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.10</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS06.03</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS06.10</ns5:reference>
                  <ns5:reference href="https://public.cyber.mil/stigs/cci/">CCI-000193</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.2.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.5.1</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.5.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.1</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.3</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.4</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.5</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.6</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.7</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.8</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.9</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.7.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.7.4</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.1</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.10</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.3</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.4</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.5</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.7</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.8</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.9</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 2.1</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">0421</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">0422</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">0431</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">0974</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1173</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1401</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1504</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1505</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1546</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1557</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1558</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1559</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1560</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1561</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.18.1.4</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.7.1.1</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.1</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.2</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.3</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.4</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.6</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.3.1</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.4.2</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.4.3</ns5:reference>
                  <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(c)</ns5:reference>
                  <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(1)(a)</ns5:reference>
                  <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(a)</ns5:reference>
                  <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(4)</ns5:reference>
                  <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">PR.AC-1</ns5:reference>
                  <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">PR.AC-6</ns5:reference>
                  <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">PR.AC-7</ns5:reference>
                  <ns5:reference href="https://www.niap-ccevs.org/Profile/PP.cfm">FMT_SMF_EXT.1</ns5:reference>
                  <ns5:reference href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf">Req-8.2.3</ns5:reference>
                  <ns5:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os">SRG-OS-000070-GPOS-00038</ns5:reference>
                  <ns5:reference href="https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf">R31</ns5:reference>
                  <ns5:reference href="https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf">8.3.6</ns5:reference>
                  <ns5:rationale>Use of a complex password helps to increase the time and resources required
to compromise the password. Password complexity, or strength, is a measure of
the effectiveness of a password in resisting attempts at guessing and brute-force
attacks.
<html:br />
Password complexity is one factor of several that determines how long it takes
to crack a password. The more complex the password, the greater the number of
possble combinations that need to be tested before the password is compromised.
Requiring a minimum number of lowercase characters makes password guessing attacks
more difficult by ensuring a larger search space.</ns5:rationale>
                  <ns5:platform idref="#package_pam" />
                  <ns5:fix system="urn:xccdf:fix:script:sh" id="accounts_password_pam_lcredit" complexity="low" disruption="low" reboot="false" strategy="restrict"># Remediation is applicable only in certain platforms
if rpm --quiet -q pam; then

var_password_pam_lcredit='<ns5:sub idref="xccdf_org.ssgproject.content_value_var_password_pam_lcredit" use="legacy" />'






# Strip any search characters in the key arg so that the key can be replaced without
# adding any search characters to the config file.
stripped_key=$(sed 's/[\^=\$,;+]*//g' &lt;&lt;&lt; "^lcredit")

# shellcheck disable=SC2059
printf -v formatted_output "%s = %s" "$stripped_key" "$var_password_pam_lcredit"

# If the key exists, change it. Otherwise, add it to the config_file.
# We search for the key string followed by a word boundary (matched by \&gt;),
# so if we search for 'setting', 'setting2' won't match.
if LC_ALL=C grep -q -m 1 -i -e "^lcredit\\&gt;" "/etc/security/pwquality.conf"; then
    escaped_formatted_output=$(sed -e 's|/|\\/|g' &lt;&lt;&lt; "$formatted_output")
    LC_ALL=C sed -i --follow-symlinks "s/^lcredit\\&gt;.*/$escaped_formatted_output/gi" "/etc/security/pwquality.conf"
else
    if [[ -s "/etc/security/pwquality.conf" ]] &amp;&amp; [[ -n "$(tail -c 1 -- "/etc/security/pwquality.conf" || true)" ]]; then
        LC_ALL=C sed -i --follow-symlinks '$a'\\ "/etc/security/pwquality.conf"
    fi
    printf '%s\n' "$formatted_output" &gt;&gt; "/etc/security/pwquality.conf"
fi

else
    &gt;&amp;2 echo 'Remediation is not applicable, nothing was done'
fi
</ns5:fix>
                  <ns5:fix system="urn:xccdf:fix:script:ansible" id="accounts_password_pam_lcredit" complexity="low" disruption="low" reboot="false" strategy="restrict">- name: Gather the package facts
  package_facts:
    manager: auto
  tags:
  - NIST-800-53-CM-6(a)
  - NIST-800-53-IA-5(1)(a)
  - NIST-800-53-IA-5(4)
  - NIST-800-53-IA-5(c)
  - PCI-DSS-Req-8.2.3
  - PCI-DSSv4-8.3.6
  - accounts_password_pam_lcredit
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy
- name: XCCDF Value var_password_pam_lcredit # promote to variable
  set_fact:
    var_password_pam_lcredit: !!str <ns5:sub idref="xccdf_org.ssgproject.content_value_var_password_pam_lcredit" use="legacy" />
  tags:
    - always

- name: Ensure PAM Enforces Password Requirements - Minimum Lowercase Characters -
    Ensure PAM variable lcredit is set accordingly
  ansible.builtin.lineinfile:
    create: true
    dest: /etc/security/pwquality.conf
    regexp: ^#?\s*lcredit
    line: lcredit = {{ var_password_pam_lcredit }}
  when: '"pam" in ansible_facts.packages'
  tags:
  - NIST-800-53-CM-6(a)
  - NIST-800-53-IA-5(1)(a)
  - NIST-800-53-IA-5(4)
  - NIST-800-53-IA-5(c)
  - PCI-DSS-Req-8.2.3
  - PCI-DSSv4-8.3.6
  - accounts_password_pam_lcredit
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy
</ns5:fix>
                  <ns5:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                    <ns5:check-export export-name="oval:ssg-var_password_pam_lcredit:var:1" value-id="xccdf_org.ssgproject.content_value_var_password_pam_lcredit" />
                    <ns5:check-content-ref href="ssg-gentoo-oval.xml" name="oval:ssg-accounts_password_pam_lcredit:def:1" />
                  </ns5:check>
                  <ns5:check system="http://scap.nist.gov/schema/ocil/2">
                    <ns5:check-content-ref href="ssg-gentoo-ocil.xml" name="ocil:ssg-accounts_password_pam_lcredit_ocil:questionnaire:1" />
                  </ns5:check>
                </ns5:Rule>
                <ns5:Rule selected="false" id="xccdf_org.ssgproject.content_rule_accounts_password_pam_minlen" severity="medium">
                  <ns5:title>Ensure PAM Enforces Password Requirements - Minimum Length</ns5:title>
                  <ns5:description>The pam_pwquality module's <html:code>minlen</html:code> parameter controls requirements for
minimum characters required in a password. Add <html:code>minlen=<ns5:sub idref="xccdf_org.ssgproject.content_value_var_password_pam_minlen" use="legacy" />
          </html:code>
after pam_pwquality to set minimum password length requirements.</ns5:description>
                  <ns5:reference href="https://www.cisecurity.org/controls/">1</ns5:reference>
                  <ns5:reference href="https://www.cisecurity.org/controls/">12</ns5:reference>
                  <ns5:reference href="https://www.cisecurity.org/controls/">15</ns5:reference>
                  <ns5:reference href="https://www.cisecurity.org/controls/">16</ns5:reference>
                  <ns5:reference href="https://www.cisecurity.org/controls/">5</ns5:reference>
                  <ns5:reference href="https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf">5.6.2.1.1</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.04</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.05</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.07</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.10</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS06.03</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS06.10</ns5:reference>
                  <ns5:reference href="https://public.cyber.mil/stigs/cci/">CCI-000205</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.2.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.5.1</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.5.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.1</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.3</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.4</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.5</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.6</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.7</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.8</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.9</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.7.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.7.4</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.1</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.10</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.3</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.4</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.5</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.7</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.8</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.9</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 2.1</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">0421</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">0422</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">0431</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">0974</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1173</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1401</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1504</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1505</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1546</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1557</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1558</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1559</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1560</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1561</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.18.1.4</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.7.1.1</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.1</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.2</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.3</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.4</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.6</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.3.1</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.4.2</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.4.3</ns5:reference>
                  <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(c)</ns5:reference>
                  <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(1)(a)</ns5:reference>
                  <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(a)</ns5:reference>
                  <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(4)</ns5:reference>
                  <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">PR.AC-1</ns5:reference>
                  <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">PR.AC-6</ns5:reference>
                  <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">PR.AC-7</ns5:reference>
                  <ns5:reference href="https://www.niap-ccevs.org/Profile/PP.cfm">FMT_SMF_EXT.1</ns5:reference>
                  <ns5:reference href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf">Req-8.2.3</ns5:reference>
                  <ns5:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os">SRG-OS-000078-GPOS-00046</ns5:reference>
                  <ns5:reference href="https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf">R31</ns5:reference>
                  <ns5:reference href="https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf">R68</ns5:reference>
                  <ns5:reference href="https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf">8.3.6</ns5:reference>
                  <ns5:rationale>The shorter the password, the lower the number of possible combinations
that need to be tested before the password is compromised.
<html:br />
Password complexity, or strength, is a measure of the effectiveness of a
password in resisting attempts at guessing and brute-force attacks.
Password length is one factor of several that helps to determine strength
and how long it takes to crack a password. Use of more characters in a password
helps to exponentially increase the time and/or resources required to
compromise the password.</ns5:rationale>
                  <ns5:platform idref="#package_pam" />
                  <ns5:fix system="urn:xccdf:fix:script:sh" id="accounts_password_pam_minlen" complexity="low" disruption="low" reboot="false" strategy="restrict"># Remediation is applicable only in certain platforms
if rpm --quiet -q pam; then

var_password_pam_minlen='<ns5:sub idref="xccdf_org.ssgproject.content_value_var_password_pam_minlen" use="legacy" />'






# Strip any search characters in the key arg so that the key can be replaced without
# adding any search characters to the config file.
stripped_key=$(sed 's/[\^=\$,;+]*//g' &lt;&lt;&lt; "^minlen")

# shellcheck disable=SC2059
printf -v formatted_output "%s = %s" "$stripped_key" "$var_password_pam_minlen"

# If the key exists, change it. Otherwise, add it to the config_file.
# We search for the key string followed by a word boundary (matched by \&gt;),
# so if we search for 'setting', 'setting2' won't match.
if LC_ALL=C grep -q -m 1 -i -e "^minlen\\&gt;" "/etc/security/pwquality.conf"; then
    escaped_formatted_output=$(sed -e 's|/|\\/|g' &lt;&lt;&lt; "$formatted_output")
    LC_ALL=C sed -i --follow-symlinks "s/^minlen\\&gt;.*/$escaped_formatted_output/gi" "/etc/security/pwquality.conf"
else
    if [[ -s "/etc/security/pwquality.conf" ]] &amp;&amp; [[ -n "$(tail -c 1 -- "/etc/security/pwquality.conf" || true)" ]]; then
        LC_ALL=C sed -i --follow-symlinks '$a'\\ "/etc/security/pwquality.conf"
    fi
    printf '%s\n' "$formatted_output" &gt;&gt; "/etc/security/pwquality.conf"
fi

else
    &gt;&amp;2 echo 'Remediation is not applicable, nothing was done'
fi
</ns5:fix>
                  <ns5:fix system="urn:xccdf:fix:script:ansible" id="accounts_password_pam_minlen" complexity="low" disruption="low" reboot="false" strategy="restrict">- name: Gather the package facts
  package_facts:
    manager: auto
  tags:
  - CJIS-5.6.2.1.1
  - NIST-800-53-CM-6(a)
  - NIST-800-53-IA-5(1)(a)
  - NIST-800-53-IA-5(4)
  - NIST-800-53-IA-5(c)
  - PCI-DSS-Req-8.2.3
  - PCI-DSSv4-8.3.6
  - accounts_password_pam_minlen
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy
- name: XCCDF Value var_password_pam_minlen # promote to variable
  set_fact:
    var_password_pam_minlen: !!str <ns5:sub idref="xccdf_org.ssgproject.content_value_var_password_pam_minlen" use="legacy" />
  tags:
    - always

- name: Ensure PAM Enforces Password Requirements - Minimum Length - Ensure PAM variable
    minlen is set accordingly
  ansible.builtin.lineinfile:
    create: true
    dest: /etc/security/pwquality.conf
    regexp: ^#?\s*minlen
    line: minlen = {{ var_password_pam_minlen }}
  when: '"pam" in ansible_facts.packages'
  tags:
  - CJIS-5.6.2.1.1
  - NIST-800-53-CM-6(a)
  - NIST-800-53-IA-5(1)(a)
  - NIST-800-53-IA-5(4)
  - NIST-800-53-IA-5(c)
  - PCI-DSS-Req-8.2.3
  - PCI-DSSv4-8.3.6
  - accounts_password_pam_minlen
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy
</ns5:fix>
                  <ns5:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                    <ns5:check-export export-name="oval:ssg-var_password_pam_minlen:var:1" value-id="xccdf_org.ssgproject.content_value_var_password_pam_minlen" />
                    <ns5:check-content-ref href="ssg-gentoo-oval.xml" name="oval:ssg-accounts_password_pam_minlen:def:1" />
                  </ns5:check>
                  <ns5:check system="http://scap.nist.gov/schema/ocil/2">
                    <ns5:check-content-ref href="ssg-gentoo-ocil.xml" name="ocil:ssg-accounts_password_pam_minlen_ocil:questionnaire:1" />
                  </ns5:check>
                </ns5:Rule>
                <ns5:Rule selected="false" id="xccdf_org.ssgproject.content_rule_accounts_password_pam_ocredit" severity="medium">
                  <ns5:title>Ensure PAM Enforces Password Requirements - Minimum Special Characters</ns5:title>
                  <ns5:description>The pam_pwquality module's <html:code>ocredit=</html:code> parameter controls requirements for
usage of special (or "other") characters in a password. When set to a negative number,
any password will be required to contain that many special characters.
When set to a positive number, pam_pwquality will grant +1
additional length credit for each special character. Modify the <html:code>ocredit</html:code> setting
in <html:code>/etc/security/pwquality.conf</html:code> to equal <ns5:sub idref="xccdf_org.ssgproject.content_value_var_password_pam_ocredit" use="legacy" />
to require use of a special character in passwords.</ns5:description>
                  <ns5:reference href="https://www.cisecurity.org/controls/">1</ns5:reference>
                  <ns5:reference href="https://www.cisecurity.org/controls/">12</ns5:reference>
                  <ns5:reference href="https://www.cisecurity.org/controls/">15</ns5:reference>
                  <ns5:reference href="https://www.cisecurity.org/controls/">16</ns5:reference>
                  <ns5:reference href="https://www.cisecurity.org/controls/">5</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.04</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.05</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.07</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.10</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS06.03</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS06.10</ns5:reference>
                  <ns5:reference href="https://public.cyber.mil/stigs/cci/">CCI-001619</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.2.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.5.1</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.5.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.1</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.3</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.4</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.5</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.6</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.7</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.8</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.9</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.7.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.7.4</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.1</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.10</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.3</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.4</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.5</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.7</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.8</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.9</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 2.1</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">0421</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">0422</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">0431</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">0974</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1173</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1401</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1504</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1505</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1546</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1557</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1558</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1559</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1560</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1561</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.18.1.4</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.7.1.1</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.1</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.2</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.3</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.4</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.6</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.3.1</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.4.2</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.4.3</ns5:reference>
                  <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(c)</ns5:reference>
                  <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(1)(a)</ns5:reference>
                  <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(a)</ns5:reference>
                  <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(4)</ns5:reference>
                  <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">PR.AC-1</ns5:reference>
                  <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">PR.AC-6</ns5:reference>
                  <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">PR.AC-7</ns5:reference>
                  <ns5:reference href="https://www.niap-ccevs.org/Profile/PP.cfm">FMT_SMF_EXT.1</ns5:reference>
                  <ns5:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os">SRG-OS-000266-GPOS-00101</ns5:reference>
                  <ns5:reference href="https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf">R31</ns5:reference>
                  <ns5:rationale>Use of a complex password helps to increase the time and resources required
to compromise the password. Password complexity, or strength, is a measure of
the effectiveness of a password in resisting attempts at guessing and brute-force
attacks.
<html:br />
          <html:br />
Password complexity is one factor of several that determines how long it takes
to crack a password. The more complex the password, the greater the number of
possible combinations that need to be tested before the password is compromised.
Requiring a minimum number of special characters makes password guessing attacks
more difficult by ensuring a larger search space.</ns5:rationale>
                  <ns5:platform idref="#package_pam" />
                  <ns5:fix system="urn:xccdf:fix:script:sh" id="accounts_password_pam_ocredit" complexity="low" disruption="low" reboot="false" strategy="restrict"># Remediation is applicable only in certain platforms
if rpm --quiet -q pam; then

var_password_pam_ocredit='<ns5:sub idref="xccdf_org.ssgproject.content_value_var_password_pam_ocredit" use="legacy" />'






# Strip any search characters in the key arg so that the key can be replaced without
# adding any search characters to the config file.
stripped_key=$(sed 's/[\^=\$,;+]*//g' &lt;&lt;&lt; "^ocredit")

# shellcheck disable=SC2059
printf -v formatted_output "%s = %s" "$stripped_key" "$var_password_pam_ocredit"

# If the key exists, change it. Otherwise, add it to the config_file.
# We search for the key string followed by a word boundary (matched by \&gt;),
# so if we search for 'setting', 'setting2' won't match.
if LC_ALL=C grep -q -m 1 -i -e "^ocredit\\&gt;" "/etc/security/pwquality.conf"; then
    escaped_formatted_output=$(sed -e 's|/|\\/|g' &lt;&lt;&lt; "$formatted_output")
    LC_ALL=C sed -i --follow-symlinks "s/^ocredit\\&gt;.*/$escaped_formatted_output/gi" "/etc/security/pwquality.conf"
else
    if [[ -s "/etc/security/pwquality.conf" ]] &amp;&amp; [[ -n "$(tail -c 1 -- "/etc/security/pwquality.conf" || true)" ]]; then
        LC_ALL=C sed -i --follow-symlinks '$a'\\ "/etc/security/pwquality.conf"
    fi
    printf '%s\n' "$formatted_output" &gt;&gt; "/etc/security/pwquality.conf"
fi

else
    &gt;&amp;2 echo 'Remediation is not applicable, nothing was done'
fi
</ns5:fix>
                  <ns5:fix system="urn:xccdf:fix:script:ansible" id="accounts_password_pam_ocredit" complexity="low" disruption="low" reboot="false" strategy="restrict">- name: Gather the package facts
  package_facts:
    manager: auto
  tags:
  - NIST-800-53-CM-6(a)
  - NIST-800-53-IA-5(1)(a)
  - NIST-800-53-IA-5(4)
  - NIST-800-53-IA-5(c)
  - accounts_password_pam_ocredit
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy
- name: XCCDF Value var_password_pam_ocredit # promote to variable
  set_fact:
    var_password_pam_ocredit: !!str <ns5:sub idref="xccdf_org.ssgproject.content_value_var_password_pam_ocredit" use="legacy" />
  tags:
    - always

- name: Ensure PAM Enforces Password Requirements - Minimum Special Characters - Ensure
    PAM variable ocredit is set accordingly
  ansible.builtin.lineinfile:
    create: true
    dest: /etc/security/pwquality.conf
    regexp: ^#?\s*ocredit
    line: ocredit = {{ var_password_pam_ocredit }}
  when: '"pam" in ansible_facts.packages'
  tags:
  - NIST-800-53-CM-6(a)
  - NIST-800-53-IA-5(1)(a)
  - NIST-800-53-IA-5(4)
  - NIST-800-53-IA-5(c)
  - accounts_password_pam_ocredit
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy
</ns5:fix>
                  <ns5:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                    <ns5:check-export export-name="oval:ssg-var_password_pam_ocredit:var:1" value-id="xccdf_org.ssgproject.content_value_var_password_pam_ocredit" />
                    <ns5:check-content-ref href="ssg-gentoo-oval.xml" name="oval:ssg-accounts_password_pam_ocredit:def:1" />
                  </ns5:check>
                  <ns5:check system="http://scap.nist.gov/schema/ocil/2">
                    <ns5:check-content-ref href="ssg-gentoo-ocil.xml" name="ocil:ssg-accounts_password_pam_ocredit_ocil:questionnaire:1" />
                  </ns5:check>
                </ns5:Rule>
                <ns5:Rule selected="false" id="xccdf_org.ssgproject.content_rule_accounts_password_pam_ucredit" severity="medium">
                  <ns5:title>Ensure PAM Enforces Password Requirements - Minimum Uppercase Characters</ns5:title>
                  <ns5:description>The pam_pwquality module's <html:code>ucredit=</html:code> parameter controls requirements for
usage of uppercase letters in a password. When set to a negative number, any password will be required to
contain that many uppercase characters. When set to a positive number, pam_pwquality will grant +1 additional
length credit for each uppercase character. Modify the <html:code>ucredit</html:code> setting in
<html:code>/etc/security/pwquality.conf</html:code> to require the use of an uppercase character in passwords.</ns5:description>
                  <ns5:reference href="https://www.cisecurity.org/controls/">1</ns5:reference>
                  <ns5:reference href="https://www.cisecurity.org/controls/">12</ns5:reference>
                  <ns5:reference href="https://www.cisecurity.org/controls/">15</ns5:reference>
                  <ns5:reference href="https://www.cisecurity.org/controls/">16</ns5:reference>
                  <ns5:reference href="https://www.cisecurity.org/controls/">5</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.04</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.05</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.07</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.10</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS06.03</ns5:reference>
                  <ns5:reference href="https://www.isaca.org/resources/cobit">DSS06.10</ns5:reference>
                  <ns5:reference href="https://public.cyber.mil/stigs/cci/">CCI-000192</ns5:reference>
                  <ns5:reference href="https://public.cyber.mil/stigs/cci/">CCI-000193</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.2.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.5.1</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.5.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.1</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.3</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.4</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.5</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.6</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.7</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.8</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.9</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.7.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.7.4</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.1</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.10</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.2</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.3</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.4</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.5</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.7</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.8</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.9</ns5:reference>
                  <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 2.1</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">0421</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">0422</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">0431</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">0974</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1173</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1401</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1504</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1505</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1546</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1557</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1558</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1559</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1560</ns5:reference>
                  <ns5:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">1561</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.18.1.4</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.7.1.1</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.1</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.2</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.3</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.4</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.6</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.3.1</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.4.2</ns5:reference>
                  <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.4.3</ns5:reference>
                  <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(c)</ns5:reference>
                  <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(1)(a)</ns5:reference>
                  <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(a)</ns5:reference>
                  <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">IA-5(4)</ns5:reference>
                  <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">PR.AC-1</ns5:reference>
                  <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">PR.AC-6</ns5:reference>
                  <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">PR.AC-7</ns5:reference>
                  <ns5:reference href="https://www.niap-ccevs.org/Profile/PP.cfm">FMT_SMF_EXT.1</ns5:reference>
                  <ns5:reference href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf">Req-8.2.3</ns5:reference>
                  <ns5:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os">SRG-OS-000069-GPOS-00037</ns5:reference>
                  <ns5:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os">SRG-OS-000070-GPOS-00038</ns5:reference>
                  <ns5:reference href="https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf">R31</ns5:reference>
                  <ns5:rationale>Use of a complex password helps to increase the time and resources required to compromise the password.
Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts
at guessing and brute-force attacks.
<html:br />
          <html:br />
Password complexity is one factor of several that determines how long it takes to crack a password. The more
complex the password, the greater the number of possible combinations that need to be tested before
the password is compromised.</ns5:rationale>
                  <ns5:platform idref="#package_pam" />
                  <ns5:fix system="urn:xccdf:fix:script:sh" id="accounts_password_pam_ucredit" complexity="low" disruption="low" reboot="false" strategy="restrict"># Remediation is applicable only in certain platforms
if rpm --quiet -q pam; then

var_password_pam_ucredit='<ns5:sub idref="xccdf_org.ssgproject.content_value_var_password_pam_ucredit" use="legacy" />'






# Strip any search characters in the key arg so that the key can be replaced without
# adding any search characters to the config file.
stripped_key=$(sed 's/[\^=\$,;+]*//g' &lt;&lt;&lt; "^ucredit")

# shellcheck disable=SC2059
printf -v formatted_output "%s = %s" "$stripped_key" "$var_password_pam_ucredit"

# If the key exists, change it. Otherwise, add it to the config_file.
# We search for the key string followed by a word boundary (matched by \&gt;),
# so if we search for 'setting', 'setting2' won't match.
if LC_ALL=C grep -q -m 1 -i -e "^ucredit\\&gt;" "/etc/security/pwquality.conf"; then
    escaped_formatted_output=$(sed -e 's|/|\\/|g' &lt;&lt;&lt; "$formatted_output")
    LC_ALL=C sed -i --follow-symlinks "s/^ucredit\\&gt;.*/$escaped_formatted_output/gi" "/etc/security/pwquality.conf"
else
    if [[ -s "/etc/security/pwquality.conf" ]] &amp;&amp; [[ -n "$(tail -c 1 -- "/etc/security/pwquality.conf" || true)" ]]; then
        LC_ALL=C sed -i --follow-symlinks '$a'\\ "/etc/security/pwquality.conf"
    fi
    printf '%s\n' "$formatted_output" &gt;&gt; "/etc/security/pwquality.conf"
fi

else
    &gt;&amp;2 echo 'Remediation is not applicable, nothing was done'
fi
</ns5:fix>
                  <ns5:fix system="urn:xccdf:fix:script:ansible" id="accounts_password_pam_ucredit" complexity="low" disruption="low" reboot="false" strategy="restrict">- name: Gather the package facts
  package_facts:
    manager: auto
  tags:
  - NIST-800-53-CM-6(a)
  - NIST-800-53-IA-5(1)(a)
  - NIST-800-53-IA-5(4)
  - NIST-800-53-IA-5(c)
  - PCI-DSS-Req-8.2.3
  - accounts_password_pam_ucredit
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy
- name: XCCDF Value var_password_pam_ucredit # promote to variable
  set_fact:
    var_password_pam_ucredit: !!str <ns5:sub idref="xccdf_org.ssgproject.content_value_var_password_pam_ucredit" use="legacy" />
  tags:
    - always

- name: Ensure PAM Enforces Password Requirements - Minimum Uppercase Characters -
    Ensure PAM variable ucredit is set accordingly
  ansible.builtin.lineinfile:
    create: true
    dest: /etc/security/pwquality.conf
    regexp: ^#?\s*ucredit
    line: ucredit = {{ var_password_pam_ucredit }}
  when: '"pam" in ansible_facts.packages'
  tags:
  - NIST-800-53-CM-6(a)
  - NIST-800-53-IA-5(1)(a)
  - NIST-800-53-IA-5(4)
  - NIST-800-53-IA-5(c)
  - PCI-DSS-Req-8.2.3
  - accounts_password_pam_ucredit
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy
</ns5:fix>
                  <ns5:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                    <ns5:check-export export-name="oval:ssg-var_password_pam_ucredit:var:1" value-id="xccdf_org.ssgproject.content_value_var_password_pam_ucredit" />
                    <ns5:check-content-ref href="ssg-gentoo-oval.xml" name="oval:ssg-accounts_password_pam_ucredit:def:1" />
                  </ns5:check>
                  <ns5:check system="http://scap.nist.gov/schema/ocil/2">
                    <ns5:check-content-ref href="ssg-gentoo-ocil.xml" name="ocil:ssg-accounts_password_pam_ucredit_ocil:questionnaire:1" />
                  </ns5:check>
                </ns5:Rule>
              </ns5:Group>
            </ns5:Group>
          </ns5:Group>
          <ns5:Group id="xccdf_org.ssgproject.content_group_accounts-session">
            <ns5:title>Secure Session Configuration Files for Login Accounts</ns5:title>
            <ns5:description>When a user logs into a Unix account, the system
configures the user's session by reading a number of files. Many of
these files are located in the user's home directory, and may have
weak permissions as a result of user error or misconfiguration. If
an attacker can modify or even read certain types of account
configuration information, they can often gain full access to the
affected user's account. Therefore, it is important to test and
correct configuration file permissions for interactive accounts,
particularly those of privileged users such as root or system
administrators.</ns5:description>
            <ns5:Value id="xccdf_org.ssgproject.content_value_var_accounts_tmout" type="number">
              <ns5:title>Account Inactivity Timeout (seconds)</ns5:title>
              <ns5:description>In an interactive shell, the value is interpreted as the
number of seconds to wait for input after issuing the primary prompt.
Bash terminates after waiting for that number of seconds if input does
not arrive.</ns5:description>
              <ns5:value selector="30_min">1800</ns5:value>
              <ns5:value selector="10_min">600</ns5:value>
              <ns5:value selector="15_min">900</ns5:value>
              <ns5:value selector="5_min">300</ns5:value>
              <ns5:value>600</ns5:value>
            </ns5:Value>
            <ns5:Rule selected="false" id="xccdf_org.ssgproject.content_rule_accounts_tmout" severity="medium">
              <ns5:title>Set Interactive Session Timeout</ns5:title>
              <ns5:description>Setting the <html:code>TMOUT</html:code> option in <html:code>/etc/profile</html:code> ensures that
all user sessions will terminate based on inactivity.
The value of TMOUT should be exported and read only.
The <html:code>TMOUT</html:code>

setting in a file loaded by <html:code>/etc/profile</html:code>, e.g.
<html:code>/etc/profile.d/tmout.sh</html:code> should read as follows:
<html:pre>typeset -xr TMOUT=<ns5:sub idref="xccdf_org.ssgproject.content_value_var_accounts_tmout" use="legacy" />
        </html:pre>
or
<html:pre>declare -xr TMOUT=<ns5:sub idref="xccdf_org.ssgproject.content_value_var_accounts_tmout" use="legacy" />
        </html:pre>
Using the <html:code>typeset</html:code> keyword is preferred for wider compatibility with ksh and other shells.</ns5:description>
              <ns5:reference href="https://www.cisecurity.org/controls/">1</ns5:reference>
              <ns5:reference href="https://www.cisecurity.org/controls/">12</ns5:reference>
              <ns5:reference href="https://www.cisecurity.org/controls/">15</ns5:reference>
              <ns5:reference href="https://www.cisecurity.org/controls/">16</ns5:reference>
              <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.04</ns5:reference>
              <ns5:reference href="https://www.isaca.org/resources/cobit">DSS05.10</ns5:reference>
              <ns5:reference href="https://www.isaca.org/resources/cobit">DSS06.10</ns5:reference>
              <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf">3.1.11</ns5:reference>
              <ns5:reference href="https://public.cyber.mil/stigs/cci/">CCI-000057</ns5:reference>
              <ns5:reference href="https://public.cyber.mil/stigs/cci/">CCI-001133</ns5:reference>
              <ns5:reference href="https://public.cyber.mil/stigs/cci/">CCI-002361</ns5:reference>
              <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.1</ns5:reference>
              <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.2</ns5:reference>
              <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.3</ns5:reference>
              <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.4</ns5:reference>
              <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.5</ns5:reference>
              <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.6</ns5:reference>
              <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.7</ns5:reference>
              <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.8</ns5:reference>
              <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.3.6.9</ns5:reference>
              <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.1</ns5:reference>
              <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.10</ns5:reference>
              <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.2</ns5:reference>
              <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.5</ns5:reference>
              <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.7</ns5:reference>
              <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.8</ns5:reference>
              <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 1.9</ns5:reference>
              <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.18.1.4</ns5:reference>
              <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.1</ns5:reference>
              <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.2.4</ns5:reference>
              <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.3.1</ns5:reference>
              <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.4.2</ns5:reference>
              <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.9.4.3</ns5:reference>
              <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-6 R2.2.3</ns5:reference>
              <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R5.1</ns5:reference>
              <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R5.2</ns5:reference>
              <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R5.3.1</ns5:reference>
              <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R5.3.2</ns5:reference>
              <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R5.3.3</ns5:reference>
              <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-12</ns5:reference>
              <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SC-10</ns5:reference>
              <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-2(5)</ns5:reference>
              <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(a)</ns5:reference>
              <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">PR.AC-7</ns5:reference>
              <ns5:reference href="https://www.niap-ccevs.org/Profile/PP.cfm">FMT_MOF_EXT.1</ns5:reference>
              <ns5:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os">SRG-OS-000163-GPOS-00072</ns5:reference>
              <ns5:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os">SRG-OS-000029-GPOS-00010</ns5:reference>
              <ns5:reference href="https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf">R32</ns5:reference>
              <ns5:reference href="https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf">8.6.1</ns5:reference>
              <ns5:rationale>Terminating an idle session within a short time period reduces
the window of opportunity for unauthorized personnel to take control of a
management session enabled on the console or console port that has been
left unattended.</ns5:rationale>
              <ns5:platform idref="#machine" />
              <ns5:fix system="urn:xccdf:fix:script:sh" id="accounts_tmout"># Remediation is applicable only in certain platforms
if [ ! -f /.dockerenv ] &amp;&amp; [ ! -f /run/.containerenv ]; then

var_accounts_tmout='<ns5:sub idref="xccdf_org.ssgproject.content_value_var_accounts_tmout" use="legacy" />'


# if 0, no occurence of tmout found, if 1, occurence found
tmout_found=0


for f in /etc/profile /etc/profile.d/*.sh; do

    if grep --silent '^[^#].*TMOUT' $f; then
        sed -i -E "s/^(.*)TMOUT\s*=\s*(\w|\$)*(.*)$/typeset -xr TMOUT=$var_accounts_tmout\3/g" $f
        tmout_found=1
    fi
done

if [ $tmout_found -eq 0 ]; then
        echo -e "\n# Set TMOUT to $var_accounts_tmout per security requirements" &gt;&gt; /etc/profile.d/tmout.sh
        echo "typeset -xr TMOUT=$var_accounts_tmout" &gt;&gt; /etc/profile.d/tmout.sh
fi

else
    &gt;&amp;2 echo 'Remediation is not applicable, nothing was done'
fi
</ns5:fix>
              <ns5:fix system="urn:xccdf:fix:script:ansible" id="accounts_tmout" complexity="low" disruption="low" reboot="false" strategy="restrict">- name: XCCDF Value var_accounts_tmout # promote to variable
  set_fact:
    var_accounts_tmout: !!str <ns5:sub idref="xccdf_org.ssgproject.content_value_var_accounts_tmout" use="legacy" />
  tags:
    - always

- name: Correct any occurrence of TMOUT in /etc/profile
  replace:
    path: /etc/profile
    regexp: ^[^#].*TMOUT=.*
    replace: typeset -xr TMOUT={{ var_accounts_tmout }}
  register: profile_replaced
  when: ansible_virtualization_type not in ["docker", "lxc", "openvz", "podman", "container"]
  tags:
  - NIST-800-171-3.1.11
  - NIST-800-53-AC-12
  - NIST-800-53-AC-2(5)
  - NIST-800-53-CM-6(a)
  - NIST-800-53-SC-10
  - PCI-DSSv4-8.6.1
  - accounts_tmout
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy

- name: Set Interactive Session Timeout
  lineinfile:
    path: /etc/profile.d/tmout.sh
    create: true
    regexp: TMOUT=
    line: typeset -xr TMOUT={{ var_accounts_tmout }}
    state: present
  when: ansible_virtualization_type not in ["docker", "lxc", "openvz", "podman", "container"]
  tags:
  - NIST-800-171-3.1.11
  - NIST-800-53-AC-12
  - NIST-800-53-AC-2(5)
  - NIST-800-53-CM-6(a)
  - NIST-800-53-SC-10
  - PCI-DSSv4-8.6.1
  - accounts_tmout
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy
</ns5:fix>
              <ns5:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                <ns5:check-export export-name="oval:ssg-var_accounts_tmout:var:1" value-id="xccdf_org.ssgproject.content_value_var_accounts_tmout" />
                <ns5:check-content-ref href="ssg-gentoo-oval.xml" name="oval:ssg-accounts_tmout:def:1" />
              </ns5:check>
              <ns5:check system="http://scap.nist.gov/schema/ocil/2">
                <ns5:check-content-ref href="ssg-gentoo-ocil.xml" name="ocil:ssg-accounts_tmout_ocil:questionnaire:1" />
              </ns5:check>
            </ns5:Rule>
            <ns5:Group id="xccdf_org.ssgproject.content_group_user_umask">
              <ns5:title>Ensure that Users Have Sensible Umask Values</ns5:title>
              <ns5:description>The umask setting controls the default permissions
for the creation of new files.
With a default <html:code>umask</html:code> setting of 077, files and directories
created by users will not be readable by any other user on the
system. Users who wish to make specific files group- or
world-readable can accomplish this by using the chmod command.
Additionally, users can make all their files readable to their
group by default by setting a <html:code>umask</html:code> of 027 in their shell
configuration files. If default per-user groups exist (that is, if
every user has a default group whose name is the same as that
user's username and whose only member is the user), then it may
even be safe for users to select a <html:code>umask</html:code> of 007, making it very
easy to intentionally share files with groups of which the user is
a member.
<html:br />
        <html:br />
       </ns5:description>
              <ns5:Value id="xccdf_org.ssgproject.content_value_var_accounts_user_umask" type="string">
                <ns5:title>Sensible umask</ns5:title>
                <ns5:description>Enter default user umask</ns5:description>
                <ns5:value selector="007">007</ns5:value>
                <ns5:value selector="022">022</ns5:value>
                <ns5:value selector="027">027</ns5:value>
                <ns5:value selector="077">077</ns5:value>
                <ns5:value>027</ns5:value>
              </ns5:Value>
              <ns5:Rule selected="false" id="xccdf_org.ssgproject.content_rule_accounts_umask_etc_bashrc" severity="medium">
                <ns5:title>Ensure the Default Bash Umask is Set Correctly</ns5:title>
                <ns5:description>To ensure the default umask for users of the Bash shell is set properly,
add or correct the <html:code>umask</html:code> setting in <html:code>/etc/bash/bashrc</html:code> to read
as follows:
<html:pre>umask <ns5:sub idref="xccdf_org.ssgproject.content_value_var_accounts_user_umask" use="legacy" />
         </html:pre>
        </ns5:description>
                <ns5:reference href="https://www.cisecurity.org/controls/">18</ns5:reference>
                <ns5:reference href="https://www.isaca.org/resources/cobit">APO13.01</ns5:reference>
                <ns5:reference href="https://www.isaca.org/resources/cobit">BAI03.01</ns5:reference>
                <ns5:reference href="https://www.isaca.org/resources/cobit">BAI03.02</ns5:reference>
                <ns5:reference href="https://www.isaca.org/resources/cobit">BAI03.03</ns5:reference>
                <ns5:reference href="https://public.cyber.mil/stigs/cci/">CCI-000366</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.4.3.3</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.14.1.1</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.14.2.1</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.14.2.5</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.6.1.5</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R5.1.1</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R5.3</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-6 R2.3</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R2.1</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R2.2</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R2.3</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R5.1</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R5.1.1</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R5.1.2</ns5:reference>
                <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-6(1)</ns5:reference>
                <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(a)</ns5:reference>
                <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">PR.IP-2</ns5:reference>
                <ns5:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os">SRG-OS-000480-GPOS-00228</ns5:reference>
                <ns5:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os">SRG-OS-000480-GPOS-00227</ns5:reference>
                <ns5:reference href="https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf">R36</ns5:reference>
                <ns5:rationale>The umask value influences the permissions assigned to files when they are created.
A misconfigured umask value could result in files with excessive permissions that can be read or
written to by unauthorized users.</ns5:rationale>
                <ns5:platform idref="#package_bash" />
                <ns5:fix system="urn:xccdf:fix:script:sh" id="accounts_umask_etc_bashrc"># Remediation is applicable only in certain platforms
if rpm --quiet -q bash; then

var_accounts_user_umask='<ns5:sub idref="xccdf_org.ssgproject.content_value_var_accounts_user_umask" use="legacy" />'






grep -q "^[^#]*\bumask" /etc/bash/bashrc &amp;&amp; \
  sed -i -E -e "s/^([^#]*\bumask).*/\1 $var_accounts_user_umask/g" /etc/bash/bashrc
if ! [ $? -eq 0 ]; then
    echo "umask $var_accounts_user_umask" &gt;&gt; /etc/bash/bashrc
fi

else
    &gt;&amp;2 echo 'Remediation is not applicable, nothing was done'
fi
</ns5:fix>
                <ns5:fix system="urn:xccdf:fix:script:ansible" id="accounts_umask_etc_bashrc" complexity="low" disruption="low" reboot="false" strategy="restrict">- name: Gather the package facts
  package_facts:
    manager: auto
  tags:
  - NIST-800-53-AC-6(1)
  - NIST-800-53-CM-6(a)
  - accounts_umask_etc_bashrc
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy
- name: XCCDF Value var_accounts_user_umask # promote to variable
  set_fact:
    var_accounts_user_umask: !!str <ns5:sub idref="xccdf_org.ssgproject.content_value_var_accounts_user_umask" use="legacy" />
  tags:
    - always

- name: Check if umask in /etc/bash/bashrc is already set
  ansible.builtin.lineinfile:
    path: /etc/bash/bashrc
    regexp: ^[^#]*\bumask\s+\d+$
    state: absent
  check_mode: true
  changed_when: false
  register: umask_replace
  when: '"bash" in ansible_facts.packages'
  tags:
  - NIST-800-53-AC-6(1)
  - NIST-800-53-CM-6(a)
  - accounts_umask_etc_bashrc
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy

- name: Replace user umask in /etc/bash/bashrc
  ansible.builtin.replace:
    path: /etc/bash/bashrc
    regexp: ^([^#]*\b)umask\s+\d+$
    replace: \g&lt;1&gt;umask {{ var_accounts_user_umask }}
  when:
  - '"bash" in ansible_facts.packages'
  - umask_replace.found &gt; 0
  tags:
  - NIST-800-53-AC-6(1)
  - NIST-800-53-CM-6(a)
  - accounts_umask_etc_bashrc
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy

- name: Ensure the Default umask is Appended Correctly
  ansible.builtin.lineinfile:
    create: true
    path: /etc/bash/bashrc
    line: umask {{ var_accounts_user_umask }}
  when:
  - '"bash" in ansible_facts.packages'
  - umask_replace.found == 0
  tags:
  - NIST-800-53-AC-6(1)
  - NIST-800-53-CM-6(a)
  - accounts_umask_etc_bashrc
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy
</ns5:fix>
                <ns5:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <ns5:check-export export-name="oval:ssg-var_accounts_user_umask:var:1" value-id="xccdf_org.ssgproject.content_value_var_accounts_user_umask" />
                  <ns5:check-content-ref href="ssg-gentoo-oval.xml" name="oval:ssg-accounts_umask_etc_bashrc:def:1" />
                </ns5:check>
                <ns5:check system="http://scap.nist.gov/schema/ocil/2">
                  <ns5:check-content-ref href="ssg-gentoo-ocil.xml" name="ocil:ssg-accounts_umask_etc_bashrc_ocil:questionnaire:1" />
                </ns5:check>
              </ns5:Rule>
              <ns5:Rule selected="false" id="xccdf_org.ssgproject.content_rule_accounts_umask_etc_login_defs" severity="medium">
                <ns5:title>Ensure the Default Umask is Set Correctly in login.defs</ns5:title>
                <ns5:description>To ensure the default umask controlled by <html:code>/etc/login.defs</html:code> is set properly,
add or correct the <html:code>UMASK</html:code> setting in <html:code>/etc/login.defs</html:code> to read as follows:
<html:pre>UMASK <ns5:sub idref="xccdf_org.ssgproject.content_value_var_accounts_user_umask" use="legacy" />
         </html:pre>
        </ns5:description>
                <ns5:reference href="https://www.cisecurity.org/controls/">11</ns5:reference>
                <ns5:reference href="https://www.cisecurity.org/controls/">18</ns5:reference>
                <ns5:reference href="https://www.cisecurity.org/controls/">3</ns5:reference>
                <ns5:reference href="https://www.cisecurity.org/controls/">9</ns5:reference>
                <ns5:reference href="https://www.isaca.org/resources/cobit">APO13.01</ns5:reference>
                <ns5:reference href="https://www.isaca.org/resources/cobit">BAI03.01</ns5:reference>
                <ns5:reference href="https://www.isaca.org/resources/cobit">BAI03.02</ns5:reference>
                <ns5:reference href="https://www.isaca.org/resources/cobit">BAI03.03</ns5:reference>
                <ns5:reference href="https://www.isaca.org/resources/cobit">BAI10.01</ns5:reference>
                <ns5:reference href="https://www.isaca.org/resources/cobit">BAI10.02</ns5:reference>
                <ns5:reference href="https://www.isaca.org/resources/cobit">BAI10.03</ns5:reference>
                <ns5:reference href="https://www.isaca.org/resources/cobit">BAI10.05</ns5:reference>
                <ns5:reference href="https://public.cyber.mil/stigs/cci/">CCI-000366</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.4.3.2</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.4.3.3</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">SR 7.6</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.12.1.2</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.12.5.1</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.12.6.2</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.14.1.1</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.14.2.1</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.14.2.2</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.14.2.3</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.14.2.4</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.14.2.5</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.6.1.5</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R5.1.1</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R5.3</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-6 R2.3</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R2.1</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R2.2</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R2.3</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R5.1</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R5.1.1</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R5.1.2</ns5:reference>
                <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-6(1)</ns5:reference>
                <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(a)</ns5:reference>
                <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">PR.IP-1</ns5:reference>
                <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">PR.IP-2</ns5:reference>
                <ns5:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os">SRG-OS-000480-GPOS-00228</ns5:reference>
                <ns5:reference href="https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf">R36</ns5:reference>
                <ns5:rationale>The umask value influences the permissions assigned to files when they are created.
A misconfigured umask value could result in files with excessive permissions that can be read and
written to by unauthorized users.</ns5:rationale>
                <ns5:platform idref="#package_shadow-utils" />
                <ns5:fix system="urn:xccdf:fix:script:sh" id="accounts_umask_etc_login_defs"># Remediation is applicable only in certain platforms
if rpm --quiet -q shadow-utils; then

var_accounts_user_umask='<ns5:sub idref="xccdf_org.ssgproject.content_value_var_accounts_user_umask" use="legacy" />'


# Strip any search characters in the key arg so that the key can be replaced without
# adding any search characters to the config file.
stripped_key=$(sed 's/[\^=\$,;+]*//g' &lt;&lt;&lt; "^UMASK")

# shellcheck disable=SC2059
printf -v formatted_output "%s %s" "$stripped_key" "$var_accounts_user_umask"

# If the key exists, change it. Otherwise, add it to the config_file.
# We search for the key string followed by a word boundary (matched by \&gt;),
# so if we search for 'setting', 'setting2' won't match.
if LC_ALL=C grep -q -m 1 -i -e "^UMASK\\&gt;" "/etc/login.defs"; then
    escaped_formatted_output=$(sed -e 's|/|\\/|g' &lt;&lt;&lt; "$formatted_output")
    LC_ALL=C sed -i --follow-symlinks "s/^UMASK\\&gt;.*/$escaped_formatted_output/gi" "/etc/login.defs"
else
    if [[ -s "/etc/login.defs" ]] &amp;&amp; [[ -n "$(tail -c 1 -- "/etc/login.defs" || true)" ]]; then
        LC_ALL=C sed -i --follow-symlinks '$a'\\ "/etc/login.defs"
    fi
    printf '%s\n' "$formatted_output" &gt;&gt; "/etc/login.defs"
fi

else
    &gt;&amp;2 echo 'Remediation is not applicable, nothing was done'
fi
</ns5:fix>
                <ns5:fix system="urn:xccdf:fix:script:ansible" id="accounts_umask_etc_login_defs" complexity="low" disruption="low" reboot="false" strategy="restrict">- name: Gather the package facts
  package_facts:
    manager: auto
  tags:
  - NIST-800-53-AC-6(1)
  - NIST-800-53-CM-6(a)
  - accounts_umask_etc_login_defs
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy
- name: XCCDF Value var_accounts_user_umask # promote to variable
  set_fact:
    var_accounts_user_umask: !!str <ns5:sub idref="xccdf_org.ssgproject.content_value_var_accounts_user_umask" use="legacy" />
  tags:
    - always

- name: Check if UMASK is already set
  ansible.builtin.lineinfile:
    path: /etc/login.defs
    regexp: ^(\s*)UMASK\s+.*
    state: absent
  check_mode: true
  changed_when: false
  register: result_umask_is_set
  when: '"shadow-utils" in ansible_facts.packages'
  tags:
  - NIST-800-53-AC-6(1)
  - NIST-800-53-CM-6(a)
  - accounts_umask_etc_login_defs
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy

- name: Replace user UMASK in /etc/login.defs
  ansible.builtin.replace:
    path: /etc/login.defs
    regexp: ^(\s*)UMASK(\s+).*
    replace: \g&lt;1&gt;UMASK\g&lt;2&gt;{{ var_accounts_user_umask }}
  when:
  - '"shadow-utils" in ansible_facts.packages'
  - result_umask_is_set.found &gt; 0
  tags:
  - NIST-800-53-AC-6(1)
  - NIST-800-53-CM-6(a)
  - accounts_umask_etc_login_defs
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy

- name: Ensure the Default UMASK is Appended Correctly
  ansible.builtin.lineinfile:
    create: true
    path: /etc/login.defs
    line: UMASK {{ var_accounts_user_umask }}
  when:
  - '"shadow-utils" in ansible_facts.packages'
  - result_umask_is_set.found == 0
  tags:
  - NIST-800-53-AC-6(1)
  - NIST-800-53-CM-6(a)
  - accounts_umask_etc_login_defs
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy
</ns5:fix>
                <ns5:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <ns5:check-export export-name="oval:ssg-var_accounts_user_umask:var:1" value-id="xccdf_org.ssgproject.content_value_var_accounts_user_umask" />
                  <ns5:check-content-ref href="ssg-gentoo-oval.xml" name="oval:ssg-accounts_umask_etc_login_defs:def:1" />
                </ns5:check>
                <ns5:check system="http://scap.nist.gov/schema/ocil/2">
                  <ns5:check-content-ref href="ssg-gentoo-ocil.xml" name="ocil:ssg-accounts_umask_etc_login_defs_ocil:questionnaire:1" />
                </ns5:check>
              </ns5:Rule>
              <ns5:Rule selected="false" id="xccdf_org.ssgproject.content_rule_accounts_umask_etc_profile" severity="medium">
                <ns5:title>Ensure the Default Umask is Set Correctly in /etc/profile</ns5:title>
                <ns5:description>To ensure the default umask controlled by <html:code>/etc/profile</html:code> is set properly,
add or correct the <html:code>umask</html:code> setting in <html:code>/etc/profile</html:code> to read as follows:
<html:pre>umask <ns5:sub idref="xccdf_org.ssgproject.content_value_var_accounts_user_umask" use="legacy" />
         </html:pre>

Note that <html:code>/etc/profile</html:code> also reads scrips within <html:code>/etc/profile.d</html:code> directory.
These scripts are also valid files to set umask value. Therefore, they should also be
considered during the check and properly remediated, if necessary.</ns5:description>
                <ns5:reference href="https://www.cisecurity.org/controls/">18</ns5:reference>
                <ns5:reference href="https://www.isaca.org/resources/cobit">APO13.01</ns5:reference>
                <ns5:reference href="https://www.isaca.org/resources/cobit">BAI03.01</ns5:reference>
                <ns5:reference href="https://www.isaca.org/resources/cobit">BAI03.02</ns5:reference>
                <ns5:reference href="https://www.isaca.org/resources/cobit">BAI03.03</ns5:reference>
                <ns5:reference href="https://public.cyber.mil/stigs/cci/">CCI-000366</ns5:reference>
                <ns5:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">4.3.4.3.3</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.14.1.1</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.14.2.1</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.14.2.5</ns5:reference>
                <ns5:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">A.6.1.5</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R5.1.1</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R5.3</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-6 R2.3</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R2.1</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R2.2</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R2.3</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R5.1</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R5.1.1</ns5:reference>
                <ns5:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R5.1.2</ns5:reference>
                <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-6(1)</ns5:reference>
                <ns5:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(a)</ns5:reference>
                <ns5:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">PR.IP-2</ns5:reference>
                <ns5:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os">SRG-OS-000480-GPOS-00228</ns5:reference>
                <ns5:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os">SRG-OS-000480-GPOS-00227</ns5:reference>
                <ns5:reference href="https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf">R36</ns5:reference>
                <ns5:rationale>The umask value influences the permissions assigned to files when they are created.
A misconfigured umask value could result in files with excessive permissions that can be read or
written to by unauthorized users.</ns5:rationale>
                <ns5:fix system="urn:xccdf:fix:script:sh" id="accounts_umask_etc_profile" complexity="low" disruption="low" reboot="false" strategy="restrict">
var_accounts_user_umask='<ns5:sub idref="xccdf_org.ssgproject.content_value_var_accounts_user_umask" use="legacy" />'


readarray -t profile_files &lt; &lt;(find /etc/profile.d/ -type f -name '*.sh' -or -name 'sh.local')

for file in "${profile_files[@]}" /etc/profile; do
  grep -qE '^[^#]*umask' "$file" &amp;&amp; sed -i -E "s/^(\s*umask\s*)[0-7]+/\1$var_accounts_user_umask/g" "$file"
done

if ! grep -qrE '^[^#]*umask' /etc/profile*; then
  echo "umask $var_accounts_user_umask" &gt;&gt; /etc/profile
fi
</ns5:fix>
                <ns5:fix system="urn:xccdf:fix:script:ansible" id="accounts_umask_etc_profile" complexity="low" disruption="low" reboot="false" strategy="restrict">- name: XCCDF Value var_accounts_user_umask # promote to variable
  set_fact:
    var_accounts_user_umask: !!str <ns5:sub idref="xccdf_org.ssgproject.content_value_var_accounts_user_umask" use="legacy" />
  tags:
    - always

- name: Ensure the Default Umask is Set Correctly in /etc/profile - Locate Profile
    Configuration Files Where umask Is Defined
  ansible.builtin.find:
    paths:
    - /etc/profile.d
    patterns:
    - sh.local
    - '*.sh'
    contains: ^[\s]*umask\s+\d+
  register: result_profile_d_files
  tags:
  - NIST-800-53-AC-6(1)
  - NIST-800-53-CM-6(a)
  - accounts_umask_etc_profile
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy

- name: Ensure the Default Umask is Set Correctly in /etc/profile - Replace Existing
    umask Value in Files From /etc/profile.d
  ansible.builtin.replace:
    path: '{{ item.path }}'
    regexp: ^(\s*)umask\s+\d+
    replace: \1umask {{ var_accounts_user_umask }}
  loop: '{{ result_profile_d_files.files }}'
  register: result_umask_replaced_profile_d
  when: result_profile_d_files.matched
  tags:
  - NIST-800-53-AC-6(1)
  - NIST-800-53-CM-6(a)
  - accounts_umask_etc_profile
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy

- name: Ensure the Default Umask is Set Correctly in /etc/profile - Ensure umask Is
    Set in /etc/profile if Not Already Set Elsewhere
  ansible.builtin.lineinfile:
    create: true
    mode: 420
    path: /etc/profile
    line: umask {{ var_accounts_user_umask }}
  when: not result_profile_d_files.matched
  tags:
  - NIST-800-53-AC-6(1)
  - NIST-800-53-CM-6(a)
  - accounts_umask_etc_profile
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy

- name: Ensure the Default Umask is Set Correctly in /etc/profile - Ensure umask Value
    For All Existing umask Definition in /etc/profile
  ansible.builtin.replace:
    path: /etc/profile
    regexp: ^(\s*)umask\s+\d+
    replace: \1umask {{ var_accounts_user_umask }}
  register: result_umask_replaced_profile
  tags:
  - NIST-800-53-AC-6(1)
  - NIST-800-53-CM-6(a)
  - accounts_umask_etc_profile
  - low_complexity
  - low_disruption
  - medium_severity
  - no_reboot_needed
  - restrict_strategy
</ns5:fix>
                <ns5:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <ns5:check-export export-name="oval:ssg-var_accounts_user_umask:var:1" value-id="xccdf_org.ssgproject.content_value_var_accounts_user_umask" />
                  <ns5:check-content-ref href="ssg-gentoo-oval.xml" name="oval:ssg-accounts_umask_etc_profile:def:1" />
                </ns5:check>
                <ns5:check system="http://scap.nist.gov/schema/ocil/2">
                  <ns5:check-content-ref href="ssg-gentoo-ocil.xml" name="ocil:ssg-accounts_umask_etc_profile_ocil:questionnaire:1" />
                </ns5:check>
              </ns5:Rule>
            </ns5:Group>
          </ns5:Group>
        </ns5:Group>
      </ns5:Group>
    </ns5:Benchmark>
  </ns0:component>
  <ns0:component id="scap_org.open-scap_comp_ssg-gentoo-oval.xml" timestamp="2024-06-04T12:03:54">
    <ns9:oval_definitions xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-common-5 oval-common-schema.xsd  http://oval.mitre.org/XMLSchema/oval-definitions-5 oval-definitions-schema.xsd  http://oval.mitre.org/XMLSchema/oval-definitions-5#independent independent-definitions-schema.xsd  http://oval.mitre.org/XMLSchema/oval-definitions-5#unix unix-definitions-schema.xsd  http://oval.mitre.org/XMLSchema/oval-definitions-5#linux linux-definitions-schema.xsd">
      <ns9:generator>
        <ns10:product_name>OVALFileLinker from SCAP Security Guide</ns10:product_name>
        <ns10:product_version>ssg: [0, 1, 73], python: 3.11.9</ns10:product_version>
        <ns10:schema_version>5.11</ns10:schema_version>
        <ns10:timestamp>2024-06-04T10:03:49</ns10:timestamp>
      </ns9:generator>
      <ns9:definitions>
        <ns9:definition id="oval:ssg-accounts_password_pam_unix_remember:def:1" version="2" class="compliance">
          <ns9:metadata>
            <ns9:title>Limit Password Reuse</ns9:title>
            <ns9:affected family="unix">
              <ns9:platform>Gentoo</ns9:platform>
            </ns9:affected>
            <ns9:reference ref_id="accounts_password_pam_unix_remember" source="ssg" />
            <ns9:description>The passwords to remember should be set correctly.</ns9:description>
          </ns9:metadata>
          <ns9:criteria comment="Check if pam_pwhistory.so or pam_unix.so are configured" operator="OR">
            <ns9:criteria comment="Check if pam_pwhistory.so is properly configured" operator="AND">
              <ns9:criterion comment="pam_pwhistory.so is properly defined in password section of PAM file" test_ref="oval:ssg-test_accounts_password_pam_unix_remember:tst:1" />
              <ns9:criteria comment="Check the expected value for pam_pwhistory.so remember parameter" operator="OR">
                <ns9:criteria comment="Check the pam_pwhistory.so remember parameter is only in PAM file" operator="AND">
                  <ns9:criterion comment="Check the remember parameter in password section of PAM file" test_ref="oval:ssg-test_accounts_password_pam_unix_remember_pamd:tst:1" />
                  <ns9:criterion comment="Check the pam_pwhistory.so remember parameter is absent in pwhistory.conf" test_ref="oval:ssg-test_accounts_password_pam_unix_remember_no_pwhistory_conf:tst:1" />
                </ns9:criteria>
                <ns9:criteria comment="Check the pam_pwhistory.so remember parameter is only in pwhistory.conf file" operator="AND">
                  <ns9:criterion comment="Check the pam_pwhistory.so remember parameter is absent in PAM file" test_ref="oval:ssg-test_accounts_password_pam_unix_remember_no_pamd:tst:1" />
                  <ns9:criterion comment="Check the remember parameter in /etc/security/pwhistory.conf" test_ref="oval:ssg-test_accounts_password_pam_unix_remember_pwhistory_conf:tst:1" />
                </ns9:criteria>
              </ns9:criteria>
            </ns9:criteria>
            <ns9:criterion comment="Remember parameter of pam_unix.so is properly configured" test_ref="oval:ssg-test_accounts_password_pam_unix_remember_legacy:tst:1" />
          </ns9:criteria>
        </ns9:definition>
        <ns9:definition id="oval:ssg-accounts_tmout:def:1" version="3" class="compliance">
          <ns9:metadata>
            <ns9:title>Set Interactive Session Timeout</ns9:title>
            <ns9:affected family="unix">
              <ns9:platform>Gentoo</ns9:platform>
            </ns9:affected>
            <ns9:reference ref_id="accounts_tmout" source="ssg" />
            <ns9:description>Checks interactive shell timeout</ns9:description>
          </ns9:metadata>
          <ns9:criteria operator="AND">
            <ns9:criterion comment="TMOUT value in /etc/profile &lt;= var_accounts_tmout" test_ref="oval:ssg-test_etc_profile_tmout:tst:1" />
            <ns9:criterion comment="TMOUT value in /etc/profile.d/*.sh &lt;= var_accounts_tmout" test_ref="oval:ssg-test_etc_profiled_tmout:tst:1" />
            <ns9:criterion comment="At least one config file has TMOUT defined" test_ref="oval:ssg-test_accounts_tmout_defined:tst:1" />
          </ns9:criteria>
        </ns9:definition>
        <ns9:definition id="oval:ssg-accounts_umask_etc_bashrc:def:1" version="2" class="compliance">
          <ns9:metadata>
            <ns9:title>Ensure the Default Bash Umask is Set Correctly</ns9:title>
            <ns9:affected family="unix">
              <ns9:platform>Gentoo</ns9:platform>
            </ns9:affected>
            <ns9:reference ref_id="accounts_umask_etc_bashrc" source="ssg" />
            <ns9:description>The default umask for users of the bash shell</ns9:description>
          </ns9:metadata>
          <ns9:criteria operator="AND">
            <ns9:extend_definition comment="Get value of var_accounts_user_umask variable as octal number" definition_ref="oval:ssg-var_accounts_user_umask_as_number:def:1" />
            <ns9:criterion test_ref="oval:ssg-tst_accounts_umask_etc_bashrc:tst:1" />
          </ns9:criteria>
        </ns9:definition>
        <ns9:definition id="oval:ssg-accounts_umask_etc_login_defs:def:1" version="2" class="compliance">
          <ns9:metadata>
            <ns9:title>Ensure the Default Umask is Set Correctly in login.defs</ns9:title>
            <ns9:affected family="unix">
              <ns9:platform>Gentoo</ns9:platform>
            </ns9:affected>
            <ns9:reference ref_id="accounts_umask_etc_login_defs" source="ssg" />
            <ns9:description>The default umask for all users specified in /etc/login.defs</ns9:description>
          </ns9:metadata>
          <ns9:criteria operator="AND">
            <ns9:extend_definition comment="Get value of var_accounts_user_umask variable as octal number" definition_ref="oval:ssg-var_accounts_user_umask_as_number:def:1" />
            <ns9:criterion test_ref="oval:ssg-tst_accounts_umask_etc_login_defs:tst:1" />
          </ns9:criteria>
        </ns9:definition>
        <ns9:definition id="oval:ssg-accounts_umask_etc_profile:def:1" version="2" class="compliance">
          <ns9:metadata>
            <ns9:title>Ensure the Default Umask is Set Correctly in /etc/profile</ns9:title>
            <ns9:affected family="unix">
              <ns9:platform>Gentoo</ns9:platform>
            </ns9:affected>
            <ns9:reference ref_id="accounts_umask_etc_profile" source="ssg" />
            <ns9:description>The default umask for all users should be set correctly</ns9:description>
          </ns9:metadata>
          <ns9:criteria operator="AND">
            <ns9:extend_definition comment="get value of var_accounts_user_umask variable as octal number" definition_ref="oval:ssg-var_accounts_user_umask_as_number:def:1" />
            <ns9:criterion test_ref="oval:ssg-tst_accounts_umask_etc_profile:tst:1" />
          </ns9:criteria>
        </ns9:definition>
        <ns9:definition id="oval:ssg-accounts_password_pam_dcredit:def:1" version="3" class="compliance">
          <ns9:metadata>
            <ns9:title>Ensure PAM Enforces Password Requirements - Minimum Digit Characters</ns9:title>
            <ns9:affected family="unix">
              <ns9:platform>Gentoo</ns9:platform>
            </ns9:affected>
            <ns9:reference ref_id="accounts_password_pam_dcredit" source="ssg" />
            <ns9:description>The password dcredit should meet minimum requirements</ns9:description>
          </ns9:metadata>
          <ns9:criteria comment="conditions for dcredit are satisfied" operator="AND">
            <ns9:extend_definition comment="pwquality.so exists in system-auth" definition_ref="oval:ssg-accounts_password_pam_pwquality:def:1" />
            <ns9:criteria operator="OR">
              <ns9:criterion comment="pwquality.conf" test_ref="oval:ssg-test_password_pam_pwquality_dcredit:tst:1" />
            </ns9:criteria>
          </ns9:criteria>
        </ns9:definition>
        <ns9:definition id="oval:ssg-accounts_password_pam_lcredit:def:1" version="3" class="compliance">
          <ns9:metadata>
            <ns9:title>Ensure PAM Enforces Password Requirements - Minimum Lowercase Characters</ns9:title>
            <ns9:affected family="unix">
              <ns9:platform>Gentoo</ns9:platform>
            </ns9:affected>
            <ns9:reference ref_id="accounts_password_pam_lcredit" source="ssg" />
            <ns9:description>The password lcredit should meet minimum requirements</ns9:description>
          </ns9:metadata>
          <ns9:criteria comment="conditions for lcredit are satisfied" operator="AND">
            <ns9:extend_definition comment="pwquality.so exists in system-auth" definition_ref="oval:ssg-accounts_password_pam_pwquality:def:1" />
            <ns9:criteria operator="OR">
              <ns9:criterion comment="pwquality.conf" test_ref="oval:ssg-test_password_pam_pwquality_lcredit:tst:1" />
            </ns9:criteria>
          </ns9:criteria>
        </ns9:definition>
        <ns9:definition id="oval:ssg-accounts_password_pam_minlen:def:1" version="3" class="compliance">
          <ns9:metadata>
            <ns9:title>Ensure PAM Enforces Password Requirements - Minimum Length</ns9:title>
            <ns9:affected family="unix">
              <ns9:platform>Gentoo</ns9:platform>
            </ns9:affected>
            <ns9:reference ref_id="accounts_password_pam_minlen" source="ssg" />
            <ns9:description>The password minlen should meet minimum requirements</ns9:description>
          </ns9:metadata>
          <ns9:criteria comment="conditions for minlen are satisfied" operator="AND">
            <ns9:extend_definition comment="pwquality.so exists in system-auth" definition_ref="oval:ssg-accounts_password_pam_pwquality:def:1" />
            <ns9:criteria operator="OR">
              <ns9:criterion comment="pwquality.conf" test_ref="oval:ssg-test_password_pam_pwquality_minlen:tst:1" />
            </ns9:criteria>
          </ns9:criteria>
        </ns9:definition>
        <ns9:definition id="oval:ssg-accounts_password_pam_ocredit:def:1" version="3" class="compliance">
          <ns9:metadata>
            <ns9:title>Ensure PAM Enforces Password Requirements - Minimum Special Characters</ns9:title>
            <ns9:affected family="unix">
              <ns9:platform>Gentoo</ns9:platform>
            </ns9:affected>
            <ns9:reference ref_id="accounts_password_pam_ocredit" source="ssg" />
            <ns9:description>The password ocredit should meet minimum requirements</ns9:description>
          </ns9:metadata>
          <ns9:criteria comment="conditions for ocredit are satisfied" operator="AND">
            <ns9:extend_definition comment="pwquality.so exists in system-auth" definition_ref="oval:ssg-accounts_password_pam_pwquality:def:1" />
            <ns9:criteria operator="OR">
              <ns9:criterion comment="pwquality.conf" test_ref="oval:ssg-test_password_pam_pwquality_ocredit:tst:1" />
            </ns9:criteria>
          </ns9:criteria>
        </ns9:definition>
        <ns9:definition id="oval:ssg-accounts_password_pam_ucredit:def:1" version="3" class="compliance">
          <ns9:metadata>
            <ns9:title>Ensure PAM Enforces Password Requirements - Minimum Uppercase Characters</ns9:title>
            <ns9:affected family="unix">
              <ns9:platform>Gentoo</ns9:platform>
            </ns9:affected>
            <ns9:reference ref_id="accounts_password_pam_ucredit" source="ssg" />
            <ns9:description>The password ucredit should meet minimum requirements</ns9:description>
          </ns9:metadata>
          <ns9:criteria comment="conditions for ucredit are satisfied" operator="AND">
            <ns9:extend_definition comment="pwquality.so exists in system-auth" definition_ref="oval:ssg-accounts_password_pam_pwquality:def:1" />
            <ns9:criteria operator="OR">
              <ns9:criterion comment="pwquality.conf" test_ref="oval:ssg-test_password_pam_pwquality_ucredit:tst:1" />
            </ns9:criteria>
          </ns9:criteria>
        </ns9:definition>
        <ns9:definition id="oval:ssg-accounts_password_pam_pwquality:def:1" version="1" class="compliance">
          <ns9:metadata>
            <ns9:title>Check pam_pwquality Existence in system-auth</ns9:title>
            <ns9:affected family="unix">
              <ns9:platform>Gentoo</ns9:platform>
            </ns9:affected>
            <ns9:reference ref_id="accounts_password_pam_pwquality" source="ssg" />
            <ns9:description>Check that pam_pwquality.so exists in system-auth</ns9:description>
          </ns9:metadata>
          <ns9:criteria operator="AND">
            <ns9:criterion comment="Conditions for pam_pwquality are satisfied" test_ref="oval:ssg-test_password_pam_pwquality:tst:1" />
          </ns9:criteria>
        </ns9:definition>
        <ns9:definition id="oval:ssg-var_accounts_user_umask_as_number:def:1" version="1" class="compliance">
          <ns9:metadata>
            <ns9:title>Value of 'var_accounts_user_umask' variable represented as octal number</ns9:title>
            <ns9:affected family="unix">
              <ns9:platform>Gentoo</ns9:platform>
            </ns9:affected>
            <ns9:reference ref_id="var_accounts_user_umask_as_number" source="ssg" />
            <ns9:description>Value of 'var_accounts_user_umask' variable represented as octal number</ns9:description>
          </ns9:metadata>
          <ns9:criteria operator="AND">
            <ns9:criterion test_ref="oval:ssg-test_existence_of_var_accounts_user_umask_as_number_variable:tst:1" />
          </ns9:criteria>
        </ns9:definition>
      </ns9:definitions>
      <ns9:tests>
        <ns11:textfilecontent54_test id="oval:ssg-test_accounts_password_pam_unix_remember:tst:1" version="1" check="all" comment="Check pam_pwhistory.so presence in PAM file" state_operator="AND">
          <ns11:object object_ref="oval:ssg-object_accounts_password_pam_unix_remember:obj:1" />
        </ns11:textfilecontent54_test>
        <ns11:textfilecontent54_test id="oval:ssg-test_accounts_password_pam_unix_remember_pamd:tst:1" version="1" check="all" comment="Check remember parameter is present and correct in PAM file" state_operator="AND">
          <ns11:object object_ref="oval:ssg-object_accounts_password_pam_unix_remember_pamd:obj:1" />
          <ns11:state state_ref="oval:ssg-state_accounts_password_pam_unix_remember:ste:1" />
        </ns11:textfilecontent54_test>
        <ns11:textfilecontent54_test id="oval:ssg-test_accounts_password_pam_unix_remember_no_pwhistory_conf:tst:1" version="1" check="all" comment="Check the absence of remember parameter in /etc/security/pwhistory.conf" check_existence="none_exist" state_operator="AND">
          <ns11:object object_ref="oval:ssg-object_accounts_password_pam_unix_remember_param_conf:obj:1" />
        </ns11:textfilecontent54_test>
        <ns11:textfilecontent54_test id="oval:ssg-test_accounts_password_pam_unix_remember_no_pamd:tst:1" version="1" check="all" comment="Check remember parameter is absent in PAM file" check_existence="none_exist" state_operator="AND">
          <ns11:object object_ref="oval:ssg-object_accounts_password_pam_unix_remember_pamd:obj:1" />
        </ns11:textfilecontent54_test>
        <ns11:textfilecontent54_test id="oval:ssg-test_accounts_password_pam_unix_remember_pwhistory_conf:tst:1" version="1" check="all" comment="Check remember parameter is present and correct in /etc/security/pwhistory.conf" check_existence="all_exist" state_operator="AND">
          <ns11:object object_ref="oval:ssg-object_accounts_password_pam_unix_remember_param_conf:obj:1" />
          <ns11:state state_ref="oval:ssg-state_accounts_password_pam_unix_remember:ste:1" />
        </ns11:textfilecontent54_test>
        <ns11:textfilecontent54_test id="oval:ssg-test_accounts_password_pam_unix_remember_legacy:tst:1" version="1" check="all" comment="Test if remember attribute of pam_unix.so is set correctly in /etc/pam.d/system-auth" check_existence="all_exist" state_operator="AND">
          <ns11:object object_ref="oval:ssg-object_accounts_password_pam_unix_remember_legacy:obj:1" />
          <ns11:state state_ref="oval:ssg-state_accounts_password_pam_unix_remember:ste:1" />
        </ns11:textfilecontent54_test>
        <ns11:textfilecontent54_test id="oval:ssg-test_etc_profile_tmout:tst:1" version="2" check="all" comment="TMOUT in /etc/profile" check_existence="any_exist" state_operator="AND">
          <ns11:object object_ref="oval:ssg-object_etc_profile_tmout:obj:1" />
          <ns11:state state_ref="oval:ssg-state_etc_profile_tmout:ste:1" />
        </ns11:textfilecontent54_test>
        <ns11:textfilecontent54_test id="oval:ssg-test_etc_profiled_tmout:tst:1" version="2" check="all" comment="TMOUT in /etc/profile.d/*.sh" check_existence="any_exist" state_operator="AND">
          <ns11:object object_ref="oval:ssg-object_etc_profiled_tmout:obj:1" />
          <ns11:state state_ref="oval:ssg-state_etc_profile_tmout:ste:1" />
        </ns11:textfilecontent54_test>
        <ns11:variable_test id="oval:ssg-test_accounts_tmout_defined:tst:1" version="1" check="all" comment="Check that at least one TMOUT is defined" check_existence="all_exist" state_operator="AND">
          <ns11:object object_ref="oval:ssg-object_accounts_tmout_defined:obj:1" />
          <ns11:state state_ref="oval:ssg-state_accounts_tmout_defined:ste:1" />
        </ns11:variable_test>
        <ns11:variable_test id="oval:ssg-tst_accounts_umask_etc_bashrc:tst:1" version="1" check="all" comment="Test the retrieved /etc/bash/bashrc umask value(s) match the var_accounts_user_umask requirement" state_operator="AND">
          <ns11:object object_ref="oval:ssg-obj_accounts_umask_etc_bashrc:obj:1" />
          <ns11:state state_ref="oval:ssg-ste_accounts_umask_etc_bashrc:ste:1" />
        </ns11:variable_test>
        <ns11:variable_test id="oval:ssg-tst_accounts_umask_etc_login_defs:tst:1" version="1" check="all" comment="Test the retrieved /etc/login.defs umask value(s) match the var_accounts_user_umask requirement" state_operator="AND">
          <ns11:object object_ref="oval:ssg-obj_accounts_umask_etc_login_defs:obj:1" />
          <ns11:state state_ref="oval:ssg-ste_accounts_umask_etc_login_defs:ste:1" />
        </ns11:variable_test>
        <ns11:variable_test id="oval:ssg-tst_accounts_umask_etc_profile:tst:1" version="1" check="all" comment="umask value(s) from profile configuration files match the requirement" state_operator="AND">
          <ns11:object object_ref="oval:ssg-obj_accounts_umask_etc_profile:obj:1" />
          <ns11:state state_ref="oval:ssg-ste_accounts_umask_etc_profile:ste:1" />
        </ns11:variable_test>
        <ns11:textfilecontent54_test id="oval:ssg-test_password_pam_pwquality_dcredit:tst:1" version="3" check="all" comment="check the configuration of /etc/security/pwquality.conf" state_operator="AND">
          <ns11:object object_ref="oval:ssg-obj_password_pam_pwquality_dcredit:obj:1" />
          <ns11:state state_ref="oval:ssg-state_password_pam_dcredit:ste:1" />
        </ns11:textfilecontent54_test>
        <ns11:textfilecontent54_test id="oval:ssg-test_password_pam_pwquality_lcredit:tst:1" version="3" check="all" comment="check the configuration of /etc/security/pwquality.conf" state_operator="AND">
          <ns11:object object_ref="oval:ssg-obj_password_pam_pwquality_lcredit:obj:1" />
          <ns11:state state_ref="oval:ssg-state_password_pam_lcredit:ste:1" />
        </ns11:textfilecontent54_test>
        <ns11:textfilecontent54_test id="oval:ssg-test_password_pam_pwquality_minlen:tst:1" version="3" check="all" comment="check the configuration of /etc/security/pwquality.conf" state_operator="AND">
          <ns11:object object_ref="oval:ssg-obj_password_pam_pwquality_minlen:obj:1" />
          <ns11:state state_ref="oval:ssg-state_password_pam_minlen:ste:1" />
        </ns11:textfilecontent54_test>
        <ns11:textfilecontent54_test id="oval:ssg-test_password_pam_pwquality_ocredit:tst:1" version="3" check="all" comment="check the configuration of /etc/security/pwquality.conf" state_operator="AND">
          <ns11:object object_ref="oval:ssg-obj_password_pam_pwquality_ocredit:obj:1" />
          <ns11:state state_ref="oval:ssg-state_password_pam_ocredit:ste:1" />
        </ns11:textfilecontent54_test>
        <ns11:textfilecontent54_test id="oval:ssg-test_password_pam_pwquality_ucredit:tst:1" version="3" check="all" comment="check the configuration of /etc/security/pwquality.conf" state_operator="AND">
          <ns11:object object_ref="oval:ssg-obj_password_pam_pwquality_ucredit:obj:1" />
          <ns11:state state_ref="oval:ssg-state_password_pam_ucredit:ste:1" />
        </ns11:textfilecontent54_test>
        <ns11:textfilecontent54_test id="oval:ssg-test_password_pam_pwquality:tst:1" version="1" check="all" comment="check the configuration of /etc/pam.d/system-auth" state_operator="AND">
          <ns11:object object_ref="oval:ssg-obj_password_pam_pwquality:obj:1" />
        </ns11:textfilecontent54_test>
        <ns11:variable_test id="oval:ssg-test_existence_of_var_accounts_user_umask_as_number_variable:tst:1" version="1" check="all" comment="Verify the existence of var_accounts_user_umask_as_number variable" state_operator="AND">
          <ns11:object object_ref="oval:ssg-object_var_accounts_user_umask_umask_as_number:obj:1" />
        </ns11:variable_test>
      </ns9:tests>
      <ns9:objects>
        <ns11:textfilecontent54_object id="oval:ssg-object_accounts_password_pam_unix_remember:obj:1" version="1">
          <ns11:filepath>/etc/pam.d/system-auth</ns11:filepath>
          <ns11:pattern var_ref="oval:ssg-var_accounts_password_pam_unix_remember_module_regex:var:1" var_check="at least one" operation="pattern match" />
          <ns11:instance datatype="int">1</ns11:instance>
        </ns11:textfilecontent54_object>
        <ns11:textfilecontent54_object id="oval:ssg-object_accounts_password_pam_unix_remember_pamd:obj:1" version="1">
          <ns11:filepath>/etc/pam.d/system-auth</ns11:filepath>
          <ns11:pattern var_check="at least one" operation="pattern match" var_ref="oval:ssg-var_accounts_password_pam_unix_remember_pam_param_regex:var:1" />
          <ns11:instance datatype="int">1</ns11:instance>
        </ns11:textfilecontent54_object>
        <ns11:textfilecontent54_object id="oval:ssg-object_accounts_password_pam_unix_remember_param_conf:obj:1" version="1" comment="Collect the pam_pwhistory.so remember parameter from /etc/security/pwhistory.conf">
          <ns11:filepath operation="pattern match">^/etc/security/pwhistory.conf$</ns11:filepath>
          <ns11:pattern operation="pattern match" var_ref="oval:ssg-var_accounts_password_pam_unix_remember_conf_param_regex:var:1" />
          <ns11:instance datatype="int" operation="equals">1</ns11:instance>
        </ns11:textfilecontent54_object>
        <ns11:textfilecontent54_object id="oval:ssg-object_accounts_password_pam_unix_remember_legacy:obj:1" version="1">
          <ns11:filepath>/etc/pam.d/system-auth</ns11:filepath>
          <ns11:pattern operation="pattern match">^\s*password\s+(?:(?:sufficient)|(?:required)|(?:\[.*\]))\s+pam_unix\.so.*remember=([0-9]*).*$</ns11:pattern>
          <ns11:instance datatype="int">1</ns11:instance>
        </ns11:textfilecontent54_object>
        <ns11:textfilecontent54_object id="oval:ssg-object_etc_profile_tmout:obj:1" version="3">
          <ns11:filepath>/etc/profile</ns11:filepath>
          <ns11:pattern operation="pattern match">^[\s]*(?:typeset|declare)[\s]+-xr[\s]+TMOUT=([\w$]+).*$</ns11:pattern>
          <ns11:instance operation="greater than or equal" datatype="int">1</ns11:instance>
        </ns11:textfilecontent54_object>
        <ns11:textfilecontent54_object id="oval:ssg-object_etc_profiled_tmout:obj:1" version="3">
          <ns11:path>/etc/profile.d</ns11:path>
          <ns11:filename operation="pattern match">^.*\.sh$</ns11:filename>
          <ns11:pattern operation="pattern match">^[\s]*(?:typeset|declare)[\s]+-xr[\s]+TMOUT=([\w$]+).*$</ns11:pattern>
          <ns11:instance operation="greater than or equal" datatype="int">1</ns11:instance>
        </ns11:textfilecontent54_object>
        <ns11:textfilecontent54_object id="oval:ssg-object_accounts_tmout_all_tmout_instances:obj:1" version="1">
          <ns9:set>
            <ns9:object_reference>oval:ssg-object_etc_profile_tmout:obj:1</ns9:object_reference>
            <ns9:object_reference>oval:ssg-object_etc_profiled_tmout:obj:1</ns9:object_reference>
          </ns9:set>
        </ns11:textfilecontent54_object>
        <ns11:variable_object id="oval:ssg-object_accounts_tmout_defined:obj:1" version="1">
          <ns11:var_ref>oval:ssg-variable_count_of_tmout_instances:var:1</ns11:var_ref>
        </ns11:variable_object>
        <ns11:textfilecontent54_object id="oval:ssg-obj_umask_from_etc_bashrc:obj:1" version="1" comment="Umask value from /etc/bash/bashrc">
          <ns11:filepath>/etc/bash/bashrc</ns11:filepath>
          <ns11:pattern operation="pattern match">^[^#]*\bumask\s+(\d{3})\s*$</ns11:pattern>
          <ns11:instance datatype="int" operation="greater than or equal">1</ns11:instance>
        </ns11:textfilecontent54_object>
        <ns11:variable_object id="oval:ssg-obj_accounts_umask_etc_bashrc:obj:1" version="1">
          <ns11:var_ref>oval:ssg-var_etc_bashrc_umask_as_number:var:1</ns11:var_ref>
        </ns11:variable_object>
        <ns11:textfilecontent54_object id="oval:ssg-obj_umask_from_etc_login_defs:obj:1" version="1" comment="Umask value from /etc/login.defs">
          <ns11:filepath>/etc/login.defs</ns11:filepath>
          <ns11:pattern operation="pattern match">^[\s]*UMASK[\s]+([^#\s]*)</ns11:pattern>
          <ns11:instance datatype="int" operation="greater than or equal">1</ns11:instance>
        </ns11:textfilecontent54_object>
        <ns11:variable_object id="oval:ssg-obj_accounts_umask_etc_login_defs:obj:1" version="1">
          <ns11:var_ref>oval:ssg-var_etc_login_defs_umask_as_number:var:1</ns11:var_ref>
        </ns11:variable_object>
        <ns11:textfilecontent54_object id="oval:ssg-obj_umask_from_etc_profile:obj:1" version="1" comment="umask value retrieved from profile configuration files">
          <ns11:filepath operation="pattern match">^\/etc\/profile(?:\.d\/.*\.sh|\.d\/sh\.local)?$</ns11:filepath>
          <ns11:pattern operation="pattern match">^[\s]*umask[\s]+([^#\s]*)</ns11:pattern>
          <ns11:instance datatype="int" operation="greater than or equal">1</ns11:instance>
        </ns11:textfilecontent54_object>
        <ns11:variable_object id="oval:ssg-obj_accounts_umask_etc_profile:obj:1" version="1">
          <ns11:var_ref>oval:ssg-var_etc_profile_umask_as_number:var:1</ns11:var_ref>
        </ns11:variable_object>
        <ns11:textfilecontent54_object id="oval:ssg-obj_password_pam_pwquality_dcredit:obj:1" version="3">
          <ns11:filepath operation="pattern match">^/etc/security/pwquality\.conf$</ns11:filepath>
          <ns11:pattern operation="pattern match">^\s*dcredit[\s]*=[\s]*(-?\d+)(?:[\s]|$)</ns11:pattern>
          <ns11:instance datatype="int" operation="greater than or equal">1</ns11:instance>
        </ns11:textfilecontent54_object>
        <ns11:textfilecontent54_object id="oval:ssg-obj_password_pam_pwquality_lcredit:obj:1" version="3">
          <ns11:filepath operation="pattern match">^/etc/security/pwquality\.conf$</ns11:filepath>
          <ns11:pattern operation="pattern match">^\s*lcredit[\s]*=[\s]*(-?\d+)(?:[\s]|$)</ns11:pattern>
          <ns11:instance datatype="int" operation="greater than or equal">1</ns11:instance>
        </ns11:textfilecontent54_object>
        <ns11:textfilecontent54_object id="oval:ssg-obj_password_pam_pwquality_minlen:obj:1" version="3">
          <ns11:filepath operation="pattern match">^/etc/security/pwquality\.conf$</ns11:filepath>
          <ns11:pattern operation="pattern match">^\s*minlen[\s]*=[\s]*(-?\d+)(?:[\s]|$)</ns11:pattern>
          <ns11:instance datatype="int" operation="greater than or equal">1</ns11:instance>
        </ns11:textfilecontent54_object>
        <ns11:textfilecontent54_object id="oval:ssg-obj_password_pam_pwquality_ocredit:obj:1" version="3">
          <ns11:filepath operation="pattern match">^/etc/security/pwquality\.conf$</ns11:filepath>
          <ns11:pattern operation="pattern match">^\s*ocredit[\s]*=[\s]*(-?\d+)(?:[\s]|$)</ns11:pattern>
          <ns11:instance datatype="int" operation="greater than or equal">1</ns11:instance>
        </ns11:textfilecontent54_object>
        <ns11:textfilecontent54_object id="oval:ssg-obj_password_pam_pwquality_ucredit:obj:1" version="3">
          <ns11:filepath operation="pattern match">^/etc/security/pwquality\.conf$</ns11:filepath>
          <ns11:pattern operation="pattern match">^\s*ucredit[\s]*=[\s]*(-?\d+)(?:[\s]|$)</ns11:pattern>
          <ns11:instance datatype="int" operation="greater than or equal">1</ns11:instance>
        </ns11:textfilecontent54_object>
        <ns11:textfilecontent54_object id="oval:ssg-obj_password_pam_pwquality:obj:1" version="1">
          <ns11:filepath var_ref="oval:ssg-var_pam_pwquality_config_path:var:1" var_check="at least one" />
          <ns11:pattern operation="pattern match">^\s*password\s+(?:(?:required)|(?:requisite))\s+pam_pwquality\.so.*$</ns11:pattern>
          <ns11:instance datatype="int">1</ns11:instance>
        </ns11:textfilecontent54_object>
        <ns11:variable_object id="oval:ssg-object_var_accounts_user_umask_umask_as_number:obj:1" version="1">
          <ns11:var_ref>oval:ssg-var_accounts_user_umask_umask_as_number:var:1</ns11:var_ref>
        </ns11:variable_object>
      </ns9:objects>
      <ns9:states>
        <ns11:textfilecontent54_state id="oval:ssg-state_accounts_password_pam_unix_remember:ste:1" version="1" operator="AND">
          <ns11:subexpression datatype="int" operation="greater than or equal" var_ref="oval:ssg-var_password_pam_unix_remember:var:1" />
        </ns11:textfilecontent54_state>
        <ns11:variable_state id="oval:ssg-state_accounts_tmout_defined:ste:1" version="1" operator="AND">
          <ns11:value operation="greater than or equal" datatype="int">1</ns11:value>
        </ns11:variable_state>
        <ns11:textfilecontent54_state id="oval:ssg-state_etc_profile_tmout:ste:1" version="2" operator="AND">
          <ns11:subexpression datatype="int" operation="less than or equal" var_check="all" var_ref="oval:ssg-var_accounts_tmout:var:1" />
        </ns11:textfilecontent54_state>
        <ns11:variable_state id="oval:ssg-ste_accounts_umask_etc_bashrc:ste:1" version="1" operator="AND">
          <ns11:value datatype="int" operation="bitwise and" var_ref="oval:ssg-var_accounts_user_umask_umask_as_number:var:1" />
        </ns11:variable_state>
        <ns11:variable_state id="oval:ssg-ste_accounts_umask_etc_login_defs:ste:1" version="1" operator="AND">
          <ns11:value datatype="int" operation="bitwise and" var_ref="oval:ssg-var_accounts_user_umask_umask_as_number:var:1" />
        </ns11:variable_state>
        <ns11:variable_state id="oval:ssg-ste_accounts_umask_etc_profile:ste:1" version="1" operator="AND">
          <ns11:value datatype="int" operation="bitwise and" var_ref="oval:ssg-var_accounts_user_umask_umask_as_number:var:1" />
        </ns11:variable_state>
        <ns11:textfilecontent54_state id="oval:ssg-state_password_pam_dcredit:ste:1" version="3" operator="AND">
          <ns11:subexpression datatype="int" operation="less than or equal" var_ref="oval:ssg-var_password_pam_dcredit:var:1" />
        </ns11:textfilecontent54_state>
        <ns11:textfilecontent54_state id="oval:ssg-state_password_pam_lcredit:ste:1" version="3" operator="AND">
          <ns11:subexpression datatype="int" operation="less than or equal" var_ref="oval:ssg-var_password_pam_lcredit:var:1" />
        </ns11:textfilecontent54_state>
        <ns11:textfilecontent54_state id="oval:ssg-state_password_pam_minlen:ste:1" version="3" operator="AND">
          <ns11:subexpression datatype="int" operation="greater than or equal" var_ref="oval:ssg-var_password_pam_minlen:var:1" />
        </ns11:textfilecontent54_state>
        <ns11:textfilecontent54_state id="oval:ssg-state_password_pam_ocredit:ste:1" version="3" operator="AND">
          <ns11:subexpression datatype="int" operation="less than or equal" var_ref="oval:ssg-var_password_pam_ocredit:var:1" />
        </ns11:textfilecontent54_state>
        <ns11:textfilecontent54_state id="oval:ssg-state_password_pam_ucredit:ste:1" version="3" operator="AND">
          <ns11:subexpression datatype="int" operation="less than or equal" var_ref="oval:ssg-var_password_pam_ucredit:var:1" />
        </ns11:textfilecontent54_state>
      </ns9:states>
      <ns9:variables>
        <ns9:external_variable id="oval:ssg-var_password_pam_unix_remember:var:1" version="1" datatype="int" comment="number of passwords that should be remembered" />
        <ns9:local_variable id="oval:ssg-var_accounts_password_pam_unix_remember_module_regex:var:1" version="1" datatype="string" comment="The regex is to confirm the pam_pwhistory.so module is enabled">
          <ns9:literal_component>^\s*password\s+(?:(?:requisite)|(?:required))\s+pam_pwhistory\.so.*$</ns9:literal_component>
        </ns9:local_variable>
        <ns9:local_variable id="oval:ssg-var_accounts_password_pam_unix_remember_pam_param_regex:var:1" version="1" datatype="string" comment="The regex is to collect the pam_pwhistory.so remember paramerter from PAM files">
          <ns9:literal_component>^\s*password\b.*\bpam_pwhistory\.so\b.*\bremember=([0-9]*).*$</ns9:literal_component>
        </ns9:local_variable>
        <ns9:local_variable id="oval:ssg-var_accounts_password_pam_unix_remember_conf_param_regex:var:1" version="1" datatype="string" comment="The regex is to collect the pam_pwhistory.so remember paramerter in pwhistory.conf">
          <ns9:literal_component>^\s*remember\s*=\s*([0-9]+)</ns9:literal_component>
        </ns9:local_variable>
        <ns9:local_variable id="oval:ssg-variable_count_of_tmout_instances:var:1" version="1" datatype="int" comment="Count of TMOUT instances">
          <ns9:count>
            <ns9:object_component object_ref="oval:ssg-object_accounts_tmout_all_tmout_instances:obj:1" item_field="text" />
          </ns9:count>
        </ns9:local_variable>
        <ns9:external_variable id="oval:ssg-var_accounts_tmout:var:1" version="1" datatype="int" comment="external variable for TMOUT" />
        <ns9:local_variable id="oval:ssg-var_first_digit_of_umask_from_etc_bashrc:var:1" version="1" datatype="int" comment="First octal digit of umask from /etc/bash/bashrc">
          <ns9:substring substring_start="1" substring_length="1">
            <ns9:object_component item_field="subexpression" object_ref="oval:ssg-obj_umask_from_etc_bashrc:obj:1" />
          </ns9:substring>
        </ns9:local_variable>
        <ns9:local_variable id="oval:ssg-var_second_digit_of_umask_from_etc_bashrc:var:1" version="1" datatype="int" comment="Second octal digit of umask from /etc/bash/bashrc">
          <ns9:substring substring_start="2" substring_length="1">
            <ns9:object_component item_field="subexpression" object_ref="oval:ssg-obj_umask_from_etc_bashrc:obj:1" />
          </ns9:substring>
        </ns9:local_variable>
        <ns9:local_variable id="oval:ssg-var_third_digit_of_umask_from_etc_bashrc:var:1" version="1" datatype="int" comment="Third octal digit of umask from /etc/bash/bashrc">
          <ns9:substring substring_start="3" substring_length="1">
            <ns9:object_component item_field="subexpression" object_ref="oval:ssg-obj_umask_from_etc_bashrc:obj:1" />
          </ns9:substring>
        </ns9:local_variable>
        <ns9:local_variable id="oval:ssg-var_etc_bashrc_umask_as_number:var:1" version="1" datatype="int" comment="/etc/bash/bashrc umask converted from string to a number">
          <ns9:arithmetic arithmetic_operation="add">
            <ns9:arithmetic arithmetic_operation="multiply">
              <ns9:literal_component datatype="int">64</ns9:literal_component>
              <ns9:variable_component var_ref="oval:ssg-var_first_digit_of_umask_from_etc_bashrc:var:1" />
            </ns9:arithmetic>
            <ns9:arithmetic arithmetic_operation="multiply">
              <ns9:literal_component datatype="int">8</ns9:literal_component>
              <ns9:variable_component var_ref="oval:ssg-var_second_digit_of_umask_from_etc_bashrc:var:1" />
            </ns9:arithmetic>
            <ns9:variable_component var_ref="oval:ssg-var_third_digit_of_umask_from_etc_bashrc:var:1" />
          </ns9:arithmetic>
        </ns9:local_variable>
        <ns9:local_variable id="oval:ssg-var_first_digit_of_umask_from_etc_login_defs:var:1" version="1" datatype="int" comment="First octal digit of umask from /etc/login.defs">
          <ns9:substring substring_start="1" substring_length="1">
            <ns9:object_component item_field="subexpression" object_ref="oval:ssg-obj_umask_from_etc_login_defs:obj:1" />
          </ns9:substring>
        </ns9:local_variable>
        <ns9:local_variable id="oval:ssg-var_second_digit_of_umask_from_etc_login_defs:var:1" version="1" datatype="int" comment="Second octal digit of umask from /etc/login.defs">
          <ns9:substring substring_start="2" substring_length="1">
            <ns9:object_component item_field="subexpression" object_ref="oval:ssg-obj_umask_from_etc_login_defs:obj:1" />
          </ns9:substring>
        </ns9:local_variable>
        <ns9:local_variable id="oval:ssg-var_third_digit_of_umask_from_etc_login_defs:var:1" version="1" datatype="int" comment="Third octal digit of umask from /etc/login.defs">
          <ns9:substring substring_start="3" substring_length="1">
            <ns9:object_component item_field="subexpression" object_ref="oval:ssg-obj_umask_from_etc_login_defs:obj:1" />
          </ns9:substring>
        </ns9:local_variable>
        <ns9:local_variable id="oval:ssg-var_etc_login_defs_umask_as_number:var:1" version="1" datatype="int" comment="/etc/login.defs umask converted from string to a number">
          <ns9:arithmetic arithmetic_operation="add">
            <ns9:arithmetic arithmetic_operation="multiply">
              <ns9:literal_component datatype="int">64</ns9:literal_component>
              <ns9:variable_component var_ref="oval:ssg-var_first_digit_of_umask_from_etc_login_defs:var:1" />
            </ns9:arithmetic>
            <ns9:arithmetic arithmetic_operation="multiply">
              <ns9:literal_component datatype="int">8</ns9:literal_component>
              <ns9:variable_component var_ref="oval:ssg-var_second_digit_of_umask_from_etc_login_defs:var:1" />
            </ns9:arithmetic>
            <ns9:variable_component var_ref="oval:ssg-var_third_digit_of_umask_from_etc_login_defs:var:1" />
          </ns9:arithmetic>
        </ns9:local_variable>
        <ns9:local_variable id="oval:ssg-var_first_digit_of_umask_from_etc_profile:var:1" version="1" datatype="int" comment="first octal digit of umask value(s)">
          <ns9:substring substring_start="1" substring_length="1">
            <ns9:object_component item_field="subexpression" object_ref="oval:ssg-obj_umask_from_etc_profile:obj:1" />
          </ns9:substring>
        </ns9:local_variable>
        <ns9:local_variable id="oval:ssg-var_second_digit_of_umask_from_etc_profile:var:1" version="1" datatype="int" comment="second octal digit of umask value(s)">
          <ns9:substring substring_start="2" substring_length="1">
            <ns9:object_component item_field="subexpression" object_ref="oval:ssg-obj_umask_from_etc_profile:obj:1" />
          </ns9:substring>
        </ns9:local_variable>
        <ns9:local_variable id="oval:ssg-var_third_digit_of_umask_from_etc_profile:var:1" version="1" datatype="int" comment="third octal digit of umask value(s)">
          <ns9:substring substring_start="3" substring_length="1">
            <ns9:object_component item_field="subexpression" object_ref="oval:ssg-obj_umask_from_etc_profile:obj:1" />
          </ns9:substring>
        </ns9:local_variable>
        <ns9:local_variable id="oval:ssg-var_etc_profile_umask_as_number:var:1" version="1" datatype="int" comment="umask value converted from string to a number">
          <ns9:arithmetic arithmetic_operation="add">
            <ns9:arithmetic arithmetic_operation="multiply">
              <ns9:literal_component datatype="int">64</ns9:literal_component>
              <ns9:variable_component var_ref="oval:ssg-var_first_digit_of_umask_from_etc_profile:var:1" />
            </ns9:arithmetic>
            <ns9:arithmetic arithmetic_operation="multiply">
              <ns9:literal_component datatype="int">8</ns9:literal_component>
              <ns9:variable_component var_ref="oval:ssg-var_second_digit_of_umask_from_etc_profile:var:1" />
            </ns9:arithmetic>
            <ns9:variable_component var_ref="oval:ssg-var_third_digit_of_umask_from_etc_profile:var:1" />
          </ns9:arithmetic>
        </ns9:local_variable>
        <ns9:external_variable id="oval:ssg-var_password_pam_dcredit:var:1" version="3" datatype="int" comment="External variable for pam_dcredit" />
        <ns9:external_variable id="oval:ssg-var_password_pam_lcredit:var:1" version="3" datatype="int" comment="External variable for pam_lcredit" />
        <ns9:external_variable id="oval:ssg-var_password_pam_minlen:var:1" version="3" datatype="int" comment="External variable for pam_minlen" />
        <ns9:external_variable id="oval:ssg-var_password_pam_ocredit:var:1" version="3" datatype="int" comment="External variable for pam_ocredit" />
        <ns9:external_variable id="oval:ssg-var_password_pam_ucredit:var:1" version="3" datatype="int" comment="External variable for pam_ucredit" />
        <ns9:constant_variable id="oval:ssg-var_pam_pwquality_config_path:var:1" version="1" datatype="string" comment="correct path for pam_pwquality.so check">
          <ns9:value>/etc/pam.d/system-auth</ns9:value>
        </ns9:constant_variable>
        <ns9:external_variable id="oval:ssg-var_accounts_user_umask:var:1" version="1" datatype="string" comment="Value of var_accounts_user_umask (the required umask) as string" />
        <ns9:local_variable id="oval:ssg-var_first_digit_of_umask_from_var_accounts_user_umask:var:1" version="1" datatype="int" comment="First octal digit of umask from var_accounts_user_umask">
          <ns9:substring substring_start="1" substring_length="1">
            <ns9:variable_component var_ref="oval:ssg-var_accounts_user_umask:var:1" />
          </ns9:substring>
        </ns9:local_variable>
        <ns9:local_variable id="oval:ssg-var_second_digit_of_umask_from_var_accounts_user_umask:var:1" version="1" datatype="int" comment="Second octal digit of umask from var_accounts_user_umask">
          <ns9:substring substring_start="2" substring_length="1">
            <ns9:variable_component var_ref="oval:ssg-var_accounts_user_umask:var:1" />
          </ns9:substring>
        </ns9:local_variable>
        <ns9:local_variable id="oval:ssg-var_third_digit_of_umask_from_var_accounts_user_umask:var:1" version="1" datatype="int" comment="Third octal digit of umask from var_accounts_user_umask">
          <ns9:substring substring_start="3" substring_length="1">
            <ns9:variable_component var_ref="oval:ssg-var_accounts_user_umask:var:1" />
          </ns9:substring>
        </ns9:local_variable>
        <ns9:local_variable id="oval:ssg-var_accounts_user_umask_umask_as_number:var:1" version="1" datatype="int" comment="var_accounts_user_umask umask converted from string to a number">
          <ns9:arithmetic arithmetic_operation="add">
            <ns9:arithmetic arithmetic_operation="multiply">
              <ns9:literal_component datatype="int">64</ns9:literal_component>
              <ns9:variable_component var_ref="oval:ssg-var_first_digit_of_umask_from_var_accounts_user_umask:var:1" />
            </ns9:arithmetic>
            <ns9:arithmetic arithmetic_operation="multiply">
              <ns9:literal_component datatype="int">8</ns9:literal_component>
              <ns9:variable_component var_ref="oval:ssg-var_second_digit_of_umask_from_var_accounts_user_umask:var:1" />
            </ns9:arithmetic>
            <ns9:variable_component var_ref="oval:ssg-var_third_digit_of_umask_from_var_accounts_user_umask:var:1" />
          </ns9:arithmetic>
        </ns9:local_variable>
      </ns9:variables>
    </ns9:oval_definitions>
  </ns0:component>
  <ns0:component id="scap_org.open-scap_comp_ssg-gentoo-ocil.xml" timestamp="2024-06-04T12:03:54">
    <ns12:ocil>
      <ns12:generator>
        <ns12:product_name>build_shorthand.py from SCAP Security Guide</ns12:product_name>
        <ns12:product_version>ssg: 0.1.73</ns12:product_version>
        <ns12:schema_version>2.0</ns12:schema_version>
        <ns12:timestamp>2024-06-04T10:03:49</ns12:timestamp>
      </ns12:generator>
      <ns12:questionnaires>
        <ns12:questionnaire id="ocil:ssg-accounts_password_pam_ocredit_ocil:questionnaire:1">
          <ns12:title>Ensure PAM Enforces Password Requirements - Minimum Special Characters</ns12:title>
          <ns12:actions>
            <ns12:test_action_ref>ocil:ssg-accounts_password_pam_ocredit_action:testaction:1</ns12:test_action_ref>
          </ns12:actions>
        </ns12:questionnaire>
        <ns12:questionnaire id="ocil:ssg-accounts_umask_etc_login_defs_ocil:questionnaire:1">
          <ns12:title>Ensure the Default Umask is Set Correctly in login.defs</ns12:title>
          <ns12:actions>
            <ns12:test_action_ref>ocil:ssg-accounts_umask_etc_login_defs_action:testaction:1</ns12:test_action_ref>
          </ns12:actions>
        </ns12:questionnaire>
        <ns12:questionnaire id="ocil:ssg-accounts_password_pam_unix_remember_ocil:questionnaire:1">
          <ns12:title>Limit Password Reuse</ns12:title>
          <ns12:actions>
            <ns12:test_action_ref>ocil:ssg-accounts_password_pam_unix_remember_action:testaction:1</ns12:test_action_ref>
          </ns12:actions>
        </ns12:questionnaire>
        <ns12:questionnaire id="ocil:ssg-accounts_password_pam_lcredit_ocil:questionnaire:1">
          <ns12:title>Ensure PAM Enforces Password Requirements - Minimum Lowercase Characters</ns12:title>
          <ns12:actions>
            <ns12:test_action_ref>ocil:ssg-accounts_password_pam_lcredit_action:testaction:1</ns12:test_action_ref>
          </ns12:actions>
        </ns12:questionnaire>
        <ns12:questionnaire id="ocil:ssg-accounts_password_pam_dcredit_ocil:questionnaire:1">
          <ns12:title>Ensure PAM Enforces Password Requirements - Minimum Digit Characters</ns12:title>
          <ns12:actions>
            <ns12:test_action_ref>ocil:ssg-accounts_password_pam_dcredit_action:testaction:1</ns12:test_action_ref>
          </ns12:actions>
        </ns12:questionnaire>
        <ns12:questionnaire id="ocil:ssg-accounts_tmout_ocil:questionnaire:1">
          <ns12:title>Set Interactive Session Timeout</ns12:title>
          <ns12:actions>
            <ns12:test_action_ref>ocil:ssg-accounts_tmout_action:testaction:1</ns12:test_action_ref>
          </ns12:actions>
        </ns12:questionnaire>
        <ns12:questionnaire id="ocil:ssg-accounts_password_pam_ucredit_ocil:questionnaire:1">
          <ns12:title>Ensure PAM Enforces Password Requirements - Minimum Uppercase Characters</ns12:title>
          <ns12:actions>
            <ns12:test_action_ref>ocil:ssg-accounts_password_pam_ucredit_action:testaction:1</ns12:test_action_ref>
          </ns12:actions>
        </ns12:questionnaire>
        <ns12:questionnaire id="ocil:ssg-accounts_umask_etc_profile_ocil:questionnaire:1">
          <ns12:title>Ensure the Default Umask is Set Correctly in /etc/profile</ns12:title>
          <ns12:actions>
            <ns12:test_action_ref>ocil:ssg-accounts_umask_etc_profile_action:testaction:1</ns12:test_action_ref>
          </ns12:actions>
        </ns12:questionnaire>
        <ns12:questionnaire id="ocil:ssg-accounts_password_pam_minlen_ocil:questionnaire:1">
          <ns12:title>Ensure PAM Enforces Password Requirements - Minimum Length</ns12:title>
          <ns12:actions>
            <ns12:test_action_ref>ocil:ssg-accounts_password_pam_minlen_action:testaction:1</ns12:test_action_ref>
          </ns12:actions>
        </ns12:questionnaire>
        <ns12:questionnaire id="ocil:ssg-accounts_umask_etc_bashrc_ocil:questionnaire:1">
          <ns12:title>Ensure the Default Bash Umask is Set Correctly</ns12:title>
          <ns12:actions>
            <ns12:test_action_ref>ocil:ssg-accounts_umask_etc_bashrc_action:testaction:1</ns12:test_action_ref>
          </ns12:actions>
        </ns12:questionnaire>
      </ns12:questionnaires>
      <ns12:test_actions>
        <ns12:boolean_question_test_action id="ocil:ssg-accounts_password_pam_ocredit_action:testaction:1" question_ref="ocil:ssg-accounts_password_pam_ocredit_question:question:1">
          <ns12:when_true>
            <ns12:result>PASS</ns12:result>
          </ns12:when_true>
          <ns12:when_false>
            <ns12:result>FAIL</ns12:result>
          </ns12:when_false>
        </ns12:boolean_question_test_action>
        <ns12:boolean_question_test_action id="ocil:ssg-accounts_umask_etc_login_defs_action:testaction:1" question_ref="ocil:ssg-accounts_umask_etc_login_defs_question:question:1">
          <ns12:when_true>
            <ns12:result>PASS</ns12:result>
          </ns12:when_true>
          <ns12:when_false>
            <ns12:result>FAIL</ns12:result>
          </ns12:when_false>
        </ns12:boolean_question_test_action>
        <ns12:boolean_question_test_action id="ocil:ssg-accounts_password_pam_unix_remember_action:testaction:1" question_ref="ocil:ssg-accounts_password_pam_unix_remember_question:question:1">
          <ns12:when_true>
            <ns12:result>PASS</ns12:result>
          </ns12:when_true>
          <ns12:when_false>
            <ns12:result>FAIL</ns12:result>
          </ns12:when_false>
        </ns12:boolean_question_test_action>
        <ns12:boolean_question_test_action id="ocil:ssg-accounts_password_pam_lcredit_action:testaction:1" question_ref="ocil:ssg-accounts_password_pam_lcredit_question:question:1">
          <ns12:when_true>
            <ns12:result>PASS</ns12:result>
          </ns12:when_true>
          <ns12:when_false>
            <ns12:result>FAIL</ns12:result>
          </ns12:when_false>
        </ns12:boolean_question_test_action>
        <ns12:boolean_question_test_action id="ocil:ssg-accounts_password_pam_dcredit_action:testaction:1" question_ref="ocil:ssg-accounts_password_pam_dcredit_question:question:1">
          <ns12:when_true>
            <ns12:result>PASS</ns12:result>
          </ns12:when_true>
          <ns12:when_false>
            <ns12:result>FAIL</ns12:result>
          </ns12:when_false>
        </ns12:boolean_question_test_action>
        <ns12:boolean_question_test_action id="ocil:ssg-accounts_tmout_action:testaction:1" question_ref="ocil:ssg-accounts_tmout_question:question:1">
          <ns12:when_true>
            <ns12:result>PASS</ns12:result>
          </ns12:when_true>
          <ns12:when_false>
            <ns12:result>FAIL</ns12:result>
          </ns12:when_false>
        </ns12:boolean_question_test_action>
        <ns12:boolean_question_test_action id="ocil:ssg-accounts_password_pam_ucredit_action:testaction:1" question_ref="ocil:ssg-accounts_password_pam_ucredit_question:question:1">
          <ns12:when_true>
            <ns12:result>PASS</ns12:result>
          </ns12:when_true>
          <ns12:when_false>
            <ns12:result>FAIL</ns12:result>
          </ns12:when_false>
        </ns12:boolean_question_test_action>
        <ns12:boolean_question_test_action id="ocil:ssg-accounts_umask_etc_profile_action:testaction:1" question_ref="ocil:ssg-accounts_umask_etc_profile_question:question:1">
          <ns12:when_true>
            <ns12:result>PASS</ns12:result>
          </ns12:when_true>
          <ns12:when_false>
            <ns12:result>FAIL</ns12:result>
          </ns12:when_false>
        </ns12:boolean_question_test_action>
        <ns12:boolean_question_test_action id="ocil:ssg-accounts_password_pam_minlen_action:testaction:1" question_ref="ocil:ssg-accounts_password_pam_minlen_question:question:1">
          <ns12:when_true>
            <ns12:result>PASS</ns12:result>
          </ns12:when_true>
          <ns12:when_false>
            <ns12:result>FAIL</ns12:result>
          </ns12:when_false>
        </ns12:boolean_question_test_action>
        <ns12:boolean_question_test_action id="ocil:ssg-accounts_umask_etc_bashrc_action:testaction:1" question_ref="ocil:ssg-accounts_umask_etc_bashrc_question:question:1">
          <ns12:when_true>
            <ns12:result>PASS</ns12:result>
          </ns12:when_true>
          <ns12:when_false>
            <ns12:result>FAIL</ns12:result>
          </ns12:when_false>
        </ns12:boolean_question_test_action>
      </ns12:test_actions>
      <ns12:questions>
        <ns12:boolean_question id="ocil:ssg-accounts_password_pam_ocredit_question:question:1">
          <ns12:question_text>Verify that Gentoo enforces password complexity by requiring that at least one special character with the following command:

$ sudo grep ocredit /etc/security/pwquality.conf /etc/security/pwquality.conf.d/*.conf

ocredit = 
      Is it the case that value of "ocredit" is a positive number or is commented out?
      </ns12:question_text>
        </ns12:boolean_question>
        <ns12:boolean_question id="ocil:ssg-accounts_umask_etc_login_defs_question:question:1">
          <ns12:question_text>Verify Gentoo defines default permissions for all authenticated users in such a way that the user can only read and modify their own files with the following command:

# grep -i umask /etc/login.defs

UMASK 
      Is it the case that the value for the "UMASK" parameter is not "&lt;sub idref="var_accounts_user_umask" /&gt;", or the "UMASK" parameter is missing or is commented out?
      </ns12:question_text>
        </ns12:boolean_question>
        <ns12:boolean_question id="ocil:ssg-accounts_password_pam_unix_remember_question:question:1">
          <ns12:question_text>To verify the password reuse setting is compliant, run the following command:
$ grep remember /etc/pam.d/system-auth
The output should show the following at the end of the line:
remember=


In newer systems, the pam_pwhistory PAM module options can also be set in
"/etc/security/pwhistory.conf" file. Use the following command to verify:
$ grep remember /etc/security/pwhistory.conf
remember = 

The pam_pwhistory remember option must be configured only in one file.
      Is it the case that the value of remember is not equal to or greater than the expected value?
      </ns12:question_text>
        </ns12:boolean_question>
        <ns12:boolean_question id="ocil:ssg-accounts_password_pam_lcredit_question:question:1">
          <ns12:question_text>Verify that Gentoo enforces password complexity by requiring that at least one lower-case character.

Check the value for "lcredit" with the following command:

$ sudo grep lcredit /etc/security/pwquality.conf /etc/security/pwquality.conf.d/*.conf

/etc/security/pwquality.conf:lcredit = -1
      Is it the case that the value of "lcredit" is a positive number or is commented out?
      </ns12:question_text>
        </ns12:boolean_question>
        <ns12:boolean_question id="ocil:ssg-accounts_password_pam_dcredit_question:question:1">
          <ns12:question_text>Verify that Gentoo enforces password complexity by requiring that at least one numeric character be used.

Check the value for "dcredit" with the following command:

$ sudo grep dcredit /etc/security/pwquality.conf /etc/security/pwquality.conf.d/*.conf

/etc/security/pwquality.conf:dcredit = 
      Is it the case that the value of "dcredit" is a positive number or is commented out?
      </ns12:question_text>
        </ns12:boolean_question>
        <ns12:boolean_question id="ocil:ssg-accounts_tmout_question:question:1">
          <ns12:question_text>Run the following command to ensure the TMOUT value is configured for all users
on the system:

$ sudo grep TMOUT /etc/profile /etc/profile.d/*.sh

The output should return the following:
TMOUT=
      Is it the case that value of TMOUT is not less than or equal to expected setting?
      </ns12:question_text>
        </ns12:boolean_question>
        <ns12:boolean_question id="ocil:ssg-accounts_password_pam_ucredit_question:question:1">
          <ns12:question_text>Verify that Gentoo enforces password complexity by requiring that at least one upper-case character.

Check the value for "ucredit" with the following command:

$ sudo grep ucredit /etc/security/pwquality.conf /etc/security/pwquality.conf.d/*.conf

ucredit = -1
      Is it the case that the value of "ucredit" is a positive number or is commented out?
      </ns12:question_text>
        </ns12:boolean_question>
        <ns12:boolean_question id="ocil:ssg-accounts_umask_etc_profile_question:question:1">
          <ns12:question_text>Verify the umask setting is configured correctly in the /etc/profile file
or scripts within /etc/profile.d directory with the following command:
$ grep "umask" /etc/profile*
umask 
      Is it the case that the value for the "umask" parameter is not "&lt;sub idref="var_accounts_user_umask" /&gt;",
or the "umask" parameter is missing or is commented out?
      </ns12:question_text>
        </ns12:boolean_question>
        <ns12:boolean_question id="ocil:ssg-accounts_password_pam_minlen_question:question:1">
          <ns12:question_text>Verify that Gentoo enforces a minimum -character password length with the following command:

$ grep minlen /etc/security/pwquality.conf

minlen = 
      Is it the case that the command does not return a "minlen" value of "&lt;sub idref="var_password_pam_minlen" /&gt;" or greater, does not return a line, or the line is commented out?
      </ns12:question_text>
        </ns12:boolean_question>
        <ns12:boolean_question id="ocil:ssg-accounts_umask_etc_bashrc_question:question:1">
          <ns12:question_text>Verify the umask setting is configured correctly in the /etc/bash/bashrc file with the following command:

$ sudo grep "umask" /etc/bash/bashrc

umask 
      Is it the case that the value for the "umask" parameter is not "&lt;sub idref="var_accounts_user_umask" /&gt;", or the "umask" parameter is missing or is commented out?
      </ns12:question_text>
        </ns12:boolean_question>
      </ns12:questions>
    </ns12:ocil>
  </ns0:component>
  <ns0:component id="scap_org.open-scap_comp_ssg-gentoo-cpe-oval.xml" timestamp="2024-06-04T12:03:55">
    <ns9:oval_definitions xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-common-5 oval-common-schema.xsd  http://oval.mitre.org/XMLSchema/oval-definitions-5 oval-definitions-schema.xsd  http://oval.mitre.org/XMLSchema/oval-definitions-5#independent independent-definitions-schema.xsd  http://oval.mitre.org/XMLSchema/oval-definitions-5#unix unix-definitions-schema.xsd  http://oval.mitre.org/XMLSchema/oval-definitions-5#linux linux-definitions-schema.xsd">
      <ns9:generator>
        <ns10:product_name>build_cpe.py from SCAP Security Guide</ns10:product_name>
        <ns10:product_version>ssg: [0, 1, 73], python: 3.11.9</ns10:product_version>
        <ns10:schema_version>5.11</ns10:schema_version>
        <ns10:timestamp>2024-06-04T10:03:54</ns10:timestamp>
      </ns9:generator>
      <ns9:definitions>
        <ns9:definition id="oval:ssg-installed_env_is_a_container:def:1" version="2" class="inventory">
          <ns9:metadata>
            <ns9:title>Check if the scan target is a container</ns9:title>
            <ns9:affected family="unix">
              <ns9:platform>Gentoo</ns9:platform>
            </ns9:affected>
            <ns9:reference ref_id="cpe:/a:container" source="CPE" />
            <ns9:description>Check for presence of files characterizing container filesystems.</ns9:description>
          </ns9:metadata>
          <ns9:criteria operator="OR">
            <ns9:criterion comment="Check if /.dockerenv exists" test_ref="oval:ssg-test_installed_env_is_a_docker_container:tst:1" />
            <ns9:criterion comment="Check if /run/.containerenv exists" test_ref="oval:ssg-test_installed_env_is_a_podman_container:tst:1" />
          </ns9:criteria>
        </ns9:definition>
        <ns9:definition id="oval:ssg-installed_env_is_a_machine:def:1" version="2" class="inventory">
          <ns9:metadata>
            <ns9:title>Check if the scan target is a machine</ns9:title>
            <ns9:affected family="unix">
              <ns9:platform>Gentoo</ns9:platform>
            </ns9:affected>
            <ns9:reference ref_id="cpe:/a:machine" source="CPE" />
            <ns9:description>Check for absence of files characterizing container filesystems.</ns9:description>
          </ns9:metadata>
          <ns9:criteria operator="AND">
            <ns9:extend_definition negate="true" comment="If environment is not a container, it is machine" definition_ref="oval:ssg-installed_env_is_a_container:def:1" />
          </ns9:criteria>
        </ns9:definition>
        <ns9:definition id="oval:ssg-installed_OS_is_gentoo:def:1" version="2" class="inventory">
          <ns9:metadata>
            <ns9:title>Gentoo</ns9:title>
            <ns9:affected family="unix">
              <ns9:platform>Gentoo</ns9:platform>
            </ns9:affected>
            <ns9:reference ref_id="cpe:/o:gentoo:linux" source="CPE" />
            <ns9:description>The operating system installed on the system is Gentoo</ns9:description>
          </ns9:metadata>
          <ns9:criteria comment="current OS is " operator="AND">
            <ns9:extend_definition comment="Installed OS is part of the Unix family" definition_ref="oval:ssg-installed_OS_is_part_of_Unix_family:def:1" />
            <ns9:criterion comment="Gentoo is installed" test_ref="oval:ssg-test_gentoo_release:tst:1" />
          </ns9:criteria>
        </ns9:definition>
        <ns9:definition id="oval:ssg-installed_OS_is_part_of_Unix_family:def:1" version="1" class="inventory">
          <ns9:metadata>
            <ns9:title>Installed operating system is part of the Unix family</ns9:title>
            <ns9:affected family="unix">
              <ns9:platform>Gentoo</ns9:platform>
            </ns9:affected>
            <ns9:description>The operating system installed on the system is part of the Unix OS family</ns9:description>
          </ns9:metadata>
          <ns9:criteria operator="AND">
            <ns9:criterion comment="Installed operating system is part of the unix family" test_ref="oval:ssg-test_unix_family:tst:1" />
          </ns9:criteria>
        </ns9:definition>
        <ns9:definition id="oval:ssg-package_bash:def:1" version="1" class="inventory">
          <ns9:metadata>
            <ns9:title>Package bash is installed</ns9:title>
            <ns9:affected family="unix">
              <ns9:platform>Gentoo</ns9:platform>
            </ns9:affected>
            <ns9:description>The RPM package bash should be installed.</ns9:description>
          </ns9:metadata>
          </ns9:definition>
        <ns9:definition id="oval:ssg-package_pam:def:1" version="1" class="inventory">
          <ns9:metadata>
            <ns9:title>Package pam is installed</ns9:title>
            <ns9:affected family="unix">
              <ns9:platform>Gentoo</ns9:platform>
            </ns9:affected>
            <ns9:description>The RPM package pam should be installed.</ns9:description>
          </ns9:metadata>
          </ns9:definition>
        <ns9:definition id="oval:ssg-package_shadow-utils:def:1" version="1" class="inventory">
          <ns9:metadata>
            <ns9:title>Package shadow-utils is installed</ns9:title>
            <ns9:affected family="unix">
              <ns9:platform>Gentoo</ns9:platform>
            </ns9:affected>
            <ns9:description>The RPM package shadow-utils should be installed.</ns9:description>
          </ns9:metadata>
          </ns9:definition>
      </ns9:definitions>
      <ns9:tests>
        <ns13:file_test id="oval:ssg-test_installed_env_is_a_docker_container:tst:1" version="1" check="all" comment="Check if /.dockerenv exists" check_existence="all_exist" state_operator="AND">
          <ns13:object object_ref="oval:ssg-object_installed_env_is_a_docker_container:obj:1" />
        </ns13:file_test>
        <ns13:file_test id="oval:ssg-test_installed_env_is_a_podman_container:tst:1" version="1" check="all" comment="Check if /run/.containerenv exists" check_existence="all_exist" state_operator="AND">
          <ns13:object object_ref="oval:ssg-object_installed_env_is_a_podman_container:obj:1" />
        </ns13:file_test>
        <ns13:file_test id="oval:ssg-test_gentoo_release:tst:1" version="1" check="all" comment="/etc/gentoo exists" check_existence="all_exist" state_operator="AND">
          <ns13:object object_ref="oval:ssg-obj_gentoo_release:obj:1" />
        </ns13:file_test>
        <ns11:family_test id="oval:ssg-test_unix_family:tst:1" version="1" check="all" comment="Test installed OS is part of the unix family" state_operator="AND">
          <ns11:object object_ref="oval:ssg-object_unix_family:obj:1" />
          <ns11:state state_ref="oval:ssg-state_unix_family:ste:1" />
        </ns11:family_test>
        </ns9:tests>
      <ns9:objects>
        <ns13:file_object id="oval:ssg-object_installed_env_is_a_docker_container:obj:1" version="1" comment="Check file /.dockerenv">
          <ns13:filepath datatype="string">/.dockerenv</ns13:filepath>
        </ns13:file_object>
        <ns13:file_object id="oval:ssg-object_installed_env_is_a_podman_container:obj:1" version="1" comment="Check file /run/.containerenv">
          <ns13:filepath datatype="string">/run/.containerenv</ns13:filepath>
        </ns13:file_object>
        <ns13:file_object id="oval:ssg-obj_gentoo_release:obj:1" version="1" comment="check /etc/gentoo-release file">
          <ns13:filepath>/etc/gentoo-release</ns13:filepath>
        </ns13:file_object>
        <ns11:family_object id="oval:ssg-object_unix_family:obj:1" version="1" />
        <ns14:rpminfo_object id="oval:ssg-obj_inventory_test_package_bash_installed:obj:1" version="1">
          <ns14:name>bash</ns14:name>
        </ns14:rpminfo_object>
        <ns14:rpminfo_object id="oval:ssg-obj_inventory_test_package_pam_installed:obj:1" version="1">
          <ns14:name>pam</ns14:name>
        </ns14:rpminfo_object>
        <ns14:rpminfo_object id="oval:ssg-obj_inventory_test_package_shadow-utils_installed:obj:1" version="1">
          <ns14:name>shadow-utils</ns14:name>
        </ns14:rpminfo_object>
      </ns9:objects>
      <ns9:states>
        <ns11:family_state id="oval:ssg-state_unix_family:ste:1" version="1" operator="AND">
          <ns11:family>unix</ns11:family>
        </ns11:family_state>
      </ns9:states>
    </ns9:oval_definitions>
  </ns0:component>
</ns0:data-stream-collection>